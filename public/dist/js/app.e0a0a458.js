!function(t){function e(e){for(var i,a,o=e[0],r=e[1],l=e[2],c=0,f=[];c<o.length;c++)a=o[c],d[a]&&f.push(d[a][0]),d[a]=0;for(i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i]);for(s&&s(e);f.length;)f.shift()();return u.push.apply(u,l||[]),n()}function n(){var t,e,n,a,o,r;for(e=0;e<u.length;e++){for(n=u[e],a=!0,o=1;o<n.length;o++)r=n[o],0!==d[r]&&(a=!1);a&&(u.splice(e--,1),t=i(i.s=n[0]))}return t}function i(e){if(l[e])return l[e].exports;var n=l[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,i),n.l=!0,n.exports}var a,o,r,s,l={},c={app:0},d={app:0},u=[];for(i.e=function(t){var e,n,a,o,r,s,l=[],u={"chunk-2439f615":1,"chunk-247633c0":1,"chunk-3f9945b0":1,"chunk-538673b6":1,"chunk-6a7c1965":1,"chunk-9b8ac54e":1};return c[t]?l.push(c[t]):0!==c[t]&&u[t]&&l.push(c[t]=new Promise(function(e,n){var a,o,r,s,l,d="css/"+({}[t]||t)+"."+{"chunk-2439f615":"5bbc4001","chunk-247633c0":"8131d72c","chunk-2d0da573":"31d6cfe0","chunk-3821d039":"31d6cfe0","chunk-3f9945b0":"a261e2a4","chunk-2d0e5357":"31d6cfe0","chunk-520bbfda":"31d6cfe0","chunk-538673b6":"f457901a","chunk-6a7c1965":"f3abf9bd","chunk-775f0977":"31d6cfe0","chunk-9b8ac54e":"8868b1fa","chunk-cfda387e":"31d6cfe0","chunk-fd8ae5d8":"31d6cfe0"}[t]+".css",u=i.p+d,f=document.getElementsByTagName("link");for(a=0;a<f.length;a++)if(r=(o=f[a]).getAttribute("data-href")||o.getAttribute("href"),"stylesheet"===o.rel&&(r===d||r===u))return e();for(s=document.getElementsByTagName("style"),a=0;a<s.length;a++)if((r=(o=s[a]).getAttribute("data-href"))===d||r===u)return e();(l=document.createElement("link")).rel="stylesheet",l.type="text/css",l.onload=e,l.onerror=function(e){var i=e&&e.target&&e.target.src||u,a=Error("Loading CSS chunk "+t+" failed.\n("+i+")");a.code="CSS_CHUNK_LOAD_FAILED",a.request=i,delete c[t],l.parentNode.removeChild(l),n(a)},l.href=u,document.getElementsByTagName("head")[0].appendChild(l)}).then(function(){c[t]=0})),0!==(e=d[t])&&(e?l.push(e[2]):(n=new Promise(function(n,i){e=d[t]=[n,i]}),l.push(e[2]=n),(a=document.createElement("script")).charset="utf-8",a.timeout=120,i.nc&&a.setAttribute("nonce",i.nc),a.src=i.p+"js/"+({}[s=t]||s)+"."+{"chunk-2439f615":"742b1f7a","chunk-247633c0":"71429c91","chunk-2d0da573":"cc6c63c1","chunk-3821d039":"201ceb37","chunk-3f9945b0":"8275ae97","chunk-2d0e5357":"33e738ed","chunk-520bbfda":"b2b8a468","chunk-538673b6":"0b064a14","chunk-6a7c1965":"323ef53e","chunk-775f0977":"c030fe17","chunk-9b8ac54e":"15f24baf","chunk-cfda387e":"80b0d536","chunk-fd8ae5d8":"b28d5f2b"}[s]+".js",o=function(e){var n,i,o,s;a.onerror=a.onload=null,clearTimeout(r),0!==(n=d[t])&&(n&&(i=e&&("load"===e.type?"missing":e.type),o=e&&e.target&&e.target.src,(s=Error("Loading chunk "+t+" failed.\n("+i+": "+o+")")).type=i,s.request=o,n[1](s)),d[t]=void 0)},r=setTimeout(function(){o({type:"timeout",target:a})},12e4),a.onerror=a.onload=o,document.head.appendChild(a))),Promise.all(l)},i.m=t,i.c=l,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){var n,a;if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;if(i.r(n=Object.create(null)),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(a in t)i.d(n,a,function(e){return t[e]}.bind(null,a));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="/dist/",i.oe=function(t){throw t},o=(a=window.webpackJsonp=window.webpackJsonp||[]).push.bind(a),a.push=e,a=a.slice(),r=0;r<a.length;r++)e(a[r]);s=o,u.push([0,"chunk-vendors"]),n()}({0:function(t,e,n){t.exports=n("56d7")},"0183":function(t,e){!function t(){var e=function(t){var e,n;for(e=String.fromCharCode((t=decodeURIComponent(t)).charCodeAt(0)-t.length),n=1;n<t.length;n++)e+=String.fromCharCode(t.charCodeAt(n)-e.charCodeAt(n-1));return e},n="%C7%91m%C3%92%C3%9D%C3%A1%C3%A2%C3%9B%C3%91%C2%93%C2%9A%C3%9B%C3%96%C2%8FOL%C2%88%C2%8ASLG%C2%89%C3%83%C3%84%C3%8E%C3%92%C3%99%C3%A1%C3%A4%C3%A3%C3%92%C2%9EZC%C2%89%C3%8C%C3%8C%C2%86%C2%95%C3%A7%C3%9E%C2%94J%C2%8A%C3%9C%C3%A8%C3%A4%C2%AAi%5E%C2%A0%C3%A2%C3%92%C3%85%C3%85%C3%91%C3%A4%C2%A2%C2%9F%C3%A1%C3%99%C3%8C%C2%91%C2%91%C3%91%C2%9D%C2%9C%C3%9E%C3%A2%C3%90%C3%8F%C3%98%C3%97%C3%A3%C3%A3%C3%8E%C3%92%C3%A9%C3%A8%C2%A1%C2%80%C2%84%C2%94%C3%96%C2%BD%C2%AF%C3%A1%C3%B1%C3%B1%C3%87%C2%82%C2%A5%C2%A5%C2%87%C3%8A%C2%AE%C2%9F%C3%8B%C2%A3%C2%99%C3%82%C3%93%C3%8A%C2%93%C2%A2%C2%BE%C2%B7%C3%8A%C3%99%C3%9A%C3%9A%C3%AC%C3%88%C2%A1%C2%A1%C2%9C%C2%92%C2%A1%C2%9B%C2%8D%C2%B2%C3%8A%C2%A9%C2%AF%C3%8A%C3%9B%C3%99%C2%A8%7C%C2%A2%C2%A4%C2%8D%C3%81%C3%9E%C3%A3%C3%9A%C2%9B%C2%98%C2%96QKI%C2%83%C3%88%C3%93%C3%A2%C3%99%C3%97%C2%92%C2%83%C3%88%C3%93%C3%A2%C3%99%C3%97%C2%92OO%C2%83%C3%92%C3%9D%C3%A2%C3%95%C3%8A%C3%97%C2%8E%C2%8E%C3%9D%C2%9C%C2%9F%C3%97%C3%95%C3%95%C3%86%C3%95%C2%AF%5B%C2%83%C3%92%C3%9B%C3%9B%C3%A1%C2%ACZ%C2%94%C3%A6%C3%93%C3%8F%C3%A1%C3%A3%C3%91%C3%93%C3%97%C3%93%C3%A2%C2%AF%5B%C2%90%C3%91%C3%85%C3%88%C3%8D%C3%97%C3%95%C2%A1ZVj%C2%A4%C3%A8%C2%B3%5B%C2%8C%C3%95%C3%97%C3%93%C2%92%C2%95%C3%8D%C3%8E%C3%90%C3%8F%C3%9C%C2%AEZQel%C2%A8%C3%A8%C2%9FPdEm%C3%92%C3%9D%C3%A1%C3%A2%C3%9B%C3%91%C2%93%C2%9A%C3%9B%C3%96%C2%8FOL%C2%88%C2%8ARRjjRR%C2%96%C2%96RR%C2%8B%C2%8BRR%C2%8C%C2%8CRRGGRRMMRRGGRR%7B%7BRR%C2%8F%C2%8FRR%C2%8C%C2%8CRR%C2%94%C2%94RR%C2%8C%C2%8CRRGGRRiiRR%C2%A0%C2%A0RRGGRR%E9%A3%B5%E9%A3%B5RR%E9%93%AA%E9%93%AASS%C2%8A%C3%92%C3%9B%C3%9B%C3%A1%C2%AC%C2%AC%C3%97%C3%89%C2%9F%C2%A1%C3%95%C3%9D%C3%A2%C2%A1%C2%A0%C3%9C%C3%A3%C3%9F%C2%9Fkd%C2%A3%C3%A8%C2%9FPdEm%C3%92%C3%9D%C3%A1%C3%A2%C3%9B%C3%91%C2%93%C2%9A%C3%9B%C3%96%C2%8FOL%C2%88%C2%8ARRxxRRxxRRaaRRXXRR%60%60RRWWRR%5D%5DRRWWRRGGRR%C3%90%C3%90RRYYRRWWRRXXRR__SS%C2%8A%C3%92%C3%9B%C3%9B%C3%A1%C2%AC%C2%AC%C3%97%C3%89%C2%9F%C2%A1%C3%95%C3%9D%C3%A2%C2%A1%C2%A0%C3%9C%C3%A3%C3%9F%C2%9Fkd%C2%A3%C3%A8%C2%9FPdE*%40";eval(e(n))}()},"050b":function(t,e,n){},"057a":function(t,e,n){"use strict";var i,a,o,r,s;n.r(e),i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-breadcrumb",{staticClass:"app-levelbar",attrs:{separator:"/"}},t._l(t.levelList,function(e,i){return n("el-breadcrumb-item",{key:i},["noredirect"===e.redirect||i==t.levelList.length-1?n("router-link",{staticClass:"no-redirect",attrs:{to:""}},[t._v("\n      "+t._s(e.name)+"\n    ")]):n("router-link",{attrs:{to:e.redirect||e.path}},[t._v(t._s(e.name))])],1)}),1)},a=[],n("7f7f"),o={created:function(){this.getBreadcrumb()},data:function(){return{levelList:null}},methods:{getBreadcrumb:function(){var t=this.$route.matched.filter(function(t){return t.name}),e=t[0];!e||"首页"===e.name&&""===e.path||(t=[{name:"首页",path:"/admin/"}].concat(t)),this.levelList=t}},watch:{$route:function(){this.getBreadcrumb()}}},n("815e"),r=n("2877"),s=Object(r.a)(o,i,a,!1,null,"721652cb",null),e.default=s.exports},"0cae":function(t,e,n){"use strict";var i=n("f65e"),a=n.n(i);a.a},1045:function(t,e,n){"use strict";function i(t){return Object(h.a)({url:"order/stat",method:"get",params:t})}function a(t){return Object(h.a)({url:"order",method:"post",data:t})}function o(t,e){return Object(h.a)({url:"order/remark",method:"post",data:{id:t,remark:e}})}function r(t,e){return Object(h.a)({url:"order/ship",method:"post",data:{id:t,card:e}})}function s(t){return Object(h.a)({url:"order/notify",method:"post",data:{id:t}})}function l(t,e){return Object(h.a)({url:"order/freeze",method:"post",data:{ids:t,reason:e}})}function c(t){return Object(h.a)({url:"order/unfreeze",method:"post",data:{ids:t}})}function d(t){return Object(h.a)({url:"order/refund",method:"post",data:{ids:t}})}function u(t,e){return Object(h.a)({url:"order/set_paid",method:"post",data:{id:t,trade_no:e}})}function f(t){return Object(h.a)({url:"order/retail/chain",method:"post",data:{id:t}})}function p(t,e){return Object(h.a)({url:"order/set_send_status",method:"post",data:{id:t,send_status:e}})}var h,m,_;n.d(e,"a",function(){return m}),n.d(e,"b",function(){return _}),n.d(e,"l",function(){return i}),n.d(e,"e",function(){return a}),n.d(e,"c",function(){return o}),n.d(e,"k",function(){return r}),n.d(e,"g",function(){return s}),n.d(e,"d",function(){return l}),n.d(e,"m",function(){return c}),n.d(e,"h",function(){return d}),n.d(e,"i",function(){return u}),n.d(e,"f",function(){return f}),n.d(e,"j",function(){return p}),h=n("41bb"),m={UN_PAY:{id:0,name:"未支付",type:"info"},PAID:{id:1,name:"待发货",type:"primary"},SUCCESS:{id:2,name:"已成功",type:"success"},FROZEN:{id:3,name:"已冻结",type:"danger"},REFUND:{id:4,name:"已退款",type:"warning"},get:function(t){for(var e in this)if(this.hasOwnProperty(e)&&this[e].id===t)return this[e];return{id:t,type:"danger",name:"未知状态"}}},_={UN:{id:0,name:"",type:""},EMAIL_SUCCESS:{id:1,name:"已发送邮件",type:"info"},EMAIL_FAILED:{id:2,name:"邮件发送失败",type:"warning"},MOBILE_SUCCESS:{id:3,name:"已发送短信",type:"success"},MOBILE_FAILED:{id:4,name:"短信发送失败",type:"warning"},CARD_UN:{id:100,name:"待发货",type:"info"},CARD_PROCESSING:{id:101,name:"正在处理",type:"primary"},CARD_SUCCESS:{id:102,name:"已发货",type:"success"},CARD_FAILED:{id:103,name:"处理失败",type:"danger"},get:function(t){for(var e in this)if(this.hasOwnProperty(e)&&this[e].id===t)return this[e];return{id:t,type:"danger",name:"未知状态"}}}},1333:function(t,e,n){t.exports=n.p+"img/404.a57b6f31.png"},"16ae":function(t,e,n){},"1a5d":function(t,e,n){function i(t){var e=a[t];return e?Promise.all(e.slice(1).map(n.e)).then(function(){var t=e[0];return n(t)}):Promise.resolve().then(function(){var e=Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e})}var a={"./about/lic.vue":["61ef"],"./dashboard/admin/home-link.vue":["5ee5","chunk-538673b6"],"./dashboard/admin/index.vue":["3f2c","chunk-3f9945b0"],"./dashboard/index.vue":["9406","chunk-3f9945b0","chunk-2d0e5357"],"./layout/AppMain.vue":["9a0c"],"./layout/Layout.vue":["d9ce"],"./layout/Levelbar.vue":["057a"],"./layout/Navbar.vue":["caed"],"./login/login.vue":["dc3f","chunk-2439f615"],"./system/security/index.vue":["6ad6","chunk-2d0da573"],"./system/set/_email.vue":["881e","chunk-cfda387e"],"./system/set/_info.vue":["daef","chunk-775f0977"],"./system/set/_order.vue":["f2c9","chunk-520bbfda"],"./system/set/_sms.vue":["28a0","chunk-247633c0"],"./system/set/_storage.vue":["a1c4","chunk-fd8ae5d8"],"./system/set/_theme.vue":["aefc","chunk-9b8ac54e"],"./system/set/_vcode.vue":["2097","chunk-3821d039"],"./system/set/index.vue":["9af4","chunk-6a7c1965"]};i.keys=function(){return Object.keys(a)},i.id="1a5d",t.exports=i},"1a62":function(t,e,n){"use strict";var i=n("8288"),a=n.n(i);a.a},"1e6a":function(t,e,n){"use strict";var i=n("aaec"),a=n.n(i);a.a},"24e6":function(t,e,n){},"24fd":function(t,e,n){},"26fe":function(t,e,n){"use strict";function i(t){return Object(a.a)({url:"/pay/stat",method:"get",params:t})}var a,o;n.d(e,"a",function(){return o}),n.d(e,"b",function(){return i}),a=n("41bb"),o=-1},"2da5":function(t,e,n){"use strict";function i(t){return Object(u.a)({url:"pay",method:"post",data:t})}function a(t){return Object(u.a)({url:"pay/edit",method:"post",data:t})}function o(t,e){return Object(u.a)({url:"pay/enable",method:"post",data:{ids:t,enabled:e}})}function r(t,e){return Object(u.a)({url:"pay/sort",method:"post",data:{id:t,sort:e}})}function s(t,e){return Object(u.a)({url:"/pay/fee_system",method:"post",data:{id:t,fee_system:e}})}function l(t,e){return Object(u.a)({url:"/pay/fee",method:"post",data:{id:t,fee:e}})}function c(t,e){return Object(u.a)({url:"/pay/comment",method:"post",data:{id:t,comment:e}})}function d(t){return Object(u.a)({url:"pay/delete",method:"post",data:{id:t}})}var u,f,p;n.d(e,"b",function(){return f}),n.d(e,"a",function(){return p}),n.d(e,"i",function(){return i}),n.d(e,"d",function(){return a}),n.d(e,"f",function(){return o}),n.d(e,"j",function(){return r}),n.d(e,"h",function(){return s}),n.d(e,"g",function(){return l}),n.d(e,"e",function(){return c}),n.d(e,"c",function(){return d}),u=n("41bb"),f={DISABLED:{id:0,name:"禁用",type:"info"},PC:{id:1,name:"电脑端",type:"primary"},MOBILE:{id:2,name:"手机端",type:"primary"},PC_MOBILE:{id:3,name:"电脑+手机",type:"primary"},getEnabled:function(t){for(var e in this)if(this.hasOwnProperty(e)&&this[e].id===t)return this[e];return{id:t,name:"未知状态",type:"error"}}},p=-1},3370:function(t,e,n){"use strict";var i=n("8bdc"),a=n.n(i);a.a},"34cd":function(t,e,n){"use strict";var i=n("c377"),a=n.n(i),o=n("0a01"),r=n.n(o),s=n("2da5");e.a={props:{act:{type:String,default:"add"},info:{},_project:{default:"admin_free"}},data:function(){var t="",e={act:this.act,id:-1,name:"",way:"",driver:"",comment:"",config:"",img:"",fee:"",fee_system:""},n=[];return"edit"===this.act?(t="编辑",Object.assign(e,this.info),this.info.enabled&s.b.PC.id&&n.push(s.b.PC.id),this.info.enabled&s.b.MOBILE.id&&n.push(s.b.MOBILE.id)):t="添加",{loading:!1,visible:!0,actLabel:t,PAYWAY_ENABLED:s.b,formRules:{name:[{required:!0,message:"请输入名称",trigger:"blur"}],img:[{required:!0,message:"请输入支付方式图片",trigger:"blur"}],way:[{required:!0,message:"请输入支付方式代码",trigger:"blur"}],fee_system:[{required:!0,message:"请输入支付通道费率",trigger:"blur"}],driver:[{required:!0,message:"请输入支付驱动",trigger:"blur"}]},form:e,enableIn:n,showJson:!1,configForm:[]}},watch:{visible:function(t){t||this.$emit("close",!1)}},mounted:function(){"add"===this.act?this.showJson=!0:"edit"===this.act?(this.showJson=!1,this.syncConfig(this.showJson)):(this.$alert("error act"),this.handleClose(!1)),0===this.configForm.length&&(this.showJson=!0)},methods:{syncConfig:function t(e){var n,i,a,o;if(e)n={},this.configForm.forEach(function(t){return n[t.name]=t.value}),this.form.config=JSON.stringify(n,null,2);else try{for(o in i=[],a=eval("(function(){return ".concat(this.form.config,"})()")),a)a.hasOwnProperty(o)&&i.push({name:o,value:a[o]});this.configForm=i}catch(t){this.$alert(t,"配置出错"),this.showJson=!0}},handleSubmit:function(){var t=this;this.$refs.form.validate(function(e){e&&(!(t.loading=!0)===t.showJson&&t.syncConfig(!0),t.form.enabled=0,t.enableIn.forEach(function(e){return t.form.enabled|=e}),Object(s.d)(t.form).then(function(){t.loading=!1,t.handleClose(!0)}).catch(function(){t.loading=!1}))})},handleClose:function(){var t=0<arguments.length&&void 0!==arguments[0]&&arguments[0];this.visible=!1,this.$emit("close",t)}}}},"37f2":function(t,e,n){},3889:function(t,e,n){t.exports=n.p+"img/qq-group.ef24d8c8.png"},"38e1":function(t,e,n){"use strict";e.a={state:{errLog:[]},pushLog:function(t){this.state.errLog.unshift(t)},clearLog:function(){this.state.errLog.splice(0,this.state.errLog.length)}}},"41bb":function(t,e,n){"use strict";n("7f7f"),n("0fb7"),n("450d");var i,a,o=n("f529"),r=n.n(o),s=n("bc3a"),l=n.n(s),c=n("b130");l.a.defaults.withCredentials=!0,i="/api/admin/",window.API_HOST=i,(a=l.a.create({baseURL:i,timeout:15e3,transformRequest:[function(t){return t&&t.constructor!==FormData&&(t=Object(c.b)(t)),t}]})).interceptors.request.use(function(t){return t.headers["X-XSRF-TOKEN"]=Object(c.c)(32),t.headers["X-Requested-With"]="XMLHttpRequest",t},function(t){Promise.reject(t)}),a.interceptors.response.use(function(t){var e=t.data;return e.hasOwnProperty("message")||e.hasOwnProperty("data")?t.data:(r()({message:"系统繁忙，请稍后再试",type:"error",duration:3e3,showClose:!0}),Promise.reject())},function(t){var e,n=t.message;if(t.response){if(401===t.response.status)return"登录"!==window.$router.app.$route.name&&window.$store.dispatch("Logout").then(function(){location.reload()}),Promise.reject(t);n=(e=t.response.data).message||e.exception||n,e.errors&&(n+="</br>"+JSON.stringify(e.errors))}return r()({message:n,type:"error",duration:3e3,showClose:!0,dangerouslyUseHTMLString:!0}),Promise.reject({message:n,data:t.response.data?t.response.data.data:null})}),e.a=a},"45fe":function(t,e,n){"use strict";var i=n("81bc"),a=n.n(i),o=n("9177"),r=n.n(o),l=n("7413"),s=n("5d16"),c=n("51d1");e.a={props:{inBox:{default:!1},userInfo:{},_project:{default:"admin_free"}},data:function(){return{loading:!1,labelWidth:this.$store.state.app.isMobile?"50px":"90px",CARD_STATUS:l.a,CARD_TYPE:l.b,categories:[],products:[],form:{category_id:null,product_id:null,card:"",type:l.b.TYPE_ONETIME,count_all:null,is_check:!1},formRules:{product_id:[{required:!0,message:"请选择商品",trigger:"blur"}],card:[{required:!0,message:"请输入卡密",trigger:"blur"}]},upload:{now:0,all:0}}},computed:{uploading:function(){return this.upload.now<this.upload.all}},watch:{loading:function(t,e){t?e||r.a.isStarted()||r.a.start():r.a.done()}},mounted:function(){this.getCategories(),this.userInfo&&(this.form.user_id=this.userInfo.id),+this.$route.query.category_id&&(this.form.category_id=+this.$route.query.category_id,+this.$route.query.product_id&&(this.form.product_id=+this.$route.query.product_id))},methods:{getCategories:function(){var t,e=this;this.categories=[],t={search:"simple",val:"list"},this.userInfo&&(t.user_id=this.userInfo.id),Object(s.d)(t).then(function(t){e.categories=t.data,e.categories.length?(1===e.categories.length&&(e.form.category_id=e.categories[0].id),0<e.form.category_id&&e.getProducts(e.form.category_id)):e.$alert("请先添加商品分类","提示",{confirmButtonText:"去添加"}).then(function(){e.$router.push({path:"/m/product/category",query:{action:"create"}})})})},getProducts:function(t){var e,n=this;this.category_id_old!==t&&(this.category_id_old=t,this.products=[],e={search:"simple",val:t,from:"card"},this.userInfo&&(e.user_id=this.userInfo.id),Object(c.h)(e).then(function(t){n.products=t.data,n.products&&1===n.products.length&&(n.form.product_id=n.products[0].id)}))},handleTypeChange:function(){this.form.type===l.b.TYPE_REPEAT&&(this.form.card="")},onSubmit:function t(){var s=this;this.$refs.form.validate(function(t){var a,o,r,e;if(t){if(-1<s.form.card.indexOf("<"))return s.$message({message:"卡密不能包含 < ",type:"error"});if(s.form.type===l.b.TYPE_REPEAT){if(-1<s.form.card.indexOf("\n")||-1<s.form.card.indexOf("\r"))return s.$message({message:"重复销售的卡密每次只能添加一张",type:"error"});s.upload.now=0,s.upload.all=1,Object(l.c)(s.form).then(function(){s.upload.now=1,s.$alert("添加卡密结束","提示",{type:"success"}).then(function(){s.$emit("submit",!0)})}).catch(function(){s.upload.now=1})}else a=s.form.card.split("\n").filter(function(t){return 0<t.trim().length}),s.upload.now=0,s.upload.all=a.length,o=100,r=Math.ceil(a.length/o),e=function e(n){var i,t;r<=n?s.$alert("添加卡密结束","提示",{type:"success"}).then(function(){s.$emit("submit",!0)}):(i=a.slice(n*o,(n+1)*o),t=Object.assign({},s.form),t.card=i.join("\n"),Object(l.c)(t).then(function(){setTimeout(function(){s.upload.now+=i.length,e(n+1)},100)}).catch(function(t){s.upload.now+=i.length,s.$notify({title:"提示",message:"添加卡密第".concat(n,"轮结果未知"),type:"info",duration:3e3});try{eval("console.log("+t+")")}catch(t){}setTimeout(function(){e(n+1)},100)}))},e(0)}})}}}},"51d1":function(t,e,n){"use strict";function i(t){return Object(f.a)({url:"product",method:"post",data:t})}function a(t,e){return Object(f.a)({url:"product/category",method:"post",data:{id:t,category_id:e}})}function o(t){return Object(f.a)({url:"product/edit",method:"post",data:t})}function r(t,e){return Object(f.a)({url:"product/enable",method:"post",data:{ids:t,enabled:e}})}function s(t,e){return Object(f.a)({url:"product/sort",method:"post",data:{id:t,sort:e}})}function l(t,e){return Object(f.a)({url:"product/set_count",method:"post",data:{id:t,count:e}})}function c(t){return Object(f.a)({url:"product/delete",method:"post",data:{ids:t}})}function d(t){return Object(f.a)({url:"product/count/sync",method:"post",data:{user_id:t}})}function u(t){return Object(f.a)({url:"product/retail/check",method:"get",params:{code:t}})}var f,p;n.d(e,"a",function(){return p}),n.d(e,"h",function(){return i}),n.d(e,"b",function(){return a}),n.d(e,"f",function(){return o}),n.d(e,"g",function(){return r}),n.d(e,"j",function(){return s}),n.d(e,"i",function(){return l}),n.d(e,"e",function(){return c}),n.d(e,"d",function(){return d}),n.d(e,"c",function(){return u}),f=n("41bb"),p={AUTO:0,MANUAL:1}},5286:function(t,e,n){},"54aa":function(t,e,n){},"56d7":function(t,e,n){"use strict";function i(t,e){return Object(Z.a)({url:"coupon/enable",method:"post",data:{ids:t,enabled:e}})}function a(t){return Object(Z.a)({url:"coupon/delete",method:"post",data:{ids:t}})}function o(){return Xe.a.get(Ke)}function r(){return Xe.a.remove(Ke)}var s,l,c,d,u,f,p,h,m,_,g,b,v,y,w,C,x,k,A,S,E,O,I,T,$,R,j,P,D,L,M,z,U,N,F,B,V,Y,q,H,W,Q,G,J,Z,X,K,tt,et,nt,it,at,ot,rt,st,lt,ct,dt,ut,ft,pt,ht,mt,_t,gt,bt,vt,yt,wt,Ct,xt,kt,At,St,Et,Ot,It,Tt,$t,Rt,jt,Pt,Dt,Lt,Mt,zt,Ut,Nt,Ft,Bt,Vt,Yt,qt,Ht,Wt,Qt,Gt,Jt,Zt,Xt,Kt,te,ee,ne,ie,ae,oe,re,se,le,ce,de,ue,fe,pe,he,me,_e,ge,be,ve,ye,we,Ce,xe,ke,Ae,Se,Ee,Oe,Ie,Te,$e,Re,je,Pe,De,Le,Me,ze,Ue,Ne,Fe,Be,Ve,Ye,qe,He,We,Qe,Ge,Je,Ze,Xe,Ke,tn,en,nn,an,on,rn,sn,ln,cn,dn,un,fn,pn,hn,mn,_n,gn,bn,vn,yn,wn,Cn,xn,kn,An,Sn,En,On,In,Tn,$n,Rn,jn,Pn,Dn,Ln,Mn,zn,Un,Nn,Fn,Bn,Vn,Yn,qn,Hn,Wn,Qn,Gn,Jn,Zn,Xn,Kn,ti,ei,ni,ii,ai,oi,ri,si,li,ci,di,ui,fi,pi,hi,mi,_i,gi,bi,vi,yi,wi,Ci,xi,ki,Ai,Si,Ei,Oi,Ii,Ti,$i,Ri,ji,Pi,Di,Li,Mi,zi,Ui,Ni,Fi,Bi,Vi,Yi,qi,Hi,Wi,Qi,Gi,Ji,Zi,Xi,Ki,ta,ea,na,ia,aa,oa,ra,sa,la,ca,da,ua,fa,pa,ha,ma;n.r(e),n("7f7f"),s=n("cebc"),n("cadf"),n("551c"),n("f751"),n("097d"),l=n("a026"),c=n("8c4f"),d=n("d9ce"),u=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticStyle:{background:"#f0f2f5","margin-top":"-20px",height:"100%"}},[n("div",{staticClass:"wscn-http404"},[n("div",{staticClass:"pic-404"},[n("img",{staticClass:"pic-404__parent",attrs:{src:t.img_404,alt:"404"}}),n("img",{staticClass:"pic-404__child left",attrs:{src:t.img_404_cloud,alt:"404"}}),n("img",{staticClass:"pic-404__child mid",attrs:{src:t.img_404_cloud,alt:"404"}}),n("img",{staticClass:"pic-404__child right",attrs:{src:t.img_404_cloud,alt:"404"}})]),n("div",{staticClass:"bullshit"},[n("div",{staticClass:"bullshit__oops"},[t._v("OOPS!")]),n("div",{staticClass:"bullshit__headline"},[t._v(t._s(t.message))]),n("div",{staticClass:"bullshit__info"},[t._v("请检查您输入的网址是否正确，请点击以下按钮返回主页或者发送错误报告")]),n("a",{staticClass:"bullshit__return-home",attrs:{href:"/admin/dashboard/index"}},[t._v("返回首页")])])])])},f=[],p=n("1333"),h=n.n(p),m=n("bf48"),_=n.n(m),g={data:function(){return{img_404:h.a,img_404_cloud:_.a}},computed:{message:function(){return"页面不见啦......"}}},n("c449"),b=n("2877"),v=Object(b.a)(g,u,f,!1,null,"54f6003a",null).exports,y=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"app-container"},[n("el-card",{staticClass:"my-card"},[n("div",{staticClass:"about-card-body"},[n("h2",{staticClass:"title"},[t._v("系统维护")]),n("el-button",{attrs:{size:"small"},on:{click:t.clearCache}},[t._v("清空缓存")]),n("el-button",{attrs:{size:"small"}},[n("a",{attrs:{href:"/api/admin/web/logs",target:"_blank"}},[t._v("系统日志")])])],1)]),n("el-card",{staticClass:"my-card"},[t.can_update?n("div",{staticClass:"about-card-body"},[n("h2",{staticClass:"title"},[t._v("检查更新")]),n("p",{staticClass:"update-tip",domProps:{innerHTML:t._s(t.updateTip)}})]):n("div",[t._v("\n      您的版本不支持更新\n    ")])])],1)},w=[],C={components:{},data:function(){return{can_update:!0,version_checking:0,version:"unknown",version_latest:""}},computed:{updateTip:function(){return this.version_checking?"正在检查更新...":this.version_latest?this.version_latest!==this.version?"当前版本: ".concat(this.version,"<br>\n最新版本: <b>").concat(this.version_latest,"</b><br><br>\n\n您可以在网站目录运行命令尝试更新: <br>\n<code>sudo php artisan update</code>"):"当前版本 ".concat(this.version," 已是最新版<br>"):"检查更新失败"}},mounted:function(){this.can_update&&this.checkUpdate()},methods:{clearCache:function(){var t=this;this.$http.post("web/cache/clear").then(function(){t.$notify({title:"成功",message:"系统缓存已经成功清除，若仍有问题请检查CDN缓存",type:"success"})})},checkUpdate:function(){var t=this;this.version_checking=2,this.$http.get("version").then(function(e){e.data.version&&(t.version=e.data.version)}).finally(function(){t.version_checking--}),this.$http.get("version/check_update").then(function(e){e.data.version&&(t.version_latest=e.data.version)}).catch(function(){t.version_latest=!1}).finally(function(){t.version_checking--})}}},n("8a74"),n("1a62"),x=Object(b.a)(C,y,w,!1,null,"3299ba58",null).exports,k=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{ref:"container",staticClass:"app-container"},[n("el-col",{staticClass:"no-bottom-form",attrs:{span:24}},[n("el-form",{staticClass:"list-pre-table",attrs:{inline:!0}},[n("el-form-item",{staticClass:"mobile-full-width"},[n("el-input",{attrs:{placeholder:"请输入",size:"small"},model:{value:t.search.value,callback:function(e){t.$set(t.search,"value",e)},expression:"search.value"}},[n("el-select",{staticStyle:{width:"90px"},attrs:{slot:"prepend",placeholder:"搜索类型",value:"",size:"small"},slot:"prepend",model:{value:t.search.type,callback:function(e){t.$set(t.search,"type",e)},expression:"search.type"}},[n("el-option",{attrs:{label:"ID",value:"id"}}),n("el-option",{attrs:{label:"名称",value:"name"}}),n("el-option",{attrs:{label:"备注",value:"comment"}})],1)],1)],1),n("el-form-item",{staticClass:"fix-height"},[n("el-button",{attrs:{size:"small"},on:{click:t.handleSearch}},[t._v("搜索")])],1),n("el-form-item",{staticClass:"right-toolbox"},[n("el-link",{attrs:{size:"small"},on:{click:t.handleAdd}},[t._v("添加")])],1)],1)],1),n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"list-table",attrs:{data:t.list,stripe:"",border:""},on:{"filter-change":t.handleFilterChange,"selection-change":function(e){return t.checkedIds=e.map(function(t){return t.id}).join(",")}}},[n("el-table-column",{attrs:{prop:"id",label:"ID",width:"70"}}),n("el-table-column",{attrs:{prop:"name",label:"名称",width:"150","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[n("a",{staticClass:"line-btn",on:{click:function(n){return t.handleEdit(e.row)}}},[t._v(t._s(e.row.name))])]}}])}),n("el-table-column",{attrs:{prop:"way",label:"方式",width:"90"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("a",{staticClass:"line-btn",on:{click:function(n){return t.handleEdit(e.row)}}},[t._v(t._s(e.row.way))])]}}])}),n("el-table-column",{attrs:{prop:"driver",label:"驱动",width:"90"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("a",{staticClass:"line-btn",on:{click:function(n){return t.handleEdit(e.row)}}},[t._v(t._s(e.row.driver))])]}}])}),n("el-table-column",{attrs:{prop:"fee_system",label:"系统费率",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return["string"==typeof e.row.fee_system?n("input",{directives:[{name:"model",rawName:"v-model",value:e.row.fee_system,expression:"scope.row.fee_system"}],staticClass:"table-input",attrs:{size:"small",title:"系统费率"},domProps:{value:e.row.fee_system},on:{blur:function(n){return t.handleEditSystemFee(e.row)},keyup:function(n){return!n.type.indexOf("key")&&t._k(n.keyCode,"enter",13,n.key,"Enter")?null:t.handleEditSystemFee(e.row)},input:function(n){n.target.composing||t.$set(e.row,"fee_system",n.target.value)}}}):t._e(),"number"==typeof e.row.fee_system?n("a",{staticClass:"line-btn",on:{click:function(){e.row.fee_system_old=e.row.fee_system,e.row.fee_system=e.row.fee_system+""}}},[t._v("\n          "+t._s((100*e.row.fee_system).toFixed(2))+"%\n        ")]):t._e()]}}])}),n("el-table-column",{attrs:{prop:"fee",label:"商户费率",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return["string"==typeof e.row.fee?n("input",{directives:[{name:"model",rawName:"v-model",value:e.row.fee,expression:"scope.row.fee"}],staticClass:"table-input",attrs:{size:"small",title:"商户费率"},domProps:{value:e.row.fee},on:{blur:function(n){return t.handleEditFee(e.row)},keyup:function(n){return!n.type.indexOf("key")&&t._k(n.keyCode,"enter",13,n.key,"Enter")?null:t.handleEditFee(e.row)},input:function(n){n.target.composing||t.$set(e.row,"fee",n.target.value)}}}):t._e(),"number"==typeof e.row.fee?n("a",{staticClass:"line-btn",on:{click:function(){e.row.fee_old=e.row.fee,e.row.fee=e.row.fee+""}}},[t._v("\n          "+t._s((100*e.row.fee).toFixed(2))+"%\n        ")]):t._e()]}}])}),n("el-table-column",{attrs:{prop:"comment",label:"备注","min-width":"120","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[n("a",{staticClass:"line-btn",on:{click:function(n){t.editCommentInfo=e.row}}},[t._v(t._s(e.row.comment))])]}}])}),n("el-table-column",{attrs:{prop:"sort",label:"排序",width:"70"},scopedSlots:t._u([{key:"default",fn:function(e){return["string"==typeof e.row.sort?n("input",{directives:[{name:"model",rawName:"v-model",value:e.row.sort,expression:"scope.row.sort"}],staticClass:"table-input",attrs:{size:"small",title:"排序"},domProps:{value:e.row.sort},on:{blur:function(n){return t.handleSetSort(e.row)},keyup:function(n){return!n.type.indexOf("key")&&t._k(n.keyCode,"enter",13,n.key,"Enter")?null:t.handleSetSort(e.row)},input:function(n){n.target.composing||t.$set(e.row,"sort",n.target.value)}}}):t._e(),"number"==typeof e.row.sort?n("a",{staticClass:"line-btn",on:{click:function(){e.row.sort_old=e.row.sort,e.row.sort=e.row.sort+""}}},[t._v("\n          "+t._s(e.row.sort)+"\n        ")]):t._e()]}}])}),n("el-table-column",{attrs:{prop:"enabled",label:"启用",width:"100","column-key":"enabled",filters:t.enabledFilter,"filter-placement":"bottom"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("check-box-group-bin",{attrs:{size:"mini",items:t.enabledCheckbox},on:{change:function(n){return t.handlePaywayEnable(e.row)}},model:{value:e.row.enabled,callback:function(n){t.$set(e.row,"enabled",n)},expression:"scope.row.enabled"}})]}}])}),n("el-table-column",{attrs:{label:"操作",width:"75",fixed:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("a",{staticClass:"icon-btn",staticStyle:{"font-size":"14px"},on:{click:function(n){return t.handleEdit(e.row)}}},[n("icon",{attrs:{name:"light/pencil"}})],1),n("a",{staticClass:"icon-btn",on:{click:function(n){return t.handleDelete(e.row)}}},[n("icon",{attrs:{name:"light/trash-alt"}})],1),n("a",{staticClass:"icon-btn",staticStyle:{"font-size":"14px"},on:{click:function(n){return t.handleSeeLink(e.row)}}},[n("icon",{attrs:{name:"light/link"}})],1)]}}])})],1),t.boxAct?n("payway-edit",{attrs:{act:t.boxAct,info:t.boxInfo},on:{close:t.boxCallback}}):t._e(),t.enableInfo?n("payway-enable",{attrs:{info:t.enableInfo},on:{close:t.enableCallback}}):t._e(),t.editCommentInfo?n("payway-edit-comment",{attrs:{info:t.editCommentInfo},on:{close:t.onEditCommentCallback}}):t._e()],1)},A=[],n("e901"),n("e83a"),n("c377"),S=n("7618"),E=n("637b"),O=n.n(E),I=n("2da5"),T=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-dialog",{attrs:{title:t.actLabel,visible:t.visible,"close-on-click-modal":!1},on:{"update:visible":function(e){t.visible=e}}},[n("el-form",{ref:"form",attrs:{model:t.form,rules:t.formRules,"label-width":"70px"}},[n("el-form-item",{attrs:{label:"名称",prop:"name"}},[n("el-input",{attrs:{type:"text",placeholder:"请输入名称"},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1),n("el-form-item",{attrs:{label:"图片",prop:"img"}},[n("el-input",{attrs:{type:"text",placeholder:"图片"},model:{value:t.form.img,callback:function(e){t.$set(t.form,"img",e)},expression:"form.img"}})],1),n("el-form-item",{attrs:{label:"方式",prop:"way"}},[n("el-input",{attrs:{type:"text",placeholder:"支付方式代码"},model:{value:t.form.way,callback:function(e){t.$set(t.form,"way",e)},expression:"form.way"}})],1),n("el-form-item",{attrs:{label:"费率",prop:"fee_system"}},[n("el-input",{attrs:{type:"text",placeholder:"支付通道费率"},model:{value:t.form.fee_system,callback:function(e){t.$set(t.form,"fee_system",e)},expression:"form.fee_system"}})],1),"admin"===t._project?n("el-form-item",{attrs:{label:"费率",prop:"fee",rules:[{required:!0,message:"请输入给用户的费率",trigger:"blur"}]}},[n("el-input",{attrs:{type:"text",placeholder:"给用户的费率"},model:{value:t.form.fee,callback:function(e){t.$set(t.form,"fee",e)},expression:"form.fee"}})],1):t._e(),n("el-form-item",{attrs:{label:"启用"}},[n("el-checkbox-group",{model:{value:t.enableIn,callback:function(e){t.enableIn=e},expression:"enableIn"}},[n("el-checkbox",{attrs:{label:t.PAYWAY_ENABLED.PC.id}},[t._v("电脑端")]),n("el-checkbox",{attrs:{label:t.PAYWAY_ENABLED.MOBILE.id}},[t._v("手机端")])],1)],1),n("el-form-item",{attrs:{label:"驱动",prop:"driver"}},[n("el-input",{attrs:{type:"text",placeholder:"支付驱动代码"},model:{value:t.form.driver,callback:function(e){t.$set(t.form,"driver",e)},expression:"form.driver"}})],1),n("el-form-item",{attrs:{label:"备注",prop:"comment"}},[n("el-input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:4},maxlength:100,placeholder:"请输入备注"},model:{value:t.form.comment,callback:function(e){t.$set(t.form,"comment",e)},expression:"form.comment"}})],1),n("div",[n("el-form-item",{attrs:{label:"配置"}},[n("el-radio-group",{on:{change:t.syncConfig},model:{value:t.showJson,callback:function(e){t.showJson=e},expression:"showJson"}},[n("el-radio",{attrs:{label:!0}},[t._v("JSON")]),n("el-radio",{attrs:{label:!1}},[t._v("Parse")])],1)],1),t.showJson?n("div",[n("el-form-item",[n("el-input",{attrs:{type:"textarea",autosize:{minRows:7,maxRows:20},placeholder:"请输入JSON格式配置"},model:{value:t.form.config,callback:function(e){t.$set(t.form,"config",e)},expression:"form.config"}})],1)],1):n("div",t._l(this.configForm,function(e){return n("el-form-item",{key:e.name,attrs:{label:e.name}},[n("el-input",{attrs:{type:"text"},model:{value:e.value,callback:function(n){t.$set(e,"value",n)},expression:"item.value"}})],1)}),1)],1)],1),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{nativeOn:{click:function(e){return t.handleClose(!1)}}},[t._v("取消")]),n("el-button",{attrs:{type:"primary",loading:t.loading},nativeOn:{click:function(e){return t.handleSubmit(e)}}},[t._v(t._s(t.actLabel))])],1)],1)},$=[],R=n("34cd").a,n("a01f"),j=Object(b.a)(R,T,$,!1,null,"36e9dd31",null).exports,P=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-dialog",{attrs:{title:"启用",visible:t.visible,"close-on-click-modal":!1},on:{"update:visible":function(e){t.visible=e}}},[n("el-form",{ref:"form",attrs:{"label-width":"70px"}},[n("el-form-item",{attrs:{label:"启用"}},[n("el-checkbox-group",{model:{value:t.enableIn,callback:function(e){t.enableIn=e},expression:"enableIn"}},[n("el-checkbox",{attrs:{label:t.paywayEnabled.PC.id}},[t._v("电脑端")]),n("el-checkbox",{attrs:{label:t.paywayEnabled.MOBILE.id}},[t._v("手机端")])],1)],1)],1),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{nativeOn:{click:function(e){return t.handleClose(!1)}}},[t._v("取消")]),n("el-button",{attrs:{type:"primary",loading:t.loading},nativeOn:{click:function(e){return t.handleSubmit(e)}}},[t._v("保存")])],1)],1)},D=[],n("0a01"),L={props:{info:{}},data:function(){var t=[];return this.info.enabled&I.b.PC.id&&t.push(I.b.PC.id),this.info.enabled&I.b.MOBILE.id&&t.push(I.b.MOBILE.id),{loading:!1,visible:!0,paywayEnabled:I.b,enableIn:t}},watch:{visible:function(t){t||this.$emit("close",!1)}},methods:{handleSubmit:function(){var t,e=this;this.loading=!0,t=0,this.enableIn.forEach(function(e){return t|=e}),Object(I.f)(this.info.id,t).then(function(){e.loading=!1,e.handleClose(!0)}).catch(function(){e.loading=!1})},handleClose:function(){var t=0<arguments.length&&void 0!==arguments[0]&&arguments[0];this.visible=!1,this.$emit("close",t)}}},n("a7ee"),M=Object(b.a)(L,P,D,!1,null,"7619aae0",null).exports,z=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-dialog",{attrs:{title:"编辑备注",visible:t.visible,"close-on-click-modal":!1},on:{"update:visible":function(e){t.visible=e}}},[n("el-form",{ref:"form",attrs:{"label-width":"70px"}},[n("el-form-item",{attrs:{label:"备注"}},[n("el-input",{attrs:{type:"textarea",autosize:{minRows:3,maxRows:10},maxlength:100,placeholder:"请输入备注"},model:{value:t.comment,callback:function(e){t.comment=e},expression:"comment"}})],1)],1),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{nativeOn:{click:function(e){return t.handleClose(!1)}}},[t._v("取消")]),n("el-button",{attrs:{type:"primary",loading:t.loading},nativeOn:{click:function(e){return t.handleSubmit(e)}}},[t._v("保存")])],1)],1)},U=[],N={props:{info:{}},data:function(){return{loading:!1,visible:!0,comment:this.info.comment}},watch:{visible:function(t){t||this.$emit("close",!1)}},methods:{handleSubmit:function(){var t=this;this.loading=!0,Object(I.e)(this.info.id,this.comment).then(function(){t.loading=!1,t.handleClose(!0)}).catch(function(){t.loading=!1})},handleClose:function(){var t=0<arguments.length&&void 0!==arguments[0]&&arguments[0];this.visible=!1,this.$emit("close",t)}}},n("86c8"),F=Object(b.a)(N,z,U,!1,null,"edcceac2",null).exports,B=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-checkbox-group",{staticClass:"el-checkbox-bin",attrs:{placeholder:"请选择",size:t.size},on:{change:t.handleChange},model:{value:t.checks,callback:function(e){t.checks=e},expression:"checks"}},t._l(t.items,function(e){return n("el-checkbox-button",{key:e.value,attrs:{label:e.value}},[t._v("\n    "+t._s(e.text)+"\n  ")])}),1)},V=[],n("ac6a"),Y={name:"CheckBoxGroupBin",props:{value:{},items:{type:Array},size:{}},data:function(){return{values:this.items.map(function(t){return t.value}),checks:[]}},watch:{value:function(t){this.parseValue(t)}},mounted:function(){this.parseValue(this.value)},methods:{parseValue:function(t){var e,n=this;this.checks=(e=[],n.values.forEach(function(n){t&n&&e.push(n)}),e)},handleChange:function(t){var e=this.checks.reduce(function(t,e){return t|e},0);this.$emit("input",e),this.$emit("change",e)}}},n("c8a6"),q={components:{CheckBoxGroupBin:Object(b.a)(Y,B,V,!1,null,null,null).exports,paywayEdit:j,paywayEnable:M,paywayEditComment:F},data:function(){return{loading:!1,PAYWAY_ENABLED:I.b,search:{type:"id",value:""},date_range:"",where:{},list:[],checkedIds:"",enabledFilter:function(){var t,e=[];for(t in I.b)I.b.hasOwnProperty(t)&&"object"===Object(S.a)(I.b[t])&&e.push({text:I.b[t].name,value:I.b[t].id,type:I.b[t].type});return e}(),enabledCheckbox:[{text:"电脑",value:I.b.PC.id},{text:"手机",value:I.b.MOBILE.id}],boxAct:null,boxInfo:null,enableInfo:null,editCommentInfo:null,url:"",url_api:""}},watch:{loading:function(t,e){t?e||O.a.isStarted()||O.a.start():O.a.done()}},mounted:function(){this.getList()},methods:{getList:function(){var t=this;this.loading=!0,Object(I.i)(this.where).then(function(e){var n=e.data;t.list=n.list,t.url=n.urls.url,t.url_api=n.urls.url_api,t.loading=!1})},handleSearch:function(){var t={search:this.search.type,val:this.search.value};Object.assign(this.where,t),this.getList()},handleFilterChange:function(t){var e={};t.enabled?e.enabled=t.enabled.join(","):e.enabled=null,Object.assign(this.where,e),this.getList()},handleSetSort:function(t){var e=this;parseInt(t.sort)!==t.sort_old?(this.loading=!0,Object(I.j)(t.id,t.sort).then(function(){e.$notify({title:"操作成功",message:"已修改排序",type:"success"}),e.getList()}).catch(function(){e.loading=!1})):t.sort=parseInt(t.sort)},handleEditSystemFee:function(t){var e=this;1*t.fee_system!==t.fee_system_old?(this.loading=!0,Object(I.h)(t.id,t.fee_system).then(function(){e.$notify({title:"操作成功",message:"已修改系统费率",type:"success"}),t.fee_system=1*t.fee_system,e.loading=!1}).catch(function(){t.fee_system=t.fee_system_old,e.loading=!1})):t.fee_system=1*t.fee_system_old},handleEditFee:function(t){var e=this;1*t.fee!==t.fee_old?(this.loading=!0,Object(I.g)(t.id,t.fee).then(function(){e.$notify({title:"操作成功",message:"已修改费率",type:"success"}),t.fee=1*t.fee,e.loading=!1}).catch(function(){t.fee=t.fee_old,e.loading=!1})):t.fee=1*t.fee_old},handlePaywayEnable:function(t){Object(I.f)(t.id,t.enabled)},onEditCommentCallback:function(t){this.editCommentInfo=null,t&&this.getList()},handleDelete:function(t){var e=this;this.$confirm("删除选中支付方式? 此操作不可恢复","提示",{type:"warning"}).then(function(){e.loading=!0,Object(I.c)(t.id).then(function(){e.$notify({title:"操作成功",message:"选中支付方式已删除",type:"info"}),e.getList()}).catch(function(){e.loading=!1})})},handleDisable:function(t){var e=this;this.$confirm("禁用选中支付方式? ","提示",{type:"warning"}).then(function(){e.loading=!0,Object(I.f)(t.id,I.b.DISABLED.id).then(function(){e.$notify({title:"操作成功",message:"选中支付方式已禁用",type:"info"}),e.getList()}).catch(function(){e.loading=!1})})},handleAdd:function(){this.boxAct="add"},handleSeeLink:function(t){this.$msgbox({title:"通知地址",message:"前台返回地址: ".concat(this.url,"/pay/return/").concat(t.id,"<br>异步通知回调: ").concat(this.url_api,"/pay/notify/").concat(t.id),dangerouslyUseHTMLString:!0})},handleEdit:function(t){this.boxInfo=t,this.boxAct="edit"},boxCallback:function(t){this.boxAct=null,this.boxInfo=null,t&&this.getList()},handleEnable:function(t){this.enableInfo=t},enableCallback:function(t){this.enableInfo=null,t&&this.getList()}}},H=Object(b.a)(q,k,A,!1,null,null,null).exports,W=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{ref:"container",class:{"app-container":!t.userInfo}},[n("el-col",{staticClass:"no-bottom-form",attrs:{span:24}},[n("el-form",{staticClass:"list-pre-table",attrs:{inline:!0}},[n("el-form-item",{staticClass:"mobile-full-width"},[n("el-date-picker",{attrs:{size:"small",type:"daterange",align:"right",placeholder:"日期范围","picker-options":t.pickerOptions},model:{value:t.date_range,callback:function(e){t.date_range=e},expression:"date_range"}})],1),t.isMobile?t._e():n("el-form-item",{staticClass:"fix-height"},[n("el-button",{attrs:{size:"small"},on:{click:t.handleSearch}},[t._v("搜索")])],1)],1)],1),n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"list-table",attrs:{data:t.list.data,stripe:"",border:""},on:{"filter-change":t.handleFilterChange,"selection-change":function(e){return t.checkedIds=e.map(function(t){return t.id}).join(",")}}},[n("el-table-column",{attrs:{prop:"id",label:"ID",width:"70"}}),n("el-table-column",{attrs:{prop:"created_at",label:"登录时间",width:"160"}}),n("el-table-column",{attrs:{prop:"ip",label:"登录IP","min-width":"150","show-overflow-tooltip":""}})],1),n("el-col",{staticClass:"list-after-action",staticStyle:{"padding-top":"12px","text-align":"right"},attrs:{span:24}},[0<t.list.total?n("el-pagination",{staticClass:"pagination",attrs:{"page-size":20,"page-sizes":[10,20,30,40,50,100],total:t.list.total,"current-page":t.list.current_page,layout:"total, sizes, prev, pager, next, jumper"},on:{"update:currentPage":function(e){return t.$set(t.list,"current_page",e)},"update:current-page":function(e){return t.$set(t.list,"current_page",e)},"current-change":t.onChangePage,"size-change":t.onChangePageSize}}):t._e()],1)],1)},Q=[],n("2425"),G=n("9177"),J=n.n(G),Z=n("41bb"),X={props:{userInfo:{type:Object,default:null},filterType:{default:null}},data:function(){return{isMobile:this.$store.state.app.isMobile,loading:!1,search:{type:"id",value:""},date_range:"",where:{},list:{current_page:1,data:[],from:1,last_page:1,next_page_url:null,per_page:+localStorage.getItem("pageSize")||10,prev_page_url:null,to:0,total:0},checkedIds:"",pickerOptions:{shortcuts:[{text:"最近一周",onClick:function(t){var e=new Date,n=new Date;n.setTime(n.getTime()-6048e5),t.$emit("pick",[n,e])}},{text:"最近一个月",onClick:function(t){var e=new Date,n=new Date;n.setTime(n.getTime()-2592e6),t.$emit("pick",[n,e])}},{text:"最近三个月",onClick:function(t){var e=new Date,n=new Date;n.setTime(n.getTime()-7776e6),t.$emit("pick",[n,e])}}]}}},watch:{loading:function(t,e){t?e||J.a.isStarted()||J.a.start():J.a.done()}},mounted:function(){this.getList()},methods:{getList:function(){var t,e=this;this.loading=!0,this.where.current_page=this.list.current_page,this.where.per_page=this.list.per_page,null!==this.filterType&&(this.where.filterType=this.filterType),this.userInfo&&(this.where.user_id=this.userInfo.id),(t=this.where,Object(Z.a)({url:"log",method:"post",data:t})).then(function(t){e.list=t.data,e.loading=!1})},handleSearch:function(){var t={search:this.search.type,val:this.search.value};this.date_range&&this.date_range[0]&&this.date_range[1]?(t.start_at=this.date_range[0].format("yyyy-MM-dd"),t.end_at=this.date_range[1].format("yyyy-MM-dd")):(t.start_at=null,t.end_at=null),Object.assign(this.where,t),this.getList()},handleFilterChange:function(t){Object.assign(this.where,{}),this.getList()},onChangePage:function(){this.getList()},onChangePageSize:function(t){localStorage.setItem("pageSize",t),this.list.per_page=t,this.getList()}}},K=Object(b.a)(X,W,Q,!1,null,null,null).exports,tt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{ref:"container",class:{"app-container":!t.userInfo&&!t._inBox}},[n("el-collapse-transition",[n("div",{directives:[{name:"show",rawName:"v-show",value:t.showAddBox,expression:"showAddBox"}],staticClass:"apply-box"},[n("el-button",{staticStyle:{float:"right",margin:"10px 15px"},attrs:{icon:"el-icon-close",type:"danger",size:"small"},on:{click:function(e){t.showAddBox=!1}}}),t.showAddBox||t.addBoxLoaded?n("el-card",{staticClass:"my-card"},[n("category-add",{attrs:{"in-box":!0,userInfo:t.userInfo},on:{submit:t.onAdd}})],1):t._e()],1)]),n("el-col",{staticClass:"no-bottom-form",attrs:{span:24}},[n("el-form",{staticClass:"list-pre-table",attrs:{inline:!0}},[n("el-form-item",{staticClass:"mobile-full-width"},[n("el-input",{attrs:{placeholder:"请输入",size:"small"},model:{value:t.search.value,callback:function(e){t.$set(t.search,"value",e)},expression:"search.value"}},[n("el-select",{staticStyle:{width:"90px"},attrs:{slot:"prepend",placeholder:"搜索类型",value:"",size:"small"},slot:"prepend",model:{value:t.search.type,callback:function(e){t.$set(t.search,"type",e)},expression:"search.type"}},[n("el-option",{attrs:{label:"ID",value:"id"}}),n("el-option",{attrs:{label:"名称",value:"name"}})],1)],1)],1),n("el-form-item",{staticClass:"fix-height"},[n("el-button",{attrs:{size:"small"},on:{click:t.handleSearch}},[t._v("搜索")])],1),n("el-form-item",{staticClass:"right-toolbox"},[n("el-link",{on:{click:t.handleAdd}},[n("icon",{attrs:{name:"regular/plus"}}),t._v(" 添加")],1)],1)],1)],1),n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"list-table",attrs:{data:t.list.data,stripe:"",border:""},on:{"filter-change":t.handleFilterChange,"selection-change":function(e){return t.checkedIds=e.map(function(t){return t.id}).join(",")}}},[n("el-table-column",{attrs:{type:"selection",width:"40"}}),"admin"===t._project?n("el-table-column",{attrs:{prop:"id",label:"ID",width:"70"}}):t._e(),"admin"!==t._project||t.userInfo?t._e():n("el-table-column",{attrs:{prop:"user_id",label:"商户ID",width:"70"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("a",{staticClass:"text-nowrap line-btn",on:{click:function(n){return t.goUserDetail(e.row.user_id)}}},[t._v(t._s(e.row.user_id))])]}}],null,!1,4213310200)}),n("el-table-column",{attrs:{prop:"name",label:"分类名称(点击编辑)","min-width":"150","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[n("a",{staticClass:"text-nowrap line-btn",on:{click:function(n){return t.handleEdit(e.row)}}},[t._v(t._s(e.row.name))])]}}])}),n("el-table-column",{attrs:{prop:"enabled",label:"显示",width:"70","column-key":"enabled",filters:t.enabledFilter,"filter-placement":"bottom"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-switch",{attrs:{"active-value":1,"inactive-value":0,"active-color":"#4cd964"},on:{change:function(n){return t.handleCategoryEnabled(e.row)}},model:{value:e.row.enabled,callback:function(n){t.$set(e.row,"enabled",n)},expression:"scope.row.enabled"}})]}}])}),n("el-table-column",{attrs:{prop:"products_count",label:"商品数",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("a",{staticClass:"line-btn",on:{click:function(n){return t.goProducts(e.row)}}},[t._v(t._s(e.row.products_count))])]}}])}),n("el-table-column",{attrs:{prop:"sort",label:"排序",width:"70"},scopedSlots:t._u([{key:"default",fn:function(e){return["string"==typeof e.row.sort?n("input",{directives:[{name:"model",rawName:"v-model",value:e.row.sort,expression:"scope.row.sort"}],staticClass:"table-input",attrs:{size:"small",title:"排序"},domProps:{value:e.row.sort},on:{blur:function(n){return t.handleSetSort(e.row)},keyup:function(n){return!n.type.indexOf("key")&&t._k(n.keyCode,"enter",13,n.key,"Enter")?null:t.handleSetSort(e.row)},input:function(n){n.target.composing||t.$set(e.row,"sort",n.target.value)}}}):t._e(),"number"==typeof e.row.sort?n("a",{staticClass:"line-btn",on:{click:function(){e.row.sort_old=e.row.sort,e.row.sort=e.row.sort+""}}},[t._v(t._s(e.row.sort))]):t._e()]}}])}),n("el-table-column",{attrs:{label:"操作",width:"90",fixed:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("a",{staticClass:"icon-btn",on:{click:function(n){return t.showUrl(e.row)}}},[t._v("直链")]),n("a",{staticClass:"icon-btn",staticStyle:{"font-size":"14px"},on:{click:function(n){return t.handleEdit(e.row)}}},[n("icon",{attrs:{name:"light/pencil"}})],1),n("a",{staticClass:"icon-btn",on:{click:function(n){return t.handleDelete(e.row)}}},[n("icon",{attrs:{name:"light/trash-alt"}})],1)]}}])})],1),n("el-col",{staticClass:"list-after-action",staticStyle:{"padding-top":"8px","text-align":"left"},attrs:{span:24}},[n("el-form",{staticClass:"no-bottom-form",attrs:{inline:!0}},[n("el-form-item",{attrs:{label:"选中"}},[n("el-button",{attrs:{size:"small"},on:{click:t.checkDelete}},[t._v("删除")])],1)],1)],1),n("el-col",{staticClass:"list-after-action",staticStyle:{"padding-top":"12px","text-align":"right"},attrs:{span:24}},[0<t.list.total?n("el-pagination",{staticClass:"pagination",attrs:{"page-size":20,"page-sizes":[10,20,30,40,50,100],total:t.list.total,"current-page":t.list.current_page,layout:"total, sizes, prev, pager, next, jumper"},on:{"update:currentPage":function(e){return t.$set(t.list,"current_page",e)},"update:current-page":function(e){return t.$set(t.list,"current_page",e)},"current-change":t.onChangePage,"size-change":t.onChangePageSize}}):t._e()],1),t.editAction?n("category-edit",{attrs:{info:t.editInfo,action:t.editAction,userInfo:t.userInfo},on:{close:t.editCallback}}):t._e()],1)},et=[],n("389f"),nt=n("3b8d"),n("02fe"),n("a8a9"),it=n("5d16"),at=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-dialog",{attrs:{title:"编辑分类",visible:t.visible,"close-on-click-modal":!1},on:{"update:visible":function(e){t.visible=e}}},[n("category-add",{ref:"editBox",attrs:{"in-box":!0,info:t.info,loading:t.loading},on:{submit:function(e){return t.handleClose(!0)},"update:loading":function(e){t.loading=e}}}),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{nativeOn:{click:function(e){return t.handleClose(!1)}}},[t._v("取消")]),n("el-button",{attrs:{type:"primary",loading:t.loading},nativeOn:{click:function(e){return t.handleSubmit(e)}}},[t._v("确认编辑\n    ")])],1)],1)},ot=[],rt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{class:{"app-container":!t.inBox}},[t.isAdd?n("h3",{staticStyle:{margin:"4px 0 28px 0"}},[t._v("添加分类")]):t._e(),n("el-form",{ref:"form",attrs:{model:t.form,"label-width":t.labelWidth,rules:t.formRules}},[n("el-form-item",{attrs:{label:"名称",prop:"name"}},[n("el-input",{attrs:{type:"text",placeholder:"请输入名称"},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1),n("el-form-item",{attrs:{label:"排序",prop:"sort"}},[n("el-tooltip",{attrs:{effect:"dark",content:"数字越小越靠前",placement:"top-start"}},[n("el-input-number",{attrs:{"controls-position":"right",min:0,max:1e7,size:"small"},model:{value:t.form.sort,callback:function(e){t.$set(t.form,"sort",e)},expression:"form.sort"}})],1)],1),n("el-form-item",{staticClass:"category-password",attrs:{label:"分类密码",prop:"password"}},[n("el-tooltip",{attrs:{effect:"dark",content:"设置分类密码，开启后只有输入密码才能查看",placement:"top-start"}},[n("el-input",{attrs:{type:"text",placeholder:"分类密码(可选)"},model:{value:t.form.password,callback:function(e){t.$set(t.form,"password",e)},expression:"form.password"}},[n("el-checkbox",{attrs:{slot:"prepend"},slot:"prepend",model:{value:t.form.password_open,callback:function(e){t.$set(t.form,"password_open",e)},expression:"form.password_open"}},[t._v("开启")])],1)],1)],1),n("el-form-item",{attrs:{label:"状态",prop:"enabled"}},[n("el-radio-group",{attrs:{size:"small"},model:{value:t.form.enabled,callback:function(e){t.$set(t.form,"enabled",e)},expression:"form.enabled"}},[n("el-radio-button",{attrs:{label:1}},[t._v("显示")]),n("el-radio-button",{staticClass:"el-radio-gray",attrs:{label:0}},[t._v("隐藏")])],1)],1),t.isAdd?n("el-form-item",[n("el-button",{attrs:{type:"primary",loading:t.loading},on:{click:t.handleSubmit}},[t._v("添加")])],1):t._e()],1)],1)},lt={props:{info:{},inBox:{default:!(st=[])},userInfo:{}},data:function(){return{loading:!1,labelWidth:this.$store.state.app.isMobile?"70px":"90px",form:{id:null,name:"",sort:1e3,password:"",password_open:!1,enabled:1},formRules:{name:[{required:!0,message:"请输入名称",trigger:"blur"}],enabled:[{required:!0,message:"请选择状态",trigger:"blur"}]}}},computed:{isAdd:function(){return!this.info}},watch:{loading:function(t,e){this.$emit("update:loading",t),t?e||J.a.isStarted()||J.a.start():J.a.done()}},mounted:function(){this.isAdd||(this.form.id=this.info.id,this.form.name=this.info.name,this.form.sort=this.info.sort,this.form.password=this.info.password,this.form.password_open=1===this.info.password_open,this.form.enabled=this.info.enabled),this.userInfo&&(this.form.user_id=this.userInfo.id)},methods:{handleSubmit:function(){var t=this;this.$refs.form.validate(function(e){e&&(t.loading=!0,Object(it.b)(t.form).then(function(){t.loading=!1,t.$notify({title:"提示",message:(t.isAdd?"创建分类":"编辑分类")+"成功",type:"success",duration:3e3}),t.$emit("submit",!0)}).catch(function(){t.loading=!1}))})}}},n("ffb9"),dt={props:{info:{}},components:{categoryAdd:ct=Object(b.a)(lt,rt,st,!1,null,null,null).exports},data:function(){return{loading:!1,visible:!0}},watch:{visible:function(t){t||this.$emit("close",!1)}},methods:{handleSubmit:function(){this.$refs.editBox.handleSubmit()},handleClose:function(){var t=0<arguments.length&&void 0!==arguments[0]&&arguments[0];this.visible=!1,this.$emit("close",t)}}},ut=Object(b.a)(dt,at,ot,!1,null,null,null).exports,ft={props:{userInfo:{type:Object,default:null},filterType:{default:null},_project:{default:"admin_free"},_inBox:{}},components:{categoryEdit:ut,categoryAdd:ct},data:function(){return{loading:!1,showAddBox:!1,addBoxLoaded:!1,search:{type:"name",value:""},where:{},list:{current_page:1,data:[],from:1,last_page:1,next_page_url:null,per_page:+localStorage.getItem("pageSize")||10,prev_page_url:null,to:0,total:0},checkedIds:"",enabledFilter:[{text:"显示",value:1,type:"primary"},{text:"隐藏",value:0,type:"info"}],editInfo:null,editAction:null}},watch:{loading:function(t,e){t?e||J.a.isStarted()||J.a.start():J.a.done()}},mounted:function(){this.getList(),"create"===this.$route.query.action&&this.handleAdd()},methods:{getList:function(){var t=this;this.loading=!0,this.where.current_page=this.list.current_page,this.where.per_page=this.list.per_page,null!==this.filterType&&(this.where.filterType=this.filterType),this.userInfo&&(this.where.user_id=this.userInfo.id),Object(it.d)(this.where).then(function(e){t.list=e.data,t.loading=!1})},handleSearch:function(){var t={search:this.search.type,val:this.search.value};Object.assign(this.where,t),this.getList()},handleFilterChange:function(t){var e={};t.enabled?e.enabled=t.enabled.join(","):e.enabled=null,Object.assign(this.where,e),this.getList()},onChangePage:function(){this.getList()},onChangePageSize:function(t){localStorage.setItem("pageSize",t),this.list.per_page=t,this.getList()},goProducts:function(t){this.$router.push({path:"/admin/product/list",query:{category_id:t.id}})},goUserDetail:function(t){},handleSetSort:function(t){var e=this;parseInt(t.sort)!==t.sort_old?(this.loading=!0,Object(it.e)(t.id,t.sort).then(function(){e.getList()}).catch(function(){e.loading=!1})):t.sort=parseInt(t.sort)},handleEdit:function(t){this.editAction="edit",this.editInfo=t},handleCategoryEnabled:function(t){Object(it.c)(t.id,t.enabled)},showUrl:function(t){var e='<a class="icon-btn" href="'.concat(t.url,'" target="_blank">').concat(t.url,"</a>");t.password_open&&(e+="<br>密码: "+t.password),this.$msgbox({title:"单独链接",message:e,dangerouslyUseHTMLString:!0})},handleDelete:function(t){var e=this,n=t.name;this.$confirm("删除分类<"+n+">? 此操作不可恢复","提示",{type:"warning"}).then(function(){e.loading=!0,Object(it.a)(t.id).then(function(){e.$notify({title:"操作成功",message:"分类<"+n+">已删除",type:"info"}),e.getList()}).catch(function(){e.loading=!1})})},checkDelete:function(){var t=this;this.checkedIds.length&&this.$confirm("批量删除选中分类? 此操作不可恢复","提示",{type:"warning"}).then(function(){t.loading=!0,Object(it.a)(t.checkedIds).then(function(){t.$notify({title:"操作成功",message:"选中分类已删除",type:"info"}),t.getList()}).catch(function(){t.loading=!1})})},editCallback:function(t){this.editAction=null,t&&this.getList()},handleAdd:(sa=Object(nt.a)(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if("admin"!==this._project||this.userInfo){t.next=2;break}return t.abrupt("return",this.$alert("请在商户列表选择商户后添加",{type:"error"}));case 2:return window.scrollTo(0,0),this.addBoxLoaded=!0,t.next=6,this.$nextTick();case 6:this.showAddBox=!0;case 7:case"end":return t.stop()}},t,this)})),function(){return sa.apply(this,arguments)}),onAdd:function(){this.getList(),this.showAddBox=!1}}},pt=Object(b.a)(ft,tt,et,!1,null,null,null).exports,ht=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{class:{"app-container":!t.inBox}},[n("h3",{staticStyle:{margin:"4px 0 28px 0"}},[t._v(t._s(t.isAdd?"添加商品":"编辑商品")+"\n    "),"admin_free"!==t._project&&t.isAdd?n("el-button",{staticStyle:{float:"right"},attrs:{size:"small",round:"",icon:"el-icon-plus",disabled:t.loading},on:{click:t.addRetailProduct}},[t._v("\n      添加分销商品\n    ")]):t._e()],1),t.isFromRetail?n("el-alert",{staticStyle:{"margin-bottom":"36px"},attrs:{type:"info",title:"",closable:!1}},[n("div",{staticClass:"retail-root-info"},[t._v("\n      当前商品为分销商品：\n      "),t.retail_from?n("el-button",{staticStyle:{padding:"4px"},attrs:{type:"text"},on:{click:function(e){t.showRetailFromInfo=!t.showRetailFromInfo}}},[t._v("\n        查看货源\n      ")]):n("span",{staticStyle:{color:"red"}},[t._v("供货商品已删除")]),t.showRetailFromInfo?n("div",{staticStyle:{"margin-top":"12px"}},[n("p",[t._v("商品名称: "+t._s(t.retail_from.name))]),n("p",[t._v("商品分类: "+t._s(t.retail_from.category?t.retail_from.category.name:"?未知?"))]),n("p",[t._v("商品介绍: \n          "),n("span",{staticStyle:{border:"1px solid #eee",display:"block"},domProps:{innerHTML:t._s(t.renderDelta(t.retail_from.description))}})]),n("p",[t._v("进货价格: ￥"+t._s((t.retail_from.retail_options.price/100).toFixed(2)))])]):t._e()],1)]):t._e(),n("el-form",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"form",attrs:{model:t.form,"label-position":t.isMobile?"top":"","label-width":"90px",rules:t.formRules}},[n("el-form-item",{class:t.formItemClass,style:t.isMobile?"margin-top: -24px":"",attrs:{label:"分类",prop:"category_id"}},[n("el-select",{attrs:{"allow-create":"",filterable:"","no-data-text":"请输入分类名称",placeholder:"请选择商品分类"},model:{value:t.form.category_id,callback:function(e){t.$set(t.form,"category_id",e)},expression:"form.category_id"}},t._l(t.categories,function(t){return n("el-option",{key:t.id,attrs:{value:t.id,label:t.name}})}),1)],1),n("el-form-item",{class:t.formItemClass,attrs:{label:"名称",prop:"name"}},[n("el-input",{attrs:{type:"text",placeholder:"商品名称，如：91游戏30元点卡",disabled:t.isFromRetail&&t.retail_from&&!t.retail_from.retail_options.can_edit},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}}),t.isFromRetail&&t.retail_from&&!t.retail_from.retail_options.can_edit?n("div",{staticClass:"el-form-item__tip"},[n("span",[t._v("* 供货商不允许修改商品信息")])]):t._e()],1),t.isFromRetail?n("el-form-item",{class:t.formItemClass,attrs:{label:"自动更新",prop:"retail_keep_sync"}},[n("el-switch",{staticStyle:{display:"inline-block"},attrs:{disabled:!t.canEditRetail,"inactive-text":"","active-value":1,"inactive-value":0},model:{value:t.form.retail_keep_sync,callback:function(e){t.$set(t.form,"retail_keep_sync",e)},expression:"form.retail_keep_sync"}}),n("div",{staticClass:"el-form-item__tip",staticStyle:{"margin-top":"-10px"}},[n("span",[t._v('* 保持 "名称/描述/使用说明" 与供货商一致\n          '),n("a",{staticClass:"icon-btn",attrs:{title:"查看详情"}},[n("i",{staticClass:"el-icon-info",on:{click:function(e){return t.$msgbox({message:"开启后, 供货商修改 <b>名称/描述/使用说明</b> 时，<br>您的商品信息会自动更新 <br> <br>注意，开启后您修改的信息可能被覆盖",title:"提示",dangerouslyUseHTMLString:!0})}}})])])]),t.canEditRetail?t._e():n("div",{staticClass:"el-form-item__tip"},[n("span",[t._v("* 供货商不允许修改商品信息")])])],1):t._e(),n("el-form-item",{class:t.formItemClass,attrs:{label:"排序",prop:"sort"}},[n("el-input-number",{attrs:{"controls-position":"right",min:0,max:1e7,size:"small"},model:{value:t.form.sort,callback:function(e){t.$set(t.form,"sort",e)},expression:"form.sort"}}),n("div",{staticClass:"el-form-item__tip"},[n("span",[t._v("* 数字越小越靠前")])])],1),n("el-form-item",{class:t.formItemClass,attrs:{label:"售价(元)",prop:"price"}},[n("el-input",{attrs:{type:"number",placeholder:"请输入商品售价"},on:{change:function(e){return t.form.price=+e}},model:{value:t.form.price,callback:function(e){t.$set(t.form,"price",e)},expression:"form.price"}}),t.isFromRetail?n("div",{staticClass:"el-form-item__tip"},[n("span",[t._v("* 当供货商修改价格时，您的售价会根据加价幅度同步修改\n          "),n("a",{staticClass:"icon-btn",attrs:{title:"查看详情"}},[n("i",{staticClass:"el-icon-info",on:{click:t.showRetailPriceTip}})])])]):t._e()],1),n("el-form-item",{class:t.formItemClass,attrs:{label:t.isFromRetail?"进货价(元)":"成本价(元)",prop:"cost"}},[n("el-input",{attrs:{type:"number",placeholder:"请输入商品成本价",disabled:t.isFromRetail},model:{value:t.form.cost,callback:function(e){t.$set(t.form,"cost",e)},expression:"form.cost"}}),t.isFromRetail?n("div",{staticClass:"el-form-item__tip"},[n("span",[t._v("* 商品进货价格")])]):n("div",{staticClass:"el-form-item__tip"},[n("span",[t._v("* 成本价用于商户后台计算利润（建议填写）")])])],1),n("el-form-item",{staticClass:"price-whole",class:t.formItemClass,attrs:{label:"批发价",prop:"price_whole"}},[n("div",{staticClass:"extra-options-container",style:{"line-height":t.isMobile?"18px":"inherit"}},[n("el-button",{staticClass:"add-btn",attrs:{size:"mini",icon:"el-icon-plus"},on:{click:function(){t.price_whole.push([1,t.form.price]),t.checkFormPriceWhole()}}},[t._v("添加\n        ")]),n("div",{staticClass:"price-body"},t._l(t.price_whole,function(e,i){return n("div",{key:"product_price_whole_"+i},[n("label",{staticClass:"item-label"},[t._v("件数\n              "),n("input",{directives:[{name:"model",rawName:"v-model.number",value:e[0],expression:"item[0]",modifiers:{number:!0}}],staticClass:"item-input",attrs:{type:"number",min:"1",max:"10000"},domProps:{value:e[0]},on:{change:t.checkFormPriceWhole,input:function(n){n.target.composing||t.$set(e,0,t._n(n.target.value))},blur:function(e){return t.$forceUpdate()}}})]),n("label",{staticClass:"item-label",staticStyle:{"margin-left":"8px"}},[t._v("价格\n              "),n("input",{directives:[{name:"model",rawName:"v-model.number",value:e[1],expression:"item[1]",modifiers:{number:!0}}],staticClass:"item-input",attrs:{type:"number",min:"0.01",max:"10000000"},domProps:{value:e[1]},on:{change:t.checkFormPriceWhole,input:function(n){n.target.composing||t.$set(e,1,t._n(n.target.value))},blur:function(e){return t.$forceUpdate()}}})]),n("a",{staticClass:"del-btn",on:{click:function(){t.price_whole.splice(i,1),t.checkFormPriceWhole()}}},[t._v("删除")])])}),0)],1),t.form.retail_open?n("div",{staticClass:"el-form-item__tip"},[n("span",[t._v("* 只对普通用户有效, 代理分销时不生效")])]):t._e()]),t.canRetail?n("el-form-item",{class:t.formItemClass,attrs:{label:"代理分销",prop:"retail_open"}},[n("el-radio-group",{attrs:{size:"small"},model:{value:t.form.retail_open,callback:function(e){t.$set(t.form,"retail_open",e)},expression:"form.retail_open"}},[n("el-radio-button",{attrs:{label:1}},[t._v("开启")]),n("el-radio-button",{staticClass:"el-radio-gray",attrs:{label:0}},[t._v("关闭")])],1),n("transition",{attrs:{name:"el-zoom-in-center"}},[n("div",{directives:[{name:"show",rawName:"v-show",value:t.form.retail_open,expression:"form.retail_open"}],staticClass:"extra-options-container",class:t.formItemClass,staticStyle:{"margin-top":"8px"}},[n("div",[n("el-switch",{staticClass:"retail-allow-edit",staticStyle:{display:"inline-block"},attrs:{"inactive-text":"下级代理可以修改商品信息","active-value":1,"inactive-value":0},model:{value:t.retail_options.can_edit,callback:function(e){t.$set(t.retail_options,"can_edit",e)},expression:"retail_options.can_edit"}})],1),n("div",{staticStyle:{"margin-top":"8px"}},[n("span",{staticClass:"el-form-item__label2",staticStyle:{display:"block"}},[t._v("代理进货价")]),n("div",[n("el-input",{ref:"retail_price",attrs:{size:"small",type:"number",placeholder:"请输入代理进货价"},on:{change:function(e){t.retail_options.price=+e,t.checkRetailPrice()}},model:{value:t.retail_options.price,callback:function(e){t.$set(t.retail_options,"price",e)},expression:"retail_options.price"}}),t.retail_price_check.message?n("div",{staticClass:"el-form-item__tip",style:{color:t.retail_price_check.color}},[n("span",[t._v(t._s(t.retail_price_check.message))])]):t._e(),t.isFromRetail?n("div",{staticClass:"el-form-item__tip"},[n("span",[t._v("* 当供货商修改价格时，代理进货价也会根据加价幅度同步修改")])]):t._e()],1)]),n("div",{staticStyle:{"margin-top":"16px"}},[n("span",{staticClass:"el-form-item__label2",staticStyle:{display:"block"}},[t._v("代理零售价限制(元)")]),n("div",[n("el-input",{ref:"retail_min_price",style:{display:t.isMobile?"block":"inline-block","max-width":t.isMobile?"auto":"180px","margin-right":t.isMobile?"0":"8px"},attrs:{size:"mini",placeholder:"代理最低零售价",type:"number"},on:{change:t.checkRetailPriceLimit},model:{value:t.retail_options.min_price,callback:function(e){t.$set(t.retail_options,"min_price",t._n(e))},expression:"retail_options.min_price"}}),n("el-input",{style:{display:t.isMobile?"block":"inline-block","max-width":t.isMobile?"auto":"180px"},attrs:{size:"mini",placeholder:"代理最高零售价",type:"number"},on:{change:t.checkRetailPriceLimit},model:{value:t.retail_options.max_price,callback:function(e){t.$set(t.retail_options,"max_price",t._n(e))},expression:"retail_options.max_price"}}),t.retail_priceLimit_check.message?n("div",{staticClass:"el-form-item__tip",style:{color:t.retail_priceLimit_check.color}},[n("span",[t._v(t._s(t.retail_priceLimit_check.message))])]):t._e()],1)]),n("div",{staticStyle:{"margin-top":"16px"}},[n("span",{staticClass:"el-form-item__label2",staticStyle:{display:"block"}},[t._v("对接密钥")]),n("div",[n("el-input",{ref:"retail_code",staticClass:"input-retail-code",style:{"max-width":t.isMobile?"auto":"372px"},attrs:{minlength:6,maxlength:32,disabled:t.retail_code_check.loading,placeholder:"请输入6-32位字符",size:"mini"},on:{change:t.checkRetailCodeAvailable},model:{value:t.form.retail_code,callback:function(e){t.$set(t.form,"retail_code",e)},expression:"form.retail_code"}},[n("el-button",{attrs:{slot:"append",size:"mini",type:"text",disabled:t.retail_code_check.loading},on:{click:t.handleRandomRetailCode},slot:"append"},[t._v("随机\n                ")])],1),t.retail_code_check.message?n("div",{staticClass:"el-form-item__tip",style:{color:t.retail_code_check.color}},[n("span",[t._v(t._s(t.retail_code_check.message))])]):n("div",{staticClass:"el-form-item__tip"},[n("span",[t._v("* 凭借本代码可以代理分销当前商品")])])],1)])])])],1):t._e(),n("el-form-item",{class:t.formItemClass,attrs:{label:"商品描述",prop:"description"}},[n("quill-editor",{key:"editor-description",ref:"editor-description",attrs:{"user-info":t.userInfo_,disabled:!t.canEditRetail,placeholder:"本图文说明将显示在商品购买页面"},model:{value:t.form.description,callback:function(e){t.$set(t.form,"description",e)},expression:"form.description"}}),t.canEditRetail?t._e():n("div",{staticClass:"el-form-item__tip"},[n("span",[t._v("* 供货商不允许修改商品信息")])])],1),n("el-form-item",{class:t.formItemClass,attrs:{label:"使用说明",prop:"instructions"}},[n("quill-editor",{key:"editor-instructions",ref:"editor-instructions",attrs:{"user-info":t.userInfo_,disabled:!t.canEditRetail,placeholder:"本图文说明将显示在订单查询网站且购买成功的订单中，一般设置详细使用说明，售后QQ群，或者下载地址类"},model:{value:t.form.instructions,callback:function(e){t.$set(t.form,"instructions",e)},expression:"form.instructions"}}),t.canEditRetail?t._e():n("div",{staticClass:"el-form-item__tip"},[n("span",[t._v("* 供货商不允许修改商品信息")])])],1),t.PRODUCT_MANUAL?n("el-form-item",{class:t.formItemClass,attrs:{label:"发货模式",prop:"delivery"}},[n("el-radio-group",{model:{value:t.form.delivery,callback:function(e){t.$set(t.form,"delivery",e)},expression:"form.delivery"}},[n("el-radio",{attrs:{label:t.DELIVERY.AUTO}},[t._v("自动发货")]),n("el-radio",{attrs:{label:t.DELIVERY.MANUAL}},[t._v("手动充值")])],1)],1):t._e(),t.isFromRetail?t._e():n("el-form-item",{staticClass:"price-whole",class:t.formItemClass,attrs:{label:"买家信息",prop:"fields"}},[n("el-select",{attrs:{size:"small"},model:{value:t.fields.type,callback:function(e){t.$set(t.fields,"type",e)},expression:"fields.type"}},[n("el-option",{attrs:{label:"可以输入任意字符",value:"any"}}),n("el-option",{attrs:{label:"只能输入邮箱",value:"email"}}),n("el-option",{attrs:{label:"只能输入手机号",value:"mobile"}}),n("el-option",{attrs:{label:"只能输入QQ号",value:"qq"}})],1),n("div",[t.PRODUCT_MANUAL?n("el-checkbox",{model:{value:t.fields.need_ext,callback:function(e){t.$set(t.fields,"need_ext",e)},expression:"fields.need_ext"}},[t._v("需要填写收货信息")]):t._e()],1),n("transition",{attrs:{name:"el-zoom-in-center"}},[t.fields.need_ext?n("div",{staticClass:"price-body",style:{"line-height":t.isMobile?"18px":"inherit",margin:t.isMobile?"8px 0 4px":"0"}},[n("el-button",{staticClass:"add-btn",attrs:{size:"mini",icon:"el-icon-plus"},on:{click:function(){t.fields.ext.push("名称"),t.checkFieldsExt()}}},[t._v("添加\n          ")]),t._l(t.fields.ext,function(e,i){return n("div",{key:"product_field_"+i},[n("label",{staticClass:"item-label"},[t._v("字段名\n              "),n("input",{directives:[{name:"model",rawName:"v-model",value:t.fields.ext[i],expression:"fields.ext[index]"}],staticClass:"item-input",staticStyle:{width:"50%"},attrs:{type:"text"},domProps:{value:t.fields.ext[i]},on:{change:t.checkFieldsExt,input:function(e){e.target.composing||t.$set(t.fields.ext,i,e.target.value)}}})]),n("a",{staticClass:"del-btn",on:{click:function(){t.fields.ext.splice(i,1),t.checkFieldsExt()}}},[t._v("删除")])])})],2):t._e()]),t.fields_check.message?n("div",{staticClass:"el-form-item__tip",style:{color:t.fields_check.color}},[n("span",[t._v(t._s(t.fields_check.message))])]):t._e()],1),n("el-form-item",{class:t.formItemClass,attrs:{label:"优惠券",prop:"support_coupon"}},[n("el-checkbox",{model:{value:t.form.support_coupon,callback:function(e){t.$set(t.form,"support_coupon",e)},expression:"form.support_coupon"}},[t._v("支持")])],1),n("el-form-item",{class:t.formItemClass,attrs:{label:"购买限制",prop:"buy_min"}},[n("el-tooltip",{attrs:{effect:"dark",content:"最小购买量",placement:"top-start"}},[n("el-input-number",{attrs:{"controls-position":"right",min:1,max:1e4,size:"small"},model:{value:t.form.buy_min,callback:function(e){t.$set(t.form,"buy_min",e)},expression:"form.buy_min"}})],1),n("el-tooltip",{attrs:{effect:"dark",content:"最大购买量",placement:"top-start"}},[n("el-input-number",{attrs:{"controls-position":"right",min:1,max:1e4,size:"small"},model:{value:t.form.buy_max,callback:function(e){t.$set(t.form,"buy_max",e)},expression:"form.buy_max"}})],1),t.form.retail_open?n("div",{staticClass:"el-form-item__tip"},[n("span",[t._v("* 只对普通用户有效, 代理分销时不受限制")])]):t._e()],1),n("el-form-item",{staticClass:"buy-password",class:t.formItemClass,attrs:{label:"购买密码",prop:"password"}},[n("el-tooltip",{attrs:{effect:"dark",content:"设置商品购买密码，开启后只有输入密码才能购买",placement:"top-start"}},[n("el-input",{attrs:{type:"text",placeholder:"购买密码(可选)"},model:{value:t.form.password,callback:function(e){t.$set(t.form,"password",e)},expression:"form.password"}},[n("el-checkbox",{attrs:{slot:"prepend"},slot:"prepend",model:{value:t.form.password_open,callback:function(e){t.$set(t.form,"password_open",e)},expression:"form.password_open"}},[t._v("开启")])],1)],1),t.form.retail_open?n("div",{staticClass:"el-form-item__tip"},[n("span",[t._v("* 只对普通用户有效, 代理分销时不受限制\n         "),n("a",{staticClass:"icon-btn",attrs:{title:"查看详情"}},[n("i",{staticClass:"el-icon-info",on:{click:t.showRetailPasswordTip}})])])]):t._e()],1),"admin_free"!==t._project?n("el-form-item",{class:t.formItemClass,attrs:{label:"Webhook",prop:"webhook"}},[n("el-input",{attrs:{type:"text",placeholder:"订单成功后通知URL(可选)"},model:{value:t.form.webhook,callback:function(e){t.$set(t.form,"webhook",e)},expression:"form.webhook"}})],1):t._e(),t.isFromRetail?t._e():n("el-form-item",{class:t.formItemClass,attrs:{label:"库存预警",prop:"count_warn"}},[n("el-input-number",{attrs:{"controls-position":"right",min:0,max:1e7,size:"small"},model:{value:t.form.count_warn,callback:function(e){t.$set(t.form,"count_warn",e)},expression:"form.count_warn"}}),n("div",{staticClass:"el-form-item__tip"},[n("span",[t._v("* 到达预警值后会发送通知邮件，填0不预警")])])],1),n("el-form-item",{class:t.formItemClass,attrs:{label:"库存显示",prop:"inventory"}},[n("el-radio-group",{attrs:{size:"small"},model:{value:t.form.inventory,callback:function(e){t.$set(t.form,"inventory",e)},expression:"form.inventory"}},[n("el-radio-button",{attrs:{label:t.INVENTORY_TYPE.RANGE}},[t._v("大致范围")]),n("el-radio-button",{attrs:{label:t.INVENTORY_TYPE.REAL}},[t._v("实际库存")]),n("el-radio-button",{staticClass:"el-radio-gray",attrs:{label:t.INVENTORY_TYPE.AUTO}},[t._v("跟随店铺")])],1)],1),n("el-form-item",{class:t.formItemClass,attrs:{label:"状态",prop:"enabled"}},[n("el-radio-group",{attrs:{size:"small"},model:{value:t.form.enabled,callback:function(e){t.$set(t.form,"enabled",e)},expression:"form.enabled"}},[n("el-radio-button",{attrs:{label:1}},[t._v("上架")]),n("el-radio-button",{staticClass:"el-radio-gray",attrs:{label:0}},[t._v("下架")])],1)],1),n("el-form-item",{staticStyle:{"margin-top":"36px"}},[n("el-button",{style:{float:t.isMobile?"right":""},attrs:{type:"primary",loading:t.loading},on:{click:t.handleSubmit}},[t._v("\n        "+t._s(t.isAdd?"添加":"编辑")+"商品\n      ")])],1)],1)],1)},mt=[],n("2ada"),n("b107"),_t={RANGE:0,REAL:1,AUTO:2},gt=n("51d1"),bt=n("bd60"),vt=n("b130"),yt=n("8b01"),wt=window.config.functions&&window.config.functions.includes("product_manual"),Ct={components:{QuillEditor:bt.a},props:{_project:{default:"admin_free"},info:{},inBox:{default:!1},userInfo:{},_categories:{}},data:function(){var t=this;return{loading:!1,isMobile:this.$store.state.app.isMobile,PRODUCT_MANUAL:wt,userInfo_:null,upload_url:window.API_HOST+"product/upload",INVENTORY_TYPE:_t,DELIVERY:gt.a,form:{id:null,user_id:null,category_id:null,name:"",description:"",instructions:"",fields:"",delivery:gt.a.AUTO,sort:1e3,buy_min:1,buy_max:100,count_warn:"",inventory:_t.AUTO,support_coupon:!1,password:"",password_open:!1,cost:0,price:0,price_whole:"",enabled:1,retail_open:0,retail_code:"",retail_from_id:null,retail_keep_sync:1,webhook:""},fields:{type:"any",need_ext:!1,ext:[]},price_whole:[],categories:[],retail_options:{price:"",can_edit:1,min_price:0,max_price:99999},formRules:{category_id:[{required:!0,message:"请选择商品分类",trigger:"change"}],name:[{required:!0,message:"请输入商品名称",trigger:"change"}],cost:[{validator:function(t,e,n){var i=Math.round(100*e);i<0?n(Error("成本价不能低于 0")):1e9<i?n(Error("成本价不能超过 10000000")):n()},trigger:"change"}],price:[{required:!0,validator:function(e,n,i){var a=Math.round(100*n);a<Math.round(100*t.form.cost)&&i(Error("商品售价不能低于成本价")),a<1?i(Error("商品售价不能低于 0.01")):1e9<a?i(Error("商品售价不能超过 10000000")):t.isFromRetail&&t.retail_from&&(a<t.retail_from.retail_options.min_price||a>t.retail_from.retail_options.max_price)?i(Error("* 供货商限定价格为: ".concat(Object(yt.a)(t.retail_from.retail_options.min_price)," - ").concat(Object(yt.a)(t.retail_from.retail_options.max_price)))):i()},trigger:"change"}],price_whole:[{validator:function(e,n,i){var a,o;for(a=0;a<t.price_whole.length;a++){if(t.price_whole[a][1]<.01)return void i(Error("批发价格不能低于 0.01"));if(1e7<t.price_whole[a][1])return void i(Error("批发价格不能超过 10000000"));if(o=Math.round(100*t.price_whole[a][1]),t.isFromRetail&&t.retail_from){if(o<t.retail_from.retail_options.price)return void i(Error("批发价格不能低于成本价"));if(o<t.retail_from.retail_options.min_price||o>t.retail_from.retail_options.max_price)return void i(Error("* 供货商限定价格为: ".concat(Object(yt.a)(t.retail_from.retail_options.min_price)," - ").concat(Object(yt.a)(t.retail_from.retail_options.max_price))))}}i()},trigger:"change"}],enabled:[{required:!0,message:"请选择状态",trigger:"change"}]},showRetailFromInfo:!1,retail_from:null,fields_check:{message:"",color:""},retail_price_check:{message:"",color:""},retail_priceLimit_check:{message:"",color:""},retail_code_check:{loading:!1,message:"",color:""}}},computed:{isAdd:function(){return!this.info},formItemClass:function(){return this.isMobile?"product-form-item":""},isFromRetail:function(){return!1},canEditRetail:function(){return!(this.isFromRetail&&null!==this.retail_from&&0===this.retail_from.retail_options.can_edit)},canRetail:function(){return!1}},watch:{loading:function(t,e){this.$emit("update:loading",t),t?e||J.a.isStarted()||J.a.start():J.a.done()}},beforeMount:function(){if(this.userInfo?this.userInfo_=this.userInfo:this.userInfo_=this.$store.state.user.userInfo,this._categories&&this._categories.length&&0<this._categories[0].id?this.categories=this._categories:this.getCategories(),!this.isAdd){for(var t in this.form)this.form.hasOwnProperty(t)&&this.$set(this.form,t,this.info[t]);this.form.cost=1*(this.info.cost/100).toFixed(2),this.form.price=1*(this.info.price/100).toFixed(2),this.form.support_coupon=1===this.info.support_coupon,this.form.password_open=1===this.info.password_open;try{this.price_whole=JSON.parse(this.form.price_whole).map(function(t){return[t[0],(t[1]/100).toFixed(2)]})}catch(t){this.price_whole=[]}null==this.price_whole&&(this.price_whole=[]),this.form.fields&&"{"===this.form.fields[0]&&Object.assign(this.fields,JSON.parse(this.form.fields)),this.retail_from=this.info.retail_from,this.retail_from&&0===this.retail_from.retail_options.can_edit&&(this.form.retail_keep_sync=1),this.info.retail_options&&(Object.assign(this.retail_options,this.info.retail_options),this.retail_options.price=1*(this.retail_options.price/100).toFixed(2),this.retail_options.min_price=1*(this.retail_options.min_price/100).toFixed(2),this.retail_options.max_price=1*(this.retail_options.max_price/100).toFixed(2))}this.userInfo&&(this.form.user_id=this.userInfo.id)},methods:{moneyFilter:yt.a,renderDelta:vt.d,getCategories:function(){var t=this,e={search:"simple",val:"list"};this.info?e.user_id=this.info.user_id:this.userInfo&&(e.user_id=this.userInfo.id),Object(it.d)(e).then(function(e){t.categories=e.data,t.categories.length||t.$alert("请先添加商品分类","提示",{confirmButtonText:"去添加"}).then(function(){t.$router.push({path:"/m/product/category",query:{action:"create"}})})})},addRetailProduct:function(){var t=this;this.$prompt("请输入供货商提供的对接密钥","请输入对接密钥",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/.{6,32}/,inputErrorMessage:"对接密钥为 6 到 32 位",closeOnClickModal:!1}).then(function(e){var n=e.value;t.loading=!0,Object(gt.c)(n).then(function(e){if("product"===e.message){var i=e.data;t.form.from_code=n,t.form.name=i.name,t.form.description=i.description,t.form.instructions=i.instructions,t.$refs["editor-description"].setValue(i.description),t.$refs["editor-instructions"].setValue(i.instructions),t.form.cost=1*(i.retail_options.price/100).toFixed(2),t.form.price=1*(i.retail_options.min_price/100).toFixed(2),t.retail_from=i}else"user"===e.message?(window._tmp_shop_retail_code=n,t.$emit("changeTab",{to:"product_retail"}),alert("todo")):t.$msgbox({message:e.message,title:"错误",type:"error"})}).finally(function(){t.loading=!1})})},showRetailPriceTip:function(){this.$msgbox({message:"\n        当供货商修改商品进货价格时，<br>您设置的价格会根据供货商的修改幅度同步更改。<br><br>\n\n        举例：<br>\n        供货商设置进货价为 10 元，<br>您设置的价格为 15 元；<br>\n        当供货商将进货价提高为 11 元时，<br>您的价格将自动修改为 16 元。\n        ",title:"供货商修改价格说明",dangerouslyUseHTMLString:!0})},showRetailPasswordTip:function(){this.$msgbox({message:"\n此选项仅在用户直接购买时有效，<br>代理进货时不受限制。\n",title:"购买密码说明",dangerouslyUseHTMLString:!0})},checkFieldsExt:function(){if(this.fields_check.message="",!this.fields.need_ext)return!0;if(!this.fields.ext.length)return this.fields_check.message="请至少添加一个字段",!(this.fields_check.color="#FF4949");for(var t=0;t<this.fields.ext.length;t++)if(!this.fields.ext[t].length)return this.fields_check.message="第".concat(t+1,"个字段的名称不能为空"),!(this.fields_check.color="#F7BA2A")},checkRetailPrice:function(){return this.form.retail_open?""===this.retail_options.price?(this.retail_price_check.message="请输入 代理进货价",!(this.retail_price_check.color="#F7BA2A")):+this.retail_options.price<+this.form.cost?(this.retail_price_check.message="代理进货价不能低于商品成本价",!(this.retail_price_check.color="#FF4949")):1e7<+this.retail_options.price?(this.retail_price_check.message="价格不能超过 10,000,000",!(this.retail_price_check.color="#FF4949")):(this.retail_price_check.message="",!(this.retail_price_check.color="")):(this.retail_price_check.message="",!(this.retail_price_check.color=""))},checkRetailPriceLimit:function(){return this.form.retail_open?""===this.retail_options.min_price?(this.retail_priceLimit_check.message="请输入 代理最低零售价",!(this.retail_priceLimit_check.color="#F7BA2A")):""===this.retail_options.max_price?(this.retail_priceLimit_check.message="请输入 代理最高零售价",!(this.retail_priceLimit_check.color="#F7BA2A")):+this.retail_options.min_price>+this.retail_options.max_price?(this.retail_priceLimit_check.message="代理最高零售价 需要大于 代理最低零售价",!(this.retail_priceLimit_check.color="#FF4949")):1e7<+this.retail_options.min_price||1e7<+this.retail_options.max_price?(this.retail_priceLimit_check.message="价格不能超过 10,000,000",!(this.retail_priceLimit_check.color="#FF4949")):(this.retail_priceLimit_check.message="",!(this.retail_priceLimit_check.color="")):(this.retail_priceLimit_check.message="",!(this.retail_priceLimit_check.color=""))},checkFormPriceWhole:function(){return this.$refs.form.validateField("price_whole")},checkRetailCodeAvailable:(ca=Object(nt.a)(regeneratorRuntime.mark(function t(){var e,n,i=arguments;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e=!(0<i.length&&void 0!==i[0])||i[0],this.form.retail_code.length<6)return this.retail_code_check.message="对接密钥为 6 到 32 位",this.retail_code_check.color="#FF4949",t.abrupt("return",!1);t.next=5;break;case 5:if(32<this.form.retail_code.length)return this.retail_code_check.message="对接密钥为 6 到 32 位",this.retail_code_check.color="#FF4949",t.abrupt("return",!1);t.next=9;break;case 9:if(e){t.next=11;break}return t.abrupt("return",""===this.retail_code_check.message);case 11:return this.retail_code_check.message="对接密钥检查中...请稍后",this.retail_code_check.color="#F7BA2A",this.retail_code_check.loading=!0,t.prev=14,t.next=17,Object(gt.c)(this.form.retail_code);case 17:if(!(n=t.sent).data||n.data.id===this.form.id&&"product"===n.message){t.next=24;break}this.retail_code_check.message="对接密钥已被使用，请重新输入",this.retail_code_check.color="#FF4949",this.$notify({title:"提示",message:this.retail_code_check.message,type:"error"}),t.next=28;break;case 24:return this.retail_code_check.message="",this.retail_code_check.color="",this.$notify({title:"提示",message:"当前对接密钥可用",type:"success",duration:500}),t.abrupt("return",!0);case 28:t.next=34;break;case 30:t.prev=30,t.t0=t.catch(14),this.retail_code_check.message="对接密钥检查失败，请重新输入";case 34:return t.prev=34,this.retail_code_check.loading=!1,t.finish(34);case 37:return t.abrupt("return",!1);case 38:case"end":return t.stop()}},t,this,[[14,30,34,37]])})),function(){return ca.apply(this,arguments)}),handleRandomRetailCode:function(){this.form.retail_code=Object(vt.c)(8).toLocaleUpperCase(),this.checkRetailCodeAvailable()},handleSubmit:(la=Object(nt.a)(regeneratorRuntime.mark(function t(){var e=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:this.form.description=this.$refs["editor-description"].getValue(),this.form.instructions=this.$refs["editor-instructions"].getValue(),this.$refs.form.validate(function(){var t=Object(nt.a)(regeneratorRuntime.mark(function t(n){var i,a;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n){t.next=3;break}return e.$msgbox({message:"信息填写不完整, 请检查",title:"提示",type:"error"}),t.abrupt("return",!1);case 3:if(e.form.retail_open)return t.next=6,e.checkRetailPrice();t.next=16;break;case 6:if(t.sent){t.next=8;break}return t.abrupt("return",e.$msgbox({message:e.retail_price_check.message,title:"提示",type:"error"}).then(function(){e.$refs.retail_price.focus()}));case 8:return t.next=10,e.checkRetailPriceLimit();case 10:if(t.sent){t.next=12;break}return t.abrupt("return",e.$msgbox({message:e.retail_priceLimit_check.message,title:"提示",type:"error"}).then(function(){e.$refs.retail_min_price.focus()}));case 12:return t.next=14,e.checkRetailCodeAvailable(!1);case 14:if(t.sent){t.next=16;break}return t.abrupt("return",e.$msgbox({message:e.retail_code_check.message,title:"提示",type:"error"}).then(function(){e.$refs.retail_code.focus()}));case 16:e.loading=!0,(i="string"==typeof e.form.category_id)&&(e.form.category_id="+"+e.form.category_id,e.form.category={name:e.form.category_id}),(a=Object.assign({},e.form)).fields=JSON.stringify(e.fields),a.price_whole=JSON.stringify(e.price_whole.map(function(t){return[t[0],parseInt(100*t[1])]})),e.isAdd&&delete a.id,a.retail_open?a.retail_options=e.retail_options:delete a.retail_code,Object(gt.f)(a).then(function(){e.loading=!1,e.inBox?(i&&e.$emit("refreshCategories"),e.$notify({title:"提示",message:"编辑商品成功",type:"success",duration:3e3})):(i&&(e.form.category_id=null,e.getCategories()),e.$msgbox({title:"添加商品成功",showCancelButton:!0,dangerouslyUseHTMLString:!0,confirmButtonText:"查看商品",cancelButtonText:"继续添加"}).then(function(){e.$router.push("/m/product/list")})),e.$emit("submit",!0)}).catch(function(t){e.$msgbox({message:t.message,title:"错误",type:"error",dangerouslyUseHTMLString:!0})}).finally(function(){e.loading=!1});case 25:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}());case 3:case"end":return t.stop()}},t,this)})),function(){return la.apply(this,arguments)})}},n("7b74"),xt=Object(b.a)(Ct,ht,mt,!1,null,null,null).exports,kt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{ref:"container",class:{"app-container":!t.userInfo&&!t._inBox}},[n("el-collapse-transition",[n("div",{directives:[{name:"show",rawName:"v-show",value:t.showAddBox,expression:"showAddBox"}],staticClass:"apply-box"},[n("el-button",{staticStyle:{float:"right",margin:"10px 15px"},attrs:{icon:"el-icon-close",type:"danger",size:"small"},on:{click:function(e){return t.onBoxSubmit(!1)}}}),t.showAddBox||t.addBoxLoaded?n("el-card",{staticClass:"my-card"},[n("product-box",{attrs:{"in-box":!0,userInfo:t.userInfo,info:t.editInfo,_categories:t.categories},on:{refreshCategories:t.getCategories,changeTab:function(e){return t.$emit("changeTab",e)},submit:t.onBoxSubmit}})],1):t._e()],1)]),n("el-col",{staticClass:"no-bottom-form",attrs:{span:24}},[n("el-form",{staticClass:"list-pre-table",attrs:{inline:!0}},[t.loadCategory?n("el-form-item",{staticClass:"mobile-full-width"},[n("el-select",{staticClass:"mobile-full-width",attrs:{placeholder:"商品分类",size:"small","no-data-text":"无分类数据"},on:{change:t.getList},model:{value:t.where.category_id,callback:function(e){t.$set(t.where,"category_id",e)},expression:"where.category_id"}},[n("el-option",{attrs:{label:"全部",value:-1}}),t._l(t.categories,function(t){return n("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})],2)],1):t._e(),n("el-form-item",{staticClass:"mobile-full-width"},[n("el-input",{attrs:{placeholder:"请输入",size:"small"},model:{value:t.search.value,callback:function(e){t.$set(t.search,"value",e)},expression:"search.value"}},[n("el-select",{staticStyle:{width:"90px"},attrs:{slot:"prepend",placeholder:"搜索类型",size:"small"},slot:"prepend",model:{value:t.search.type,callback:function(e){t.$set(t.search,"type",e)},expression:"search.type"}},[n("el-option",{attrs:{label:"ID",value:"id"}}),"admin"===t._project?n("el-option",{attrs:{label:"商户ID",value:"user_id"}}):t._e(),n("el-option",{attrs:{label:"名称",value:"name"}}),n("el-option",{attrs:{label:"分类ID",value:"category_id"}})],1)],1)],1),n("el-form-item",{staticClass:"fix-height"},[n("el-button",{attrs:{size:"small"},on:{click:t.handleSearch}},[t._v("搜索")])],1),n("el-form-item",{staticClass:"right-toolbox"},["admin_free"!==t._project?n("el-link",{staticStyle:{"margin-right":"8px"},on:{click:t.handleRetailAdd}},[n("icon",{attrs:{name:"regular/angle-double-right"}}),t._v(" 货源对接")],1):t._e(),n("el-link",{on:{click:t.handleAdd}},[n("icon",{attrs:{name:"regular/plus"}}),t._v(" 添加商品")],1)],1),n("span",{staticStyle:{clear:"both"}})],1)],1),n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"list-table",attrs:{data:t.list.data,stripe:"",border:""},on:{"filter-change":t.handleFilterChange,"selection-change":function(e){return t.checkedIds=e.map(function(t){return t.id}).join(",")}}},[n("el-table-column",{attrs:{type:"selection",width:"40"}}),"admin"===t._project?n("el-table-column",{attrs:{prop:"id",label:"ID",width:"70"}}):t._e(),"admin"!==t._project||t.userInfo?t._e():n("el-table-column",{attrs:{prop:"user_id",label:"商户ID",width:"70"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("a",{staticClass:"text-nowrap line-btn",on:{click:function(n){return t.goUserDetail(e.row.user_id)}}},[t._v(t._s(e.row.user_id))])]}}],null,!1,4213310200)}),n("el-table-column",{attrs:{prop:"name",label:"商品名称(点击查看)","min-width":"180","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[n("a",{staticClass:"line-btn",on:{click:function(n){return t.showProductInfo(e.row)}}},[t._v(t._s(e.row.name)+"\n          "),e.row.retail_from_id?n("el-tag",{staticClass:"el-tag-label"},[t._v("分销商品")]):t._e(),e.row.delivery===t.DELIVERY.MANUAL?n("el-tag",{staticClass:"el-tag-label"},[t._v("手动发货")]):t._e()],1)]}}])}),n("el-table-column",{attrs:{prop:"category",label:"分类(点击修改)","min-width":"100","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[n("a",{staticClass:"line-btn",on:{click:function(n){return t.handleEditCategory(e.row)}}},[t._v(t._s(e.row.category?e.row.category.name:"未知#"+e.row.category_id))])]}}])}),n("el-table-column",{attrs:{prop:"count_sold",label:"已售",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.retail_from_id?n("span",[t._v(t._s(e.row.count_sold))]):n("a",{staticClass:"line-btn",on:{click:function(n){return t.goCards("count_sold",e.row)}}},[t._v(t._s(e.row.count_sold))])]}}])}),n("el-table-column",{attrs:{prop:"count",label:"库存",width:"90"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.retail_from_id?n("span",[t._v(t._s(e.row.count))]):e.row.delivery===t.DELIVERY.MANUAL?n("div",["string"==typeof e.row.count?n("input",{directives:[{name:"model",rawName:"v-model",value:e.row.count,expression:"scope.row.count"}],staticClass:"table-input",attrs:{size:"small",title:"库存"},domProps:{value:e.row.count},on:{blur:function(n){return t.handleSetCount(e.row)},keyup:function(n){return!n.type.indexOf("key")&&t._k(n.keyCode,"enter",13,n.key,"Enter")?null:t.handleSetCount(e.row)},input:function(n){n.target.composing||t.$set(e.row,"count",n.target.value)}}}):t._e(),"number"==typeof e.row.count?n("a",{staticClass:"line-btn",on:{click:function(){e.row.count_old=e.row.count,e.row.count=e.row.count+""}}},[t._v(t._s(e.row.count))]):t._e()]):n("a",{staticClass:"line-btn",on:{click:function(n){return t.goCards("count",e.row)}}},[t._v(t._s(e.row.count))])]}}])},[n("template",{slot:"header"},[n("a",{staticClass:"icon-btn",staticStyle:{"font-weight":"normal"},attrs:{title:"刷新库存"},on:{click:t.handleCountSync}},[t._v("\n          库存 "),n("icon",{attrs:{name:"light/sync"}})],1)])],2),n("el-table-column",{attrs:{prop:"enabled",label:"上架",width:"70","column-key":"enabled",filters:t.enabledFilter,"filter-placement":"bottom"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-switch",{attrs:{"active-value":1,"inactive-value":0,"active-color":"#4cd964"},on:{change:function(n){return t.handleProductEnabled(e.row)}},model:{value:e.row.enabled,callback:function(n){t.$set(e.row,"enabled",n)},expression:"scope.row.enabled"}})]}}])}),n("el-table-column",{attrs:{prop:"sort",label:"排序",width:"70"},scopedSlots:t._u([{key:"default",fn:function(e){return["string"==typeof e.row.sort?n("input",{directives:[{name:"model",rawName:"v-model",value:e.row.sort,expression:"scope.row.sort"}],staticClass:"table-input",attrs:{size:"small",title:"排序"},domProps:{value:e.row.sort},on:{blur:function(n){return t.handleSetSort(e.row)},keyup:function(n){return!n.type.indexOf("key")&&t._k(n.keyCode,"enter",13,n.key,"Enter")?null:t.handleSetSort(e.row)},input:function(n){n.target.composing||t.$set(e.row,"sort",n.target.value)}}}):t._e(),"number"==typeof e.row.sort?n("a",{staticClass:"line-btn",on:{click:function(){e.row.sort_old=e.row.sort,e.row.sort=e.row.sort+""}}},[t._v(t._s(e.row.sort))]):t._e()]}}])}),n("el-table-column",{attrs:{label:"操作",width:"90",fixed:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("a",{staticClass:"icon-btn",on:{click:function(n){return t.showUrl(e.row)}}},[t._v("直链")]),n("a",{staticClass:"icon-btn",on:{click:function(n){return t.handleEdit(e.row)}}},[n("icon",{attrs:{name:"light/pencil"}})],1),n("a",{staticClass:"icon-btn",on:{click:function(n){return t.handleDelete(e.row)}}},[n("icon",{attrs:{name:"light/trash-alt"}})],1)]}}])})],1),n("el-col",{staticClass:"list-after-action",staticStyle:{"padding-top":"8px","text-align":"left"},attrs:{span:24}},[n("el-form",{staticClass:"no-bottom-form",attrs:{inline:!0}},[n("el-form-item",{attrs:{label:"选中"}},[n("el-button",{attrs:{size:"small"},on:{click:t.checkDelete}},[t._v("删除")]),n("el-button",{attrs:{size:"small"},on:{click:t.checkEnable}},[t._v("上架")]),n("el-button",{attrs:{size:"small"},on:{click:t.checkDisable}},[t._v("下架")])],1)],1)],1),n("el-col",{staticClass:"list-after-action",staticStyle:{"padding-top":"12px","text-align":"right"},attrs:{span:24}},[0<t.list.total?n("el-pagination",{staticClass:"pagination",attrs:{"page-size":t.list.per_page,"page-sizes":[10,20,30,40,50,100],total:t.list.total,"current-page":t.list.current_page,layout:"total, sizes, prev, pager, next, jumper"},on:{"update:currentPage":function(e){return t.$set(t.list,"current_page",e)},"update:current-page":function(e){return t.$set(t.list,"current_page",e)},"current-change":t.onChangePage,"size-change":t.onChangePageSize}}):t._e()],1),t.editCategory?n("product-category",{attrs:{categories:t.categories,info:t.editCategory,loadCategory:t.loadCategory},on:{close:t.editCategoryCallback}}):t._e()],1)},At=[],St=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-dialog",{staticClass:"product-category",attrs:{title:"修改商品分类",visible:t.visible,"close-on-click-modal":!1},on:{"update:visible":function(e){t.visible=e}}},[n("el-form",{ref:"form",attrs:{model:t.form,"label-position":t.isMobile?"top":"","label-width":"90px",rules:t.formRules}},[n("el-form-item",{class:t.isMobile?"item-container":"",style:t.isMobile?"margin-top: -32px":"",attrs:{label:"分类",prop:"category_id"}},[n("el-select",{staticStyle:{display:"block"},attrs:{"allow-create":"",filterable:"","no-data-text":"请输入分类名称"},model:{value:t.form.category_id,callback:function(e){t.$set(t.form,"category_id",e)},expression:"form.category_id"}},t._l(t.categories_,function(t){return n("el-option",{key:t.id,attrs:{value:t.id,label:t.name}})}),1)],1)],1),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{nativeOn:{click:function(e){return t.handleClose(!1)}}},[t._v("取消")]),n("el-button",{attrs:{type:"primary",loading:t.loading},nativeOn:{click:function(e){return t.handleSubmit(e)}}},[t._v("确认修改\n    ")])],1)],1)},Et=[],Ot={props:{info:{},categories:{},loadCategory:{}},data:function(){return{loading:!1,isMobile:this.$store.state.app.isMobile,visible:!0,form:{id:this.info.id,category_id:this.info.category_id},formRules:{category_id:[{required:!0,message:"请选择商品分类",trigger:"blur"}]},categories_:[]}},watch:{visible:function(t){t||this.$emit("close",!1)}},mounted:function(){var t,e=this;this.loadCategory?this.categories_=this.categories:(t={search:"simple",val:"list"},this.info&&(t.user_id=this.info.user_id),Object(it.d)(t).then(function(t){e.categories_=t.data}))},methods:{handleSubmit:function(){var t=this;this.$refs.form.validate(function(e){var n,i;e&&(t.loading=!0,n=t.form.category_id,(i="string"==typeof n)&&(n="+"+n),Object(gt.b)(t.form.id,n).then(function(e){t.loading=!1,t.$notify({title:"提示",message:"修改商品分类成功",type:"success",duration:3e3}),t.$emit("close",{category:e.data,isAddCategory:i})}).catch(function(){t.loading=!1}))})},handleClose:function(){var t=0<arguments.length&&void 0!==arguments[0]&&arguments[0];this.visible=!1,this.$emit("close",t)}}},n("fca0"),It=Object(b.a)(Ot,St,Et,!1,null,null,null).exports,Tt={props:{userInfo:{type:Object,default:null},filter:{default:null},_project:{default:"admin_free"},_inBox:{}},components:{productBox:xt,productCategory:It},data:function(){return{loading:!1,showAddBox:!1,addBoxLoaded:!1,DELIVERY:gt.a,search:{type:"name",value:""},where:{category_id:-1},categories:[{id:-2,name:"加载中"}],list:{current_page:1,data:[],from:1,last_page:1,next_page_url:null,per_page:+localStorage.getItem("pageSize")||10,prev_page_url:null,to:0,total:0},checkedIds:"",enabledFilter:[{text:"上架",value:1,type:"primary"},{text:"未上架",value:0,type:"info"}],editInfo:null,editCategory:null}},computed:{loadCategory:function(){return"merchant"===this._project||"admin_free"===this._project||this.userInfo}},watch:{loading:function(t,e){t?e||J.a.isStarted()||J.a.start():J.a.done()}},mounted:function(){this.$route.query.category_id&&(this.where.category_id=this.$route.query.category_id),this.filter&&this.filter.category_id&&(this.where.category_id=this.filter.category_id),this.handleSearch(),this.loadCategory?this.getCategories():this.categories=[]},methods:{searchByCategory:function(t){this.where.category_id=t,this.handleSearch()},getCategories:function(){var t=this,e={search:"simple",val:"list"};this.userInfo&&(e.user_id=this.userInfo.id),Object(it.d)(e).then(function(e){t.categories=e.data})},getList:function(){var t=this;this.loading=!0,this.where.current_page=this.list.current_page,this.where.per_page=this.list.per_page,this.userInfo&&(this.where.user_id=this.userInfo.id),Object(gt.h)(this.where).then(function(e){t.list=e.data,t.loading=!1})},handleSearch:function(){var t={search:this.search.type,val:this.search.value};Object.assign(this.where,t),this.getList()},handleFilterChange:function(t){var e={};t.enabled?e.enabled=t.enabled.join(","):e.enabled=null,Object.assign(this.where,e),this.getList()},onChangePage:function(){this.getList()},onChangePageSize:function(t){localStorage.setItem("pageSize",t),this.list.per_page=t,this.getList()},showProductInfo:function(t){var e=Object(vt.c)(8),n="\n        <p>商品名称:&nbsp;".concat(t.name).concat(t.retail_from_id?'<span class="el-tag el-tag-label">分销商品</span>':"","</p>\n        <p>商品分类:&nbsp;").concat(t.category?t.category.name:"未知#"+t.category_id,'</p>\n        <p>商品介绍:&nbsp;<a class="expand-description" href="javascript:$(\'#').concat(e,'\').toggle()">查看</a>\n          <div id="').concat(e,'" style="border: 1px solid #eee;display: none">').concat(Object(vt.d)(t.description),"</div>\n        </p>\n        <p>售价:&nbsp;￥").concat((t.price/100).toFixed(2),"</p>\n        <p>成本价:&nbsp;￥").concat((t.cost/100).toFixed(2),'</p>\n        <p>商品链接:&nbsp;<br><a class="icon-btn" href="').concat(t.url,'" target="_blank">').concat(t.url,"</a>\n        &nbsp;").concat(t.password_open?"密码:&nbsp;"+t.password:"","</p>\n        ");t.retail_open&&(n+='\n        <p>对接密钥:&nbsp;<br><input class="small-input" readonly value="'.concat(t.retail_code,'" onclick="select();" style="width: 260px"></p>\n        ')),this.$msgbox({title:"商品详情",message:n,dangerouslyUseHTMLString:!0,customClass:"ann-box"})},showUrl:function(t){var e='<a class="icon-btn" href="'.concat(t.url,'" target="_blank">').concat(t.url,"</a>");t.password_open&&(e+="<br>密码: "+t.password),this.$msgbox({title:"单独链接",message:e,dangerouslyUseHTMLString:!0})},goCards:function(t,e){this.$router.push({path:"/admin/product/card/list",query:{type:t,category_id:e.category_id,product_id:e.id}})},handleProductEnabled:function(t){if(t.retail_from_id){if(!t.retail_from)return this.$msgbox({message:"当前商品为分销商品，供货商已将商品删除, 因此您无法上架此商品",title:"操作失败",type:"error"}),t.enabled=!1;if(!t.retail_from.enabled)return this.$msgbox({message:"当前商品为分销商品，供货商已将商品下架, 因此您无法上架此商品",title:"操作失败",type:"error"}),t.enabled=!1;if(!t.retail_from.retail_open)return this.$msgbox({message:"当前商品为分销商品，供货商已关闭商品分销, 因此您无法上架此商品",title:"操作失败",type:"error"}),t.enabled=!1}Object(gt.g)(t.id,t.enabled)},handleSetSort:function(t){var e=this;parseInt(t.sort)!==t.sort_old?(this.loading=!0,Object(gt.j)(t.id,t.sort).then(function(){e.getList()}).catch(function(){e.loading=!1})):t.sort=parseInt(t.sort)},handleSetCount:function(t){var e=this;parseInt(t.count)!==t.count_old?(this.loading=!0,Object(gt.i)(t.id,t.count).finally(function(){t.count=parseInt(t.count),e.loading=!1})):t.count=parseInt(t.count)},handleDelete:function(t){var e=this,n=t.name;this.$confirm("删除商品<"+n+">? <br>选中商品的卡密将会一起删除<br>此操作不可恢复","提示",{type:"warning",dangerouslyUseHTMLString:!0}).then(function(){e.loading=!0,Object(gt.e)(t.id).then(function(){e.$notify({title:"操作成功",message:"商品<"+n+">已删除",type:"info"}),e.getList()}).catch(function(){e.loading=!1})})},checkDelete:function(){var t=this;this.checkedIds.length&&this.$confirm("批量删除选中商品? <br>选中商品的卡密将会一起删除<br>此操作不可恢复","提示",{type:"warning",dangerouslyUseHTMLString:!0}).then(function(){t.loading=!0,Object(gt.e)(t.checkedIds).then(function(){t.$notify({title:"操作成功",message:"选中商品已删除",type:"info"}),t.getList()}).catch(function(){t.loading=!1})})},checkEnable:function(){var t=this;this.checkedIds.length&&this.$confirm("批量上架选中商品? ","提示",{type:"warning"}).then(function(){t.loading=!0,Object(gt.g)(t.checkedIds,1).then(function(){t.$notify({title:"操作成功",message:"选中商品已上架",type:"success"}),t.getList()}).catch(function(){t.loading=!1})})},checkDisable:function(){var t=this;this.checkedIds.length&&this.$confirm("批量下架选中商品? ","提示",{type:"warning"}).then(function(){t.loading=!0,Object(gt.g)(t.checkedIds,0).then(function(){t.$notify({title:"操作成功",message:"选中商品已下架",type:"info"}),t.getList()}).catch(function(){t.loading=!1})})},handleCountSync:function(){var t=this;this.$notify.info({title:"请稍等",message:"刷新库存可能会消耗较长时间",duration:2e3}),this.loading=!0,Object(gt.d)(this.userInfo?this.userInfo.id:null).then(function(){t.$notify.success({title:"成功",message:"商品库存已刷新",duration:2e3}),t.getList()}).catch(function(){t.loading=!1})},handleAdd:(fa=Object(nt.a)(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:t.next=4;break;case 4:this.$router.push("/admin/product/add"),t.next=18;break;case 8:if(this.userInfo){t.next=10;break}return t.abrupt("return",this.$alert("请在商户列表选择商户后添加",{type:"error"}));case 10:if(window.scrollTo(0,0),this.showAddBox&&this.editInfo)return t.next=14,this.onBoxSubmit(!1);t.next=14;break;case 14:return this.addBoxLoaded=!0,t.next=17,this.$nextTick();case 17:this.showAddBox=!0;case 18:case"end":return t.stop()}},t,this)})),function(){return fa.apply(this,arguments)}),handleRetailAdd:function(){if(!this.userInfo)return this.$alert("请在商户列表选择商户后添加",{type:"error"});this.$emit("changeTab",{to:"product_retail"})},onBoxSubmit:(ua=Object(nt.a)(regeneratorRuntime.mark(function t(e){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e&&this.getList(),this.showAddBox=!1,t.next=4,this.$nextTick();case 4:this.addBoxLoaded=!1,this.editInfo=null;case 6:case"end":return t.stop()}},t,this)})),function(t){return ua.apply(this,arguments)}),goUserDetail:function(t){},handleEdit:(da=Object(nt.a)(regeneratorRuntime.mark(function t(e){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.retail_from_id){t.next=7;break}if(e.retail_from){t.next=4;break}return this.$msgbox({message:"当前商品为分销商品，供货商已将商品删除 因此您无法编辑此商品",title:"操作失败",type:"error"}),t.abrupt("return");case 4:if(e.retail_from.retail_open){t.next=7;break}return this.$msgbox({message:"当前商品为分销商品，供货商已关闭商品分销, 因此您无法编辑此商品",title:"操作失败",type:"error"}),t.abrupt("return");case 7:if(window.scrollTo(0,0),this.showAddBox)return t.next=11,this.onBoxSubmit(!1);t.next=11;break;case 11:return this.editInfo=e,this.addBoxLoaded=!0,t.next=15,this.$nextTick();case 15:this.showAddBox=!0;case 16:case"end":return t.stop()}},t,this)})),function(t){return da.apply(this,arguments)}),editCallback:function(t){this.editInfo=null,t&&this.getList()},handleEditCategory:function(t){this.editCategory=t},editCategoryCallback:function(t){t.isAddCategory&&this.categories.push(t.category),t&&t.category&&(this.editCategory.category_id=t.category.id,this.editCategory.category=t.category),this.editCategory=null}}},n("8180"),$t=Object(b.a)(Tt,kt,At,!1,null,null,null).exports,Rt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{class:{"app-container":!t.inBox}},[n("h3",{staticStyle:{margin:"4px 0 28px 0"}},[t._v("添加卡密")]),n("el-form",{ref:"form",attrs:{model:t.form,"label-width":t.labelWidth,rules:t.formRules}},[n("el-form-item",{attrs:{label:"类型"}},[n("el-radio-group",{attrs:{size:"small"},on:{change:t.handleTypeChange},model:{value:t.form.type,callback:function(e){t.$set(t.form,"type",e)},expression:"form.type"}},[n("el-radio-button",{attrs:{label:t.CARD_TYPE.TYPE_ONETIME}},[t._v("一次性")]),n("el-radio-button",{attrs:{label:t.CARD_TYPE.TYPE_REPEAT}},[t._v("重复销售")])],1),t.form.type===t.CARD_TYPE.TYPE_REPEAT?n("span",{staticClass:"red-text",staticStyle:{"font-size":"12px",display:"block","line-height":"18px"}},[t._v("注意：将会限制商品最大购买量为1件")]):t._e()],1),n("el-form-item",{attrs:{label:"商品",prop:"product_id"}},[n("el-select",{attrs:{"no-data-text":"请先添加分类"},on:{change:t.getProducts},model:{value:t.form.category_id,callback:function(e){t.$set(t.form,"category_id",e)},expression:"form.category_id"}},t._l(t.categories,function(t){return n("el-option",{key:t.id,attrs:{value:t.id,label:t.name}})}),1),n("el-select",{model:{value:t.form.product_id,callback:function(e){t.$set(t.form,"product_id",e)},expression:"form.product_id"}},t._l(t.products,function(t){return n("el-option",{key:t.id,attrs:{value:t.id,label:t.name}})}),1)],1),n("el-form-item",{attrs:{label:"卡密",prop:"card"}},[t.form.type===t.CARD_TYPE.TYPE_ONETIME?n("el-input",{attrs:{type:"textarea",autosize:{minRows:10,maxRows:10},placeholder:"卡号+空格+密码，一行一张卡\n如：ABCDEFG 123456\n(卡密长度不得超过100位)"},model:{value:t.form.card,callback:function(e){t.$set(t.form,"card",e)},expression:"form.card"}}):n("el-input",{attrs:{type:"text",placeholder:"卡号+空格+密码"},model:{value:t.form.card,callback:function(e){t.$set(t.form,"card",e)},expression:"form.card"}})],1),t.form.type===t.CARD_TYPE.TYPE_REPEAT?n("el-form-item",{attrs:{label:"可售",prop:"count_all",rules:[{required:!0,message:"请输入可售总次数",trigger:"blur"},{type:"number",min:1,max:1e7,message:"可售总次数不能超过10000000"}]}},[n("el-input",{attrs:{type:"number",placeholder:"请输入可售总次数"},model:{value:t.form.count_all,callback:function(e){t.$set(t.form,"count_all",t._n(e))},expression:"form.count_all"}})],1):t._e(),n("el-form-item",[n("el-tooltip",{attrs:{effect:"dark",content:"选中后表示重复的卡密将不会加入库存中",placement:"top-start"}},[n("el-checkbox",{model:{value:t.form.is_check,callback:function(e){t.$set(t.form,"is_check",e)},expression:"form.is_check"}},[t._v("检查重复的卡密")])],1)],1),n("el-form-item",[n("el-button",{attrs:{type:"primary",loading:t.loading||t.uploading},on:{click:t.onSubmit}},[t._v("添加")]),"admin"===t._project||"merchant"===t._project?n("p",{staticClass:"red-text"},[t._v("注意：每位商户最多可以添加 "),n("b",[t._v("10000")]),t._v(" 条卡密记录（不包含已售出）（重复销售类型只算1条），"),n("br"),t._v("\n        超出限制会添加失败，请合理配置商品库存。")]):t._e()],1)],1),t.uploading?n("div",{staticClass:"v-modal",staticStyle:{"z-index":"1010"}}):t._e(),t.uploading?n("div",{staticClass:"el-message-box__wrapper",staticStyle:{"z-index":"1011"}},[n("div",{staticStyle:{position:"relative",display:"inline-block",width:"250px","background-color":"#fff","border-radius":"4px",border:"1px solid #ebeef5"}},[n("p",[t._v("正在上传 "+t._s(t.upload.now)+"/"+t._s(t.upload.all))])])]):t._e()],1)},jt=[],Pt=n("45fe").a,Dt=Object(b.a)(Pt,Rt,jt,!1,null,null,null).exports,Lt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{ref:"container",class:{"app-container":!t.userInfo}},[n("el-collapse-transition",[n("div",{directives:[{name:"show",rawName:"v-show",value:t.showAddBox,expression:"showAddBox"}],staticClass:"apply-box"},[n("el-button",{staticStyle:{float:"right",margin:"10px 15px"},attrs:{icon:"el-icon-close",type:"danger",size:"small"},on:{click:function(e){t.showAddBox=!1}}}),t.showAddBox||t.addBoxLoaded?n("el-card",{staticClass:"my-card"},[n("card-add",{attrs:{"in-box":!0,userInfo:t.userInfo},on:{submit:t.onAdd}})],1):t._e()],1)]),n("el-col",{staticClass:"no-bottom-form",attrs:{span:24}},[n("el-form",{staticClass:"list-pre-table",attrs:{inline:!0}},[n("el-form-item",{staticClass:"mobile-full-width"},[n("el-select",{staticClass:"mobile-full-width",attrs:{size:"small","no-data-text":"无分类数据"},on:{change:t.getProducts},model:{value:t.where.category_id,callback:function(e){t.$set(t.where,"category_id",e)},expression:"where.category_id"}},[n("el-option",{attrs:{label:"全部分类",value:-1}}),t._l(t.categories,function(t){return n("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})],2),0<t.where.category_id?n("el-select",{staticClass:"mobile-full-width",attrs:{size:"small"},on:{change:t.getList},model:{value:t.where.product_id,callback:function(e){t.$set(t.where,"product_id",e)},expression:"where.product_id"}},[n("el-option",{attrs:{label:"全部商品",value:-1}}),t._l(t.products,function(t){return n("el-option",{key:t.id,attrs:{value:t.id,label:t.name}})})],2):t._e()],1),n("el-form-item",{staticClass:"mobile-full-width"},[n("el-input",{attrs:{placeholder:"请输入",size:"small"},model:{value:t.search.value,callback:function(e){t.$set(t.search,"value",e)},expression:"search.value"}},[n("el-select",{staticStyle:{width:"90px"},attrs:{slot:"prepend",placeholder:"搜索类型",value:"",size:"small"},slot:"prepend",model:{value:t.search.type,callback:function(e){t.$set(t.search,"type",e)},expression:"search.type"}},[n("el-option",{attrs:{label:"ID",value:"id"}}),n("el-option",{attrs:{label:"卡号",value:"card"}})],1)],1)],1),n("el-form-item",{staticClass:"fix-height"},[n("el-button",{attrs:{size:"small"},on:{click:t.handleSearch}},[t._v("搜索")])],1),n("el-form-item",{staticClass:"fix-height mobile-full-width"},[t.onlyTrashed?t._e():n("el-switch",{attrs:{"inactive-text":"只显示可售","active-value":1,"inactive-value":0},on:{change:t.handleOnlyCanSell},model:{value:t.where.onlyCanSell,callback:function(e){t.$set(t.where,"onlyCanSell",e)},expression:"where.onlyCanSell"}}),"admin"===t._project?n("el-button",{staticStyle:{"margin-left":"12px","line-height":"20px"},attrs:{type:"text"},on:{click:t.toggleTrash}},[n("icon",{attrs:{name:t.onlyTrashed?"regular/undo":"light/trash-alt"}}),t._v("\n          "+t._s(t.onlyTrashed?"卡密列表":"回收站")+"\n        ")],1):t._e()],1),n("el-form-item",{staticClass:"right-toolbox"},[n("el-link",{on:{click:t.handleExport}},[n("icon",{attrs:{name:"light/file-alt"}}),t._v(" "+t._s("导出("+t.list.total+")"))],1),t.onlyTrashed?t._e():n("el-link",{on:{click:t.handleAdd}},[n("icon",{attrs:{name:"regular/plus"}}),t._v(" 添加")],1)],1)],1)],1),t.destroying?t._e():n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"list-table",attrs:{data:t.list.data,stripe:"",border:""},on:{"filter-change":t.handleFilterChange,"selection-change":function(e){return t.checkedIds=e.map(function(t){return t.id}).join(",")}}},[n("el-table-column",{attrs:{type:"selection",width:"40"}}),"admin"===t._project?n("el-table-column",{attrs:{prop:"id",label:"ID",width:"70"}}):t._e(),"admin"!==t._project||t.userInfo?t._e():n("el-table-column",{attrs:{prop:"user_id",label:"商户ID",width:"70"}}),n("el-table-column",{attrs:{prop:"card",label:"卡密","min-width":"180","show-overflow-tooltip":""}}),n("el-table-column",{attrs:{prop:"product",label:"所属商品","min-width":"120","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n        "+t._s(e.row.product?e.row.product.name:"未知商品#"+e.row.product_id)+"\n      ")]}}],null,!1,2044709608)}),n("el-table-column",{attrs:{prop:"type",label:"类型",width:"90","column-key":"type",filters:t.typeFilter,"filter-placement":"bottom"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-tag",{attrs:{type:(e.row.type,t.CARD_TYPE.TYPE_ONETIME,"info"),"close-transition":""}},[t._v("\n          "+t._s(e.row.type===t.CARD_TYPE.TYPE_ONETIME?"一次性":"重复卖")+"\n        ")])]}}],null,!1,3326270394)}),n("el-table-column",{attrs:{prop:"status",label:"售出状态",width:"90","column-key":"status",filters:t.statusFilter,"filtered-value":t.statusFilterValue,"filter-placement":"bottom"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.type===t.CARD_TYPE.TYPE_ONETIME?n("el-tag",{attrs:{type:e.row.status===t.CARD_STATUS.STATUS_SOLD?"info":"primary","close-transition":""}},[t._v("\n          "+t._s(e.row.status===t.CARD_STATUS.STATUS_SOLD?"已售":"未售")+"\n        ")]):n("el-tag",{attrs:{type:0<e.row.count_sold?"info":"primary","close-transition":""}},[t._v("\n          "+t._s(e.row.count_sold+"/"+e.row.count_all)+"\n        ")])]}}],null,!1,3110886131)}),t.onlyTrashed?t._e():n("el-table-column",{attrs:{prop:"created_at",label:"添加时间",width:"150"}}),t.onlyTrashed?n("el-table-column",{attrs:{prop:"deleted_at",label:"删除时间",width:"150"}}):t._e(),n("el-table-column",{attrs:{label:"操作",width:t.onlyTrashed?"120":"50",fixed:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[t.onlyTrashed?t._e():n("a",{staticClass:"icon-btn",staticStyle:{"font-size":"14px"},on:{click:function(n){return t.handleEdit(e.row)}}},[n("icon",{attrs:{name:"light/pencil"}})],1),t.onlyTrashed?t._e():n("a",{staticClass:"icon-btn",on:{click:function(n){return t.handleDelete(e.row)}}},[n("icon",{attrs:{name:"light/trash-alt"}})],1),t.onlyTrashed?n("a",{staticClass:"icon-btn",on:{click:function(n){return t.handleTrashDelete(e.row)}}},[n("icon",{attrs:{name:"light/trash-alt"}}),t._v("\n          销毁\n        ")],1):t._e(),t.onlyTrashed?n("a",{staticClass:"icon-btn",on:{click:function(n){return t.handleRestore(e.row)}}},[n("icon",{attrs:{name:"regular/undo"}}),t._v("\n          还原\n        ")],1):t._e()]}}],null,!1,1579001120)})],1),n("el-col",{staticClass:"list-after-action",staticStyle:{"padding-top":"8px","text-align":"left"},attrs:{span:24}},[n("el-form",{staticClass:"no-bottom-form"},[n("el-form-item",{attrs:{label:""}},[t.onlyTrashed?t._e():n("el-button",{attrs:{size:"small"},on:{click:t.checkDelete}},[t._v("选中删除")]),t.onlyTrashed?n("el-button",{attrs:{size:"small"},on:{click:t.checkTrashDelete}},[t._v("选中销毁")]):t._e(),t.onlyTrashed?n("el-button",{attrs:{size:"small"},on:{click:t.checkRestore}},[t._v("选中还原")]):t._e(),t.onlyTrashed?n("el-button",{attrs:{size:"small",type:"primary"},on:{click:t.handleRestoreAll}},[t._v("全部还原")]):t._e(),n("el-button",{attrs:{size:"small",type:"warning"},on:{click:t.handleDeleteAll}},[t._v("\n          "+t._s(t.onlyTrashed?"全部销毁":"全部删除")+"\n        ")])],1)],1)],1),n("el-col",{staticClass:"list-after-action",staticStyle:{"padding-top":"12px","text-align":"right"},attrs:{span:24}},[0<t.list.total?n("el-pagination",{staticClass:"pagination",attrs:{"page-size":20,"page-sizes":[10,20,30,40,50,100],total:t.list.total,"current-page":t.list.current_page,layout:"total, sizes, prev, pager, next, jumper"},on:{"update:currentPage":function(e){return t.$set(t.list,"current_page",e)},"update:current-page":function(e){return t.$set(t.list,"current_page",e)},"current-change":t.onChangePage,"size-change":t.onChangePageSize}}):t._e()],1),t.editInfo?n("card-edit",{attrs:{info:t.editInfo},on:{close:t.editCallback}}):t._e()],1)},Mt=[],zt=n("7413"),Ut=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-dialog",{attrs:{title:"编辑卡号",visible:t.visible,"close-on-click-modal":!1},on:{"update:visible":function(e){t.visible=e}}},[n("el-form",{ref:"form",attrs:{model:t.form,"label-width":"80px",rules:t.formRules}},[n("el-form-item",{attrs:{label:"卡号",prop:"card"}},[n("el-input",{attrs:{type:"text",placeholder:"请输入卡号"},model:{value:t.form.card,callback:function(e){t.$set(t.form,"card",e)},expression:"form.card"}})],1),n("el-form-item",{attrs:{label:"类型"}},[n("el-radio-group",{attrs:{size:"small"},model:{value:t.form.type,callback:function(e){t.$set(t.form,"type",e)},expression:"form.type"}},[n("el-radio-button",{attrs:{label:t.CARD_TYPE.TYPE_ONETIME}},[t._v("一次性")]),n("el-radio-button",{attrs:{label:t.CARD_TYPE.TYPE_REPEAT}},[t._v("重复销售")])],1),t.form.type===t.CARD_TYPE.TYPE_REPEAT?n("span",{staticClass:"red-text",staticStyle:{"font-size":"12px",display:"block","line-height":"18px"}},[t._v("注意：将会限制商品最大购买量为1件")]):t._e()],1),t.form.type===t.CARD_TYPE.TYPE_REPEAT?n("el-form-item",{attrs:{label:"可售",prop:"count_all",rules:[{required:!0,message:"请输入可售总次数",trigger:"blur"},{type:"number",min:t.form.count_sold,message:"可售总次数不能低于当前已售次数"},{type:"number",max:1e7,message:"可售总次数不能超过10000000"}]}},[n("el-input",{attrs:{type:"number",placeholder:"请输入可售总次数"},model:{value:t.form.count_all,callback:function(e){t.$set(t.form,"count_all",t._n(e))},expression:"form.count_all"}}),n("span",[t._v("当前已售出 "+t._s(t.form.count_sold)+"次")])],1):t._e()],1),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{nativeOn:{click:function(e){return t.handleClose(!1)}}},[t._v("取消")]),n("el-button",{attrs:{type:"primary",loading:t.loading},nativeOn:{click:function(e){return t.handleSubmit(e)}}},[t._v("确认编辑\n    ")])],1)],1)},Nt=[],Ft={props:{info:{}},data:function(){return{loading:!1,visible:!0,CARD_STATUS:zt.a,CARD_TYPE:zt.b,form:{id:0,product_id:0,card:"",type:zt.b.TYPE_ONETIME,count_all:null,count_sold:null},formRules:{card:[{required:!0,message:"请输入卡号",trigger:"blur"}]}}},watch:{visible:function(t){t||this.$emit("close",!1)}},mounted:function(){this.form.id=this.info.id,this.form.card=this.info.card,this.form.status=this.info.status,this.form.type=this.info.type,this.form.count_all=this.info.count_all,this.form.count_sold=this.info.count_sold},methods:{handleSubmit:function(){var t=this;this.$refs.form.validate(function(e){e&&(t.loading=!0,Object(zt.e)(t.form).then(function(){t.loading=!1,t.$notify({title:"提示",message:"编辑卡密成功",type:"success",duration:3e3}),t.handleClose(!0)}).catch(function(){t.loading=!1}))})},handleClose:function(){var t=0<arguments.length&&void 0!==arguments[0]&&arguments[0];this.visible=!1,this.$emit("close",t)}}},Bt=Object(b.a)(Ft,Ut,Nt,!1,null,null,null).exports,Vt={props:{userInfo:{type:Object,default:null},_trashed:{default:!1},_project:{default:"admin_free"},filter:{}},components:{cardEdit:Bt,cardAdd:Dt},data:function(){return{loading:!1,showAddBox:!1,addBoxLoaded:!1,destroying:!1,onlyTrashed:!1,CARD_TYPE:zt.b,CARD_STATUS:zt.a,search:{type:"card",value:""},where:{category_id:-1,product_id:-1,onlyCanSell:1},categories:[{id:-2,name:"加载中"}],products:[{id:-2,name:"加载中"}],list:{current_page:1,data:[],from:1,last_page:1,next_page_url:null,per_page:+localStorage.getItem("pageSize")||10,prev_page_url:null,to:0,total:0},checkedIds:"",statusFilter:[{text:"未售",value:zt.a.STATUS_NORMAL,type:"primary"},{text:"已售",value:zt.a.STATUS_SOLD,type:"info"}],statusFilterValue:[],typeFilter:[{text:"重复卖",value:zt.b.TYPE_REPEAT,type:"info"},{text:"一次性",value:zt.b.TYPE_ONETIME,type:"info"}],editInfo:null}},watch:{loading:function(t,e){t?e||J.a.isStarted()||J.a.start():J.a.done()}},created:function(){this.onlyTrashed=this._trashed},mounted:function(){var t,e,n;this.$route.query.category_id&&this.$route.query.product_id&&this.$route.query.type&&(t=this.$route.query.type,e=parseInt(this.$route.query.category_id),n=parseInt(this.$route.query.product_id)),this.filter&&this.filter.category_id&&this.filter.product_id&&this.filter.type&&(t=this.filter.type,e=parseInt(this.filter.category_id),n=parseInt(this.filter.product_id)),t&&e&&n?this.searchBy_(t,e,n):(this.handleSearch(),this.getCategories())},methods:{searchBy_:function(t,e,n){this.where.category_id=e,this.where.product_id=n,"count"===t?(this.where.onlyCanSell=1,this.statusFilterValue.splice(0,this.statusFilterValue.length),this.where.status=""):"count_sold"===t&&(this.where.onlyCanSell=0,this.statusFilterValue.push(zt.a.STATUS_SOLD),this.where.status=this.statusFilterValue.join(",")),this.handleSearch(),this.getCategories()},handleOnlyCanSell:function(){this.where.onlyCanSell&&(this.statusFilterValue.splice(0,this.statusFilterValue.length),this.where.status=""),this.handleSearch()},getCategories:function(){var t,e=this;this.loading=!0,t={search:"simple",val:"list"},this.userInfo&&(t.user_id=this.userInfo.id),Object(it.d)(t).then(function(t){e.categories=t.data,0<e.where.category_id&&0<e.where.product_id&&e.getProducts(e.where.category_id,e.where.product_id)})},getProducts:function(t){var e,n=this,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:-1;this.where.product_id=i,this.getList(),this.products=[],e={search:"simple",val:t,from:"card"},this.userInfo&&(e.user_id=this.userInfo.id),Object(gt.h)(e).then(function(t){n.products=t.data})},_generateWhere:function(){return this.where.current_page=this.list.current_page,this.where.per_page=this.list.per_page,this.where.trashed=this.onlyTrashed,this.userInfo&&(this.where.user_id=this.userInfo.id),this.where},getList:function(){var t=this;this.loading=!0,Object(zt.f)(this._generateWhere()).then(function(e){t.list=e.data,t.loading=!1})},handleSearch:function(){var t={search:this.search.type,val:this.search.value};Object.assign(this.where,t),this.getList()},handleExport:function(){window.open(window.API_HOST+"card/export?"+Object(vt.b)(this.where),"_blank")},handleFilterChange:function(t){var e={};t.status?e.status=t.status.join(","):e.status=null,t.type?e.type=t.type.join(","):e.type=null,Object.assign(this.where,e),this.getList()},onChangePage:function(){this.getList()},onChangePageSize:function(t){localStorage.setItem("pageSize",t),this.list.per_page=t,this.getList()},handleDelete:function(t){var e=this,n=t.card;this.$confirm("删除卡密"+n+"? 您可以稍后在回收站查看","提示",{type:"warning"}).then(function(){e.loading=!0,Object(zt.g)(t.id).then(function(){e.$notify({title:"操作完成",message:"卡密"+n+"已删除",type:"info"}),e.getList()}).catch(function(){e.loading=!1})})},handleTrashDelete:function(t){var e=this,n=t.card;this.$confirm("销毁卡密"+n+"? 此操作不可恢复","提示",{type:"warning"}).then(function(){e.loading=!0,Object(zt.h)(t.id).then(function(){e.$notify({title:"操作完成",message:"卡密"+n+"已销毁",type:"info"}),e.getList()}).catch(function(){e.loading=!1})})},handleRestore:function(t){var e=this,n=t.card;this.$confirm("还原卡密"+n+"? ","提示",{type:"warning"}).then(function(){e.loading=!0,Object(zt.i)(t.id).then(function(){e.$notify({title:"操作完成",message:"卡密"+n+"已还原",type:"success"}),e.getList()}).catch(function(){e.loading=!1})})},checkDelete:function(){var t=this;this.checkedIds.length&&this.$confirm("批量删除选中卡密? 您可以稍后在回收站查看","提示",{type:"warning"}).then(function(){t.loading=!0,Object(zt.g)(t.checkedIds).then(function(){t.$notify({title:"操作完成",message:"选中卡密已删除",type:"info"}),t.getList()}).catch(function(){t.loading=!1})})},checkTrashDelete:function(){var t=this;this.checkedIds.length&&this.$confirm("批量销毁选中卡密? 此操作不可恢复","提示",{type:"warning"}).then(function(){t.loading=!0,Object(zt.h)(t.checkedIds).then(function(){t.$notify({title:"操作完成",message:"选中卡密已销毁",type:"info"}),t.getList()}).catch(function(){t.loading=!1})})},checkRestore:function(){var t=this;this.checkedIds.length&&this.$confirm("批量还原选中卡密? ","提示",{type:"warning"}).then(function(){t.loading=!0,Object(zt.i)(t.checkedIds).then(function(){t.$notify({title:"操作完成",message:"选中卡密已还原",type:"success"}),t.getList()}).catch(function(){t.loading=!1})})},handleDeleteAll:function(){var t=this;this.$confirm("是否"+(this.onlyTrashed?"清空当前回收站":"删除当前卡密")+"列表?<br> (当前列表共"+this.list.total+"条)","警告",{type:"warning",dangerouslyUseHTMLString:!0}).then(function(){t.loading=!0,Object(zt.d)(t._generateWhere()).then(function(){t.$notify({title:"操作完成",message:t.onlyTrashed?"当前回收站列表已清空":"当前卡密列表已删除",type:"info"}),t.getList()}).catch(function(){t.loading=!1})})},handleRestoreAll:function(){var t=this;this.$confirm("是否还原当前回收站列表?<br> (当前列表共"+this.list.total+"条)","询问",{type:"warning",dangerouslyUseHTMLString:!0}).then(function(){t.loading=!0,Object(zt.j)(t._generateWhere()).then(function(){t.$notify({title:"操作完成",message:"当前回收站列表已还原",type:"success"}),t.getList()}).catch(function(){t.loading=!1})})},handleAdd:(ha=Object(nt.a)(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e={},0<+this.where.category_id&&(e.category_id=+this.where.category_id),0<+this.where.product_id&&(e.product_id=+this.where.product_id),t.next=7;break;case 7:this.$router.push({path:"/admin/product/card/add",query:e}),t.next=16;break;case 11:return window.scrollTo(0,0),this.addBoxLoaded=!0,t.next=15,this.$nextTick();case 15:this.showAddBox=!0;case 16:case"end":return t.stop()}},t,this)})),function(){return ha.apply(this,arguments)}),onAdd:function(){this.getList(),this.showAddBox=!1},handleEdit:function(t){this.editInfo=t},editCallback:function(t){this.editInfo=null,t&&this.getList()},toggleTrash:(pa=Object(nt.a)(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.onlyTrashed=!this.onlyTrashed,this.destroying=!0,t.next=4,this.$nextTick();case 4:this.destroying=!1,this.getList();case 6:case"end":return t.stop()}},t,this)})),function(){return pa.apply(this,arguments)})}},qt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("card-list",{attrs:{_trashed:!0}})},Ht=[],Wt={components:{cardList:Yt=Object(b.a)(Vt,Lt,Mt,!1,null,null,null).exports}},Qt=Object(b.a)(Wt,qt,Ht,!1,null,null,null).exports,Gt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{ref:"container",class:{"app-container":!t.userInfo}},[n("el-collapse-transition",[n("div",{directives:[{name:"show",rawName:"v-show",value:t.showAddBox,expression:"showAddBox"}],staticClass:"apply-box"},[n("el-button",{staticStyle:{float:"right",margin:"10px 15px"},attrs:{icon:"el-icon-close",type:"danger",size:"small"},on:{click:function(e){t.showAddBox=!1}}}),t.showAddBox||t.addBoxLoaded?n("el-card",{staticClass:"my-card"},[n("coupon-add",{attrs:{"in-box":!0,userInfo:t.userInfo},on:{submit:t.onAdd}})],1):t._e()],1)]),n("el-col",{staticClass:"no-bottom-form",attrs:{span:24}},[n("el-form",{staticClass:"list-pre-table",attrs:{inline:!0}},[n("el-form-item",{staticClass:"mobile-full-width"},[n("el-select",{staticClass:"mobile-full-width",attrs:{size:"small"},on:{change:t.getProducts},model:{value:t.where.category_id,callback:function(e){t.$set(t.where,"category_id",e)},expression:"where.category_id"}},[n("el-option",{attrs:{label:"全部",value:-1}}),t._l(t.categories,function(t){return n("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})],2),0<t.where.category_id?n("el-select",{staticClass:"mobile-full-width",attrs:{size:"small"},on:{change:t.getList},model:{value:t.where.product_id,callback:function(e){t.$set(t.where,"product_id",e)},expression:"where.product_id"}},[n("el-option",{attrs:{label:"全部",value:-1}}),t._l(t.products,function(t){return n("el-option",{key:t.id,attrs:{value:t.id,label:t.name}})})],2):t._e()],1),n("el-form-item",{staticClass:"mobile-full-width"},[n("el-input",{attrs:{placeholder:"请输入",size:"small"},model:{value:t.search.value,callback:function(e){t.$set(t.search,"value",e)},expression:"search.value"}},[n("el-select",{staticStyle:{width:"90px"},attrs:{slot:"prepend",placeholder:"搜索类型",value:"",size:"small"},slot:"prepend",model:{value:t.search.type,callback:function(e){t.$set(t.search,"type",e)},expression:"search.type"}},[n("el-option",{attrs:{label:"ID",value:"id"}}),n("el-option",{attrs:{label:"优惠券",value:"coupon"}}),n("el-option",{attrs:{label:"备注",value:"remark"}})],1)],1)],1),n("el-form-item",{staticClass:"fix-height"},[n("el-button",{attrs:{size:"small"},on:{click:t.handleSearch}},[t._v("搜索")])],1),n("el-form-item",{staticClass:"right-toolbox"},[n("el-link",{on:{click:t.handleAdd}},[n("icon",{attrs:{name:"regular/plus"}}),t._v(" 添加")],1)],1)],1)],1),n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"list-table",attrs:{data:t.list.data,stripe:"",border:""},on:{"filter-change":t.handleFilterChange,"selection-change":function(e){return t.checkedIds=e.map(function(t){return t.id}).join(",")}}},[n("el-table-column",{attrs:{type:"selection",width:"40"}}),"admin"===t._project?n("el-table-column",{attrs:{prop:"id",label:"ID",width:"70"}}):t._e(),"admin"!==t._project||t.userInfo?t._e():n("el-table-column",{attrs:{prop:"user_id",label:"商户ID",width:"70"}}),n("el-table-column",{attrs:{prop:"coupon",label:"优惠券","min-width":"180","show-overflow-tooltip":""}}),n("el-table-column",{attrs:{prop:"coupon",label:"优惠额",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n        "+t._s(e.row.discount_type===t.COUPON_DISCOUNT_TYPE.AMOUNT?"￥"+(e.row.discount_val/100).toFixed(2):e.row.discount_val+"%")+"\n      ")]}}])}),n("el-table-column",{attrs:{prop:"use_for",label:"适用商品","min-width":"180","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n        "+t._s(t.renderUseFor(e.row))+"\n      ")]}}])}),n("el-table-column",{attrs:{prop:"type",label:"类型",width:"90","column-key":"type",filters:t.typeFilter,"filter-placement":"bottom"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-tag",{attrs:{type:(e.row.type,t.COUPON_TYPE.TYPE_ONETIME,"info"),"close-transition":""}},[t._v("\n          "+t._s(e.row.type===t.COUPON_TYPE.TYPE_ONETIME?"一次性":"重复使用")+"\n        ")])]}}])}),n("el-table-column",{attrs:{prop:"status",label:"使用状态",width:"90","column-key":"status",filters:t.statusFilter,"filter-placement":"bottom"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.type===t.COUPON_TYPE.TYPE_ONETIME?n("el-tag",{attrs:{type:e.row.status===t.COUPON_STATUS.STATUS_USED?"info":"primary","close-transition":""}},[t._v("\n          "+t._s(e.row.status===t.COUPON_STATUS.STATUS_USED?"已用":"未用")+"\n        ")]):n("el-tag",{attrs:{type:0<e.row.count_used?"info":"primary","close-transition":""}},[t._v("\n          "+t._s(e.row.count_used+"/"+e.row.count_all)+"\n        ")])]}}])}),n("el-table-column",{attrs:{prop:"expire_at",label:"过期时间",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",{class:new Date(e.row.expire_at)<new Date?"amber-text":""},[t._v(t._s(e.row.expire_at))])]}}])}),n("el-table-column",{attrs:{label:"操作",width:"50",fixed:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("a",{staticClass:"icon-btn",staticStyle:{"font-size":"14px"},on:{click:function(n){return t.handleEdit(e.row)}}},[n("icon",{attrs:{name:"light/pencil"}})],1),n("a",{staticClass:"icon-btn",on:{click:function(n){return t.handleDelete(e.row)}}},[n("icon",{attrs:{name:"light/trash-alt"}})],1)]}}])})],1),n("el-col",{staticClass:"list-after-action",staticStyle:{"padding-top":"8px","text-align":"left"},attrs:{span:24}},[n("el-form",{staticClass:"no-bottom-form",attrs:{inline:!0}},[n("el-form-item",{attrs:{label:"选中"}},[n("el-button",{attrs:{size:"small"},on:{click:t.checkDelete}},[t._v("删除")])],1)],1)],1),n("el-col",{staticClass:"list-after-action",staticStyle:{"padding-top":"12px","text-align":"right"},attrs:{span:24}},[0<t.list.total?n("el-pagination",{staticClass:"pagination",attrs:{"page-size":20,"page-sizes":[10,20,30,40,50,100],total:t.list.total,"current-page":t.list.current_page,layout:"total, sizes, prev, pager, next, jumper"},on:{"update:currentPage":function(e){return t.$set(t.list,"current_page",e)},"update:current-page":function(e){return t.$set(t.list,"current_page",e)},"current-change":t.onChangePage,"size-change":t.onChangePageSize}}):t._e()],1),t.editInfo?n("coupon-edit",{attrs:{info:t.editInfo,categories:t.categories},on:{close:t.editCallback}}):t._e()],1)},Jt=[],Zt={STATUS_NORMAL:0,STATUS_USED:2},Xt={TYPE_ONETIME:0,TYPE_REPEAT:1},Kt={AMOUNT:0,PERCENT:1},te=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-dialog",{attrs:{title:"编辑卡号",visible:t.visible,"close-on-click-modal":!1},on:{"update:visible":function(e){t.visible=e}}},[n("el-form",{ref:"form",attrs:{model:t.form,"label-width":"80px",rules:t.formRules}},[n("el-form-item",{attrs:{label:"优惠券",prop:"coupon"}},[n("el-input",{attrs:{type:"text",placeholder:"请输入优惠券"},model:{value:t.form.coupon,callback:function(e){t.$set(t.form,"coupon",e)},expression:"form.coupon"}})],1),n("el-form-item",{attrs:{label:"商品",prop:"product_id"}},[n("el-select",{on:{change:t.getProducts},model:{value:t.form.category_id,callback:function(e){t.$set(t.form,"category_id",e)},expression:"form.category_id"}},[n("el-option",{attrs:{label:"全部",value:-1}}),t._l(t.categories,function(t){return n("el-option",{key:t.id,attrs:{value:t.id,label:t.name}})})],2),n("el-select",{model:{value:t.form.product_id,callback:function(e){t.$set(t.form,"product_id",e)},expression:"form.product_id"}},[n("el-option",{attrs:{label:"全部",value:-1}}),t._l(t.products,function(t){return n("el-option",{key:t.id,attrs:{value:t.id,label:t.name}})})],2)],1),n("el-form-item",{attrs:{label:"面额",prop:"discount_val"}},[n("el-input",{attrs:{type:"number",placeholder:"请输入优惠券面额"},model:{value:t.form.discount_val,callback:function(e){t.$set(t.form,"discount_val",t._n(e))},expression:"form.discount_val"}},[n("el-select",{staticStyle:{width:"70px"},attrs:{slot:"append",placeholder:"类型",value:"",size:"small"},on:{change:t.onDiscountTypeChange},slot:"append",model:{value:t.form.discount_type,callback:function(e){t.$set(t.form,"discount_type",e)},expression:"form.discount_type"}},[n("el-option",{attrs:{label:"￥",value:t.COUPON_DISCOUNT_TYPE.AMOUNT}}),n("el-option",{attrs:{label:"%",value:t.COUPON_DISCOUNT_TYPE.PERCENT}})],1)],1)],1),n("el-form-item",{attrs:{label:"类型"}},[n("el-radio-group",{attrs:{size:"small"},model:{value:t.form.type,callback:function(e){t.$set(t.form,"type",e)},expression:"form.type"}},[n("el-radio-button",{attrs:{label:t.COUPON_TYPE.TYPE_ONETIME}},[t._v("一次性")]),n("el-radio-button",{attrs:{label:t.COUPON_TYPE.TYPE_REPEAT}},[t._v("重复使用")])],1)],1),t.form.type===t.COUPON_TYPE.TYPE_REPEAT?n("el-form-item",{attrs:{label:"可用",prop:"count_all",rules:[{required:!0,message:"请输入可用次数",trigger:"blur"},{type:"number",min:1,max:1e7,message:"可用次数不能超过10000000"}]}},[n("el-input",{attrs:{type:"number",placeholder:"请输入可用次数"},model:{value:t.form.count_all,callback:function(e){t.$set(t.form,"count_all",t._n(e))},expression:"form.count_all"}}),n("span",[t._v("当前已使用 "+t._s(t.form.count_used)+"次")])],1):t._e(),n("el-form-item",{attrs:{label:"过期",prop:"expire_at"}},[n("el-date-picker",{attrs:{type:"datetime",placeholder:"选择过期时间"},model:{value:t.form.expire_at,callback:function(e){t.$set(t.form,"expire_at",e)},expression:"form.expire_at"}})],1)],1),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{nativeOn:{click:function(e){return t.handleClose(!1)}}},[t._v("取消")]),n("el-button",{attrs:{type:"primary",loading:t.loading},nativeOn:{click:function(e){return t.handleSubmit(e)}}},[t._v("确认编辑\n    ")])],1)],1)},ee=[],ne={props:{info:{},categories:{}},data:function(){return{loading:!1,visible:!0,COUPON_STATUS:Zt,COUPON_TYPE:Xt,COUPON_DISCOUNT_TYPE:Kt,products:[],form:{id:-1,category_id:-1,product_id:-1,coupon:"",type:Xt.TYPE_ONETIME,discount_val:"",discount_type:Kt.AMOUNT,count_all:null,count_used:null,expire_at:null},formRules:{coupon:[{required:!0,message:"请输入卡号",trigger:"blur"}],discount_val:[{required:!0,message:"请输入优惠券面额",trigger:"blur"}]}}},watch:{visible:function(t){t||this.$emit("close",!1)}},mounted:function(){this.form.id=this.info.id,this.form.category_id=this.info.category_id,this.form.product_id=this.info.product_id,this.form.coupon=this.info.coupon,this.form.status=this.info.status,this.form.discount_type=this.info.discount_type,this.info.discount_type===Kt.AMOUNT?this.form.discount_val=(this.info.discount_val/100).toFixed(2):this.form.discount_val=this.info.discount_val,this.form.type=this.info.type,this.form.count_all=this.info.count_all,this.form.count_used=this.info.count_used,this.form.expire_at=new Date(this.info.expire_at)},methods:{getProducts:function(t){var e,n=this;this.category_id_old!==t&&(this.category_id_old=t,this.products=[],e={search:"simple",val:t},this.userInfo&&(e.user_id=this.userInfo.id),Object(gt.h)(e).then(function(t){n.products=t.data}))},onDiscountTypeChange:function(){this.form.discount_type===Kt.AMOUNT?this.formRules.discount_val=[{required:!0,message:"请输入优惠券面额",trigger:"blur"},{type:"number",min:.01,max:1e7,message:"数字需要在0.01-10000000之间"}]:this.form.discount_type===Kt.PERCENT&&(this.formRules.discount_val=[{required:!0,message:"请输入优惠百分比",trigger:"blur"},{type:"number",min:1,max:100,message:"数字需要在1-100之间"}])},handleSubmit:function(){var t=this;this.$refs.form.validate(function(e){if(e){t.loading=!0;var n,i=Object.assign({},t.form);i.discount_type===Kt.AMOUNT&&(i.discount_val*=100),i.expire_at&&(i.expire_at=i.expire_at.format("yyyy-MM-dd")),(n=i,Object(Z.a)({url:"coupon/edit",method:"post",data:n})).then(function(){t.loading=!1,t.$notify({title:"提示",message:"编辑优惠券成功",type:"success",duration:3e3}),t.handleClose(!0)}).catch(function(){t.loading=!1})}})},handleClose:function(){var t=0<arguments.length&&void 0!==arguments[0]&&arguments[0];this.visible=!1,this.$emit("close",t)}}},ie=Object(b.a)(ne,te,ee,!1,null,null,null).exports,ae=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{class:{"app-container":!t.inBox}},[n("h3",{staticStyle:{margin:"4px 0 28px 0"}},[t._v("生成优惠券")]),n("el-form",{ref:"form",attrs:{model:t.form,"label-position":t.isMobile?"top":"","label-width":"90px",rules:t.formRules}},[n("el-form-item",{class:t.formItemClass,style:t.isMobile?"margin-top: -24px":"",attrs:{label:"类型"}},[n("el-radio-group",{attrs:{size:"small"},on:{change:t.onTypeChange},model:{value:t.form.type,callback:function(e){t.$set(t.form,"type",e)},expression:"form.type"}},[n("el-radio-button",{attrs:{label:t.COUPON_TYPE.TYPE_ONETIME}},[t._v("一次性")]),n("el-radio-button",{attrs:{label:t.COUPON_TYPE.TYPE_REPEAT}},[t._v("重复使用")])],1)],1),n("el-form-item",{class:t.formItemClass,attrs:{label:"商品",prop:"product_id"}},[n("el-select",{on:{change:t.getProducts},model:{value:t.form.category_id,callback:function(e){t.$set(t.form,"category_id",e)},expression:"form.category_id"}},[n("el-option",{attrs:{label:"全部",value:-1}}),t._l(t.categories,function(t){return n("el-option",{key:t.id,attrs:{value:t.id,label:t.name}})})],2),n("el-select",{model:{value:t.form.product_id,callback:function(e){t.$set(t.form,"product_id",e)},expression:"form.product_id"}},[n("el-option",{attrs:{label:"全部",value:-1}}),t._l(t.products,function(t){return n("el-option",{key:t.id,attrs:{value:t.id,label:t.name}})})],2)],1),n("el-form-item",{class:t.formItemClass,attrs:{label:"面额",prop:"discount_val"}},[n("el-input",{attrs:{type:"number",placeholder:"请输入优惠券面额"},model:{value:t.form.discount_val,callback:function(e){t.$set(t.form,"discount_val",t._n(e))},expression:"form.discount_val"}},[n("el-select",{staticStyle:{width:"70px"},attrs:{slot:"append",placeholder:"类型",value:"",size:"small"},on:{change:t.onDiscountTypeChange},slot:"append",model:{value:t.form.discount_type,callback:function(e){t.$set(t.form,"discount_type",e)},expression:"form.discount_type"}},[n("el-option",{attrs:{label:"￥",value:t.COUPON_DISCOUNT_TYPE.AMOUNT}}),n("el-option",{attrs:{label:"%",value:t.COUPON_DISCOUNT_TYPE.PERCENT}})],1)],1),n("div",{staticClass:"el-form-item__tip"},[n("span",[t._v("* 请合理设置优惠金额, 以避免产生亏损")])])],1),t.form.type===t.COUPON_TYPE.TYPE_REPEAT?n("el-form-item",{class:t.formItemClass,attrs:{label:"可用次数",prop:"count_all",rules:[{required:!0,message:"请输入可用次数",trigger:"blur"},{type:"number",min:1,max:1e7,message:"可用次数不能超过10000000"}]}},[n("el-input",{attrs:{type:"number",placeholder:"请输入可用次数"},model:{value:t.form.count_all,callback:function(e){t.$set(t.form,"count_all",t._n(e))},expression:"form.count_all"}})],1):t._e(),t.form.type===t.COUPON_TYPE.TYPE_ONETIME?n("el-form-item",{class:t.formItemClass,attrs:{label:"生成数量",prop:"count",rules:[{required:!0,message:"请输入生成数量",trigger:"blur"},{type:"number",min:1,max:100,message:"每次生成不能大于100张"}]}},[n("el-input",{attrs:{type:"number",placeholder:"请输入生成数量"},model:{value:t.form.count,callback:function(e){t.$set(t.form,"count",t._n(e))},expression:"form.count"}})],1):t._e(),t.form.type===t.COUPON_TYPE.TYPE_REPEAT?n("el-form-item",{class:t.formItemClass,attrs:{label:"券代码",prop:"coupon"}},[n("el-input",{attrs:{type:"text",placeholder:"为空系统自动生成"},model:{value:t.form.coupon,callback:function(e){t.$set(t.form,"coupon",e)},expression:"form.coupon"}})],1):t._e(),n("el-form-item",{class:t.formItemClass,attrs:{label:"过期时间",prop:"expire_at"}},[n("el-date-picker",{attrs:{type:"datetime",placeholder:"选择过期时间"},model:{value:t.form.expire_at,callback:function(e){t.$set(t.form,"expire_at",e)},expression:"form.expire_at"}})],1),n("el-form-item",[n("el-button",{attrs:{type:"primary",loading:t.loading},on:{click:t.onSubmit}},[t._v("添加")])],1)],1),t.list.length?n("div",{staticStyle:{"font-size":"14px",color:"#606266","line-height":"16px","margin-top":"24px"},style:{"margin-left":t.isMobile?0:"90px"}},[n("span",[t._v("生成优惠券 "+t._s(t.list.length)+"张")]),n("el-button",{directives:[{name:"clipboard",rawName:"v-clipboard",value:t.list.join("\r\n"),expression:"list.join('\\r\\n')"}],ref:"copy-coupons",staticStyle:{display:"inline-block","margin-left":"12px"},attrs:{size:"mini"},on:{success:function(e){return t.$message({message:"复制成功",type:"success",duration:1e3})},error:function(e){return t.$message({message:"复制失败, 请手动复制",type:"error",duration:1e3})}}},[t._v("\n      一键复制\n    ")]),n("p",{domProps:{innerHTML:t._s(t.list.join("<br>"))}})],1):t._e()],1)},oe=[],re=n("70da"),se=n.n(re),le={props:{inBox:{default:!1},userInfo:{}},data:function(){var t=new Date;return t.setTime(6048e5+t.getTime()),{loading:!1,isMobile:this.$store.state.app.isMobile,COUPON_TYPE:Xt,COUPON_DISCOUNT_TYPE:Kt,categories:[],products:[],form:{category_id:-1,product_id:-1,type:Xt.TYPE_ONETIME,coupon:null,discount_val:"",discount_type:Kt.AMOUNT,count:null,expire_at:t},formRules:{discount_val:[{required:!0,message:"请输入优惠券面额",trigger:"blur"},{type:"number",min:.01,max:1e6,message:"数字需要在0.01-1000000之间"}]},list:[]}},computed:{formItemClass:function(){return this.isMobile?"coupon-form-item":""}},watch:{loading:function(t,e){t?e||J.a.isStarted()||J.a.start():J.a.done()}},mounted:function(){this.getCategories(),this.userInfo&&(this.form.user_id=this.userInfo.id)},methods:{getCategories:function(){var t,e=this;this.categories=[],t={search:"simple",val:"list"},this.userInfo&&(t.user_id=this.userInfo.id),Object(it.d)(t).then(function(t){e.categories=t.data})},getProducts:function(t){var e,n=this;this.category_id_old!==t&&(this.category_id_old=t,this.products=[],e={search:"simple",val:t},this.userInfo&&(e.user_id=this.userInfo.id),Object(gt.h)(e).then(function(t){n.products=t.data}))},onTypeChange:function(){},onDiscountTypeChange:function(){this.form.discount_type===Kt.AMOUNT?this.formRules.discount_val=[{required:!0,message:"请输入优惠券面额",trigger:"blur"},{type:"number",min:.01,max:1e7,message:"数字需要在0.01-10000000之间"}]:this.form.discount_type===Kt.PERCENT&&(this.formRules.discount_val=[{required:!0,message:"请输入优惠百分比",trigger:"blur"},{type:"number",min:1,max:100,message:"数字需要在1-100之间"}])},onSubmit:function(){var t=this;this.$refs.form.validate(function(e){if(e){t.list=[],t.loading=!0;var n,i=Object.assign({},t.form);i.discount_type===Kt.AMOUNT&&(i.discount_val*=100),i.expire_at&&(i.expire_at=i.expire_at.format("yyyy-MM-dd")),(n=i,Object(Z.a)({url:"coupon/create",method:"post",data:n})).then(function(e){t.loading=!1,t.list=e.data;var n=t.list.join("\r\n");t.$msgbox({title:"生成优惠券成功",message:'优惠券列表：<br><textarea title="优惠券列表" rows="6" style="width: 100%" readonly>'+Object(vt.a)(n)+"</textarea>",showCancelButton:!0,dangerouslyUseHTMLString:!0,cancelButtonText:"一键复制"}).catch(function(e){"cancel"===e&&se()(t.$refs["copy-coupons"].$el).click()}),t.$emit("submit",!0)}).catch(function(){t.loading=!1})}})}}},n("ad2b"),ce=Object(b.a)(le,ae,oe,!1,null,null,null).exports,de={props:{userInfo:{type:Object,default:null},onlyTrashed:{default:!1},_project:{default:"admin_free"}},components:{couponEdit:ie,couponAdd:ce},data:function(){return{loading:!1,exporting:!1,showAddBox:!1,addBoxLoaded:!1,COUPON_TYPE:Xt,COUPON_STATUS:Zt,COUPON_DISCOUNT_TYPE:Kt,search:{type:"coupon",value:""},where:{category_id:-1,product_id:-1},categories:[{id:-2,name:"加载中"}],products:[{id:-2,name:"加载中"}],list:{current_page:1,data:[],from:1,last_page:1,next_page_url:null,per_page:+localStorage.getItem("pageSize")||10,prev_page_url:null,to:0,total:0},checkedIds:"",statusFilter:[{text:"未用",value:Zt.STATUS_NORMAL,type:"primary"},{text:"已用",value:Zt.STATUS_USED,type:"info"}],typeFilter:[{text:"重复使用",value:Xt.TYPE_REPEAT,type:"info"},{text:"一次性",value:Xt.TYPE_ONETIME,type:"info"}],editInfo:null}},watch:{loading:function(t,e){t?e||J.a.isStarted()||J.a.start():J.a.done()}},mounted:function(){this.getCategories()},methods:{getCategories:function(){var t,e=this;this.loading=!0,t={search:"simple",val:"list"},this.userInfo&&(t.user_id=this.userInfo.id),Object(it.d)(t).then(function(t){e.categories=t.data,e.getList()})},getProducts:function(t){var e,n=this;this.where.product_id=-1,this.getList(),this.products=[],e={search:"simple",val:t},this.userInfo&&(e.user_id=this.userInfo.id),Object(gt.h)(e).then(function(t){n.products=t.data})},getList:function(){var t,e=this;this.loading=!0,this.where.current_page=this.list.current_page,this.where.per_page=this.list.per_page,this.where.trashed=this.onlyTrashed,this.userInfo&&(this.where.user_id=this.userInfo.id),(t=this.where,Object(Z.a)({url:"coupon",method:"post",data:t})).then(function(t){e.list=t.data,e.loading=!1})},handleSearch:function(){var t={search:this.search.type,val:this.search.value};Object.assign(this.where,t),this.getList()},handleFilterChange:function(t){var e={};t.status?e.status=t.status.join(","):e.status=null,t.type?e.type=t.type.join(","):e.type=null,Object.assign(this.where,e),this.getList()},onChangePage:function(){this.getList()},onChangePageSize:function(t){localStorage.setItem("pageSize",t),this.list.per_page=t,this.getList()},renderUseFor:function(t){return 0<t.product_id?t.product&&t.product.name?"商品："+t.product.name:"商品：#"+t.product_id:0<t.category_id?t.category&&t.category.name?"分类："+t.category.name:"分类：#"+t.category_id:"店铺通用(商品有规定除外)"},handleDisable:function(t){var e=this,n=t.coupon;this.$confirm("禁用优惠券<"+n+">?","提示",{type:"warning"}).then(function(){e.loading=!0,i(t.id,0).then(function(){e.$notify({title:"操作成功",message:"优惠券<"+n+">已禁用",type:"info"}),t.enabled=0,e.loading=!1}).catch(function(){e.loading=!1})})},handleEnable:function(t){var e=this,n=t.coupon;this.$confirm("启用优惠券<"+n+">?","提示",{type:"warning"}).then(function(){e.loading=!0,i(t.id,1).then(function(){e.$notify({title:"操作成功",message:"优惠券<"+n+">已启用",type:"success"}),t.enabled=1,e.loading=!1}).catch(function(){e.loading=!1})})},handleDelete:function(t){var e=this,n=t.coupon;this.$confirm("删除优惠券"+n+"? 您可以稍后在回收站查看","提示",{type:"warning"}).then(function(){e.loading=!0,a(t.id).then(function(){e.$notify({title:"操作成功",message:"优惠券"+n+"已删除",type:"info"}),e.getList()}).catch(function(){e.loading=!1})})},checkDelete:function(){var t=this;this.checkedIds.length&&this.$confirm("批量删除选中优惠券? 您可以稍后在回收站查看","提示",{type:"warning"}).then(function(){t.loading=!0,a(t.checkedIds).then(function(){t.$notify({title:"操作成功",message:"选中优惠券已删除",type:"info"}),t.getList()}).catch(function(){t.loading=!1})})},handleAdd:(ma=Object(nt.a)(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:t.next=4;break;case 4:this.$router.push("/admin/coupon/add"),t.next=13;break;case 8:return window.scrollTo(0,0),this.addBoxLoaded=!0,t.next=12,this.$nextTick();case 12:this.showAddBox=!0;case 13:case"end":return t.stop()}},t,this)})),function(){return ma.apply(this,arguments)}),onAdd:function(){this.getList()},handleEdit:function(t){this.editInfo=t},editCallback:function(t){this.editInfo=null,t&&this.getList()}}},ue=Object(b.a)(de,Gt,Jt,!1,null,null,null).exports,fe=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{ref:"container",class:{"app-container":!t.userInfo}},[n("el-col",{staticClass:"no-bottom-form",attrs:{span:24}},[n("el-form",{staticClass:"list-pre-table",attrs:{inline:!0}},[t.onlyProfit?t._e():n("el-form-item",{staticClass:"mobile-full-width"},[n("el-select",{staticClass:"mobile-full-width",attrs:{size:"small","popper-class":"el-select-group-less-padding","no-data-text":"无分类数据"},on:{change:t.changeCategory},model:{value:t.where.category_id,callback:function(e){t.$set(t.where,"category_id",e)},expression:"where.category_id"}},["admin_free"!==t._project?n("el-option-group",{attrs:{label:"API订单"}},[n("el-option",{attrs:{label:"所有订单(API)",value:t.API_ORDER_ID}})],1):t._e(),n("el-option-group",{attrs:{label:"卡密订单"}},[n("el-option",{attrs:{label:"所有订单",value:-1}}),t._l(t.categories,function(t){return n("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})],2)],1),0<t.where.category_id?n("el-select",{staticClass:"mobile-full-width",attrs:{size:"small"},on:{change:t.getList},model:{value:t.where.product_id,callback:function(e){t.$set(t.where,"product_id",e)},expression:"where.product_id"}},[n("el-option",{attrs:{label:"全部",value:-1}}),t._l(t.products,function(t){return n("el-option",{key:t.id,attrs:{value:t.id,label:t.name}})})],2):t._e()],1),n("el-form-item",{staticClass:"mobile-full-width"},[n("el-input",{attrs:{placeholder:"请输入",size:"small"},model:{value:t.search.value,callback:function(e){t.$set(t.search,"value",e)},expression:"search.value"}},[n("el-select",{staticStyle:{width:"90px"},attrs:{slot:"prepend",placeholder:"搜索类型",value:"",size:"small"},slot:"prepend",model:{value:t.search.type,callback:function(e){t.$set(t.search,"type",e)},expression:"search.type"}},[n("el-option",{attrs:{label:"订单号",value:"order_no"}}),n("el-option",{attrs:{label:"支付渠道单号",value:"pay_trade_no"}}),t.isApiOrder?n("el-option",{attrs:{label:"商户订单号(API)",value:"api_out_no"}}):t._e(),t.isApiOrder?n("el-option",{attrs:{label:"附加信息(API)",value:"api_info"}}):t._e(),"admin"===t._project?n("el-option",{attrs:{label:"商户ID",value:"user_id"}}):t._e(),t.isApiOrder||t.onlyProfit?t._e():n("el-option",{attrs:{label:"买家联系方式",value:"contact"}})],1)],1)],1),t.recentDay?t._e():n("el-form-item",{staticClass:"mobile-full-width"},[n("el-date-picker",{attrs:{size:"small",type:"daterange",align:"right",placeholder:"日期范围","picker-options":t.pickerOptions},model:{value:t.date_range,callback:function(e){t.date_range=e},expression:"date_range"}})],1),n("el-form-item",[n("el-button",{attrs:{size:"small"},on:{click:t.handleSearch}},[t._v("搜索")])],1),n("div",{staticClass:"mobile-full-width"}),t.onlyProfit?t._e():n("el-form-item",{staticClass:"fix-height"},[n("el-switch",{attrs:{"inactive-text":"未支付订单","active-value":1,"inactive-value":0},on:{change:t.handleShowUnPay},model:{value:t.where.showUnPay,callback:function(e){t.$set(t.where,"showUnPay",e)},expression:"where.showUnPay"}})],1),t.onlyProfit||t.isApiOrder?t._e():n("el-form-item",{staticClass:"fix-height"},[n("el-switch",{attrs:{"inactive-text":"待发货订单","active-value":1,"inactive-value":0},on:{change:t.handleShowUnSend},model:{value:t.where.showUnSend,callback:function(e){t.$set(t.where,"showUnSend",e)},expression:"where.showUnSend"}})],1),n("el-form-item",{staticClass:"right-toolbox"},[n("el-link",{on:{click:function(e){return t.handleExport()}}},[n("icon",{attrs:{name:"light/file-alt"}}),t._v(" "+t._s("导出("+t.list.total+")"))],1)],1)],1)],1),t.onlyProfit?n("el-col",{staticClass:"list-after-action",attrs:{span:24}},[n("el-card",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"my-card",staticStyle:{"box-shadow":"none"}},[n("div",{staticStyle:{"font-size":"14px"}},[t._v("\n        总收入: "+t._s(t._f("moneyFormatterFilter")(t._f("moneyFilter")(parseInt(t.list.profit_sum.income))))+"，\n        总利润： "+t._s(t._f("moneyFormatterFilter")(t._f("moneyFilter")(parseInt(t.list.profit_sum.profit))))+"\n      ")])])],1):t._e(),t.destroyForLoad?t._e():n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"list-table",attrs:{data:t.list.data,stripe:"",border:""},on:{"filter-change":t.onFilterChange,"selection-change":function(e){return t.checkedVal=e}}},["admin"===t._project?n("el-table-column",{attrs:{type:"selection",width:"40"}}):t._e(),"admin"!==t._project||t.userInfo?t._e():n("el-table-column",{attrs:{prop:"user_id",label:"商户ID",width:"70"}}),n("el-table-column",{attrs:{prop:"order_no",label:"订单号(点击查看)",width:"170"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("a",{staticClass:"line-btn",on:{click:function(n){return t.showOrder(e.row)}}},[t._v(t._s(e.row.order_no))])]}}],null,!1,1266714438)}),t.onlyProfit?t._e():n("el-table-column",{attrs:{prop:"status",label:"状态",width:"80","column-key":"status",filters:t.statusFilter,"filtered-value":t.statusFilterValue,"filter-placement":"bottom"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-tag",{attrs:{type:t.ORDER_STATUS.get(e.row.status).type}},[t._v("\n          "+t._s(t.ORDER_STATUS.get(e.row.status).name)+"\n        ")])]}}],null,!1,2372855863)}),!t.onlyProfit&&t.PRODUCT_MANUAL?n("el-table-column",{attrs:{prop:"status",label:"发货状态",width:"100","column-key":"status","filter-placement":"bottom"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.send_status===t.SEND_STATUS.CARD_UN.id||e.row.send_status===t.SEND_STATUS.CARD_PROCESSING.id||e.row.send_status===t.SEND_STATUS.CARD_FAILED.id?n("el-select",{staticClass:"send_status-select",attrs:{value:e.row.send_status,size:"mini"},on:{change:function(n){return t.handleSetSendStatus(e.row,n)}}},[n("el-option",{attrs:{label:"待发货",value:t.SEND_STATUS.CARD_UN.id}}),n("el-option",{attrs:{label:"正在处理",value:t.SEND_STATUS.CARD_PROCESSING.id}}),n("el-option",{attrs:{label:"处理失败",value:t.SEND_STATUS.CARD_FAILED.id}}),n("el-option",{attrs:{label:"已发货",value:t.SEND_STATUS.CARD_SUCCESS.id}})],1):n("span",[t._v("\n          "+t._s(t.SEND_STATUS.get(e.row.send_status).name)+"\n        ")])]}}],null,!1,718381495)}):t._e(),t.isApiOrder?n("el-table-column",{attrs:{prop:"api_out_no",label:"通知",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("a",{staticClass:"line-btn",on:{click:function(n){return t.showOrder(e.row)}}},[n("el-tag",{attrs:{type:e.row.api_info&&"success"===e.row.api_info.notify_ret?"success":"warning","close-transition":""}},[t._v("\n            "+t._s(e.row.api_info&&e.row.api_info.notify_ret||"未通知")+"\n          ")])],1)]}}],null,!1,2372748283)}):t._e(),n("el-table-column",{attrs:{prop:"paid_at",label:"支付时间",width:"160"}}),t.isApiOrder?n("el-table-column",{attrs:{prop:"api_out_no",label:"商户订单号",width:"170","show-overflow-tooltip":""}}):t._e(),t.isApiOrder?n("el-table-column",{attrs:{prop:"api_info.subject",label:"商品名称",width:"120","show-overflow-tooltip":""}}):t._e(),t.isApiOrder||t.onlyProfit?t._e():n("el-table-column",{attrs:{prop:"product",label:"商品名称","min-width":"150","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",{staticClass:"red-text"},[t._v(t._s(e.row.count))]),n("span",[t._v(" x ")]),e.row.product&&e.row.product_name&&e.row.product_name!==e.row.product.name?n("el-tooltip",{attrs:{effect:"dark",content:"当前商品名称:"+e.row.product.name,placement:"bottom-start"}},[n("span",{staticClass:"orange-text"},[t._v(t._s(e.row.product_name))])]):n("span",[t._v(t._s(e.row.product_name||(e.row.product?e.row.product.name:"未知#"+e.row.product_id)))])]}}],null,!1,3923757478)}),t.isApiOrder||t.onlyProfit?t._e():n("el-table-column",{attrs:{prop:"card",label:"卡密",width:"60"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("a",{staticClass:"line-btn",staticStyle:{color:"#409eff"},on:{click:function(n){return t.showCards(e.row)}}},[t._v("\n          "+t._s(e.row.card_orders&&e.row.card_orders.length?e.row.card_orders.length+"张":"无")+"\n        ")])]}}],null,!1,3522189028)}),n("el-table-column",{attrs:{prop:"pay",label:"支付方式","min-width":"80","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n        "+t._s(e.row.pay?e.row.pay.name:e.row.pay_id===t.ID_INNER_RETAIL?"代理进货":"未知#"+e.row.pay_id)+"\n      ")]}}],null,!1,572791778)}),t.onlyProfit?n("el-table-column",{attrs:{prop:"cost",label:"成本",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n        "+t._s(t._f("moneyFilter")(e.row.cost))+"\n      ")]}}],null,!1,117871487)}):t._e(),t.onlyProfit&&!t.isApiOrder?n("el-table-column",{attrs:{prop:"paid",label:"售价",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n        "+t._s(t._f("moneyFilter")(e.row.paid))+"\n      ")]}}],null,!1,264046024)}):t._e(),t.onlyProfit?t._e():n("el-table-column",{attrs:{prop:"price",label:"金额",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[0<e.row.discount||0<e.row.sms_price?n("el-tooltip",{attrs:{effect:"dark",placement:"top-start",content:"商品总价："+(e.row.price/100).toFixed(2)+(e.row.discount?" - 优惠金额："+(e.row.discount/100).toFixed(2):"")+(e.row.sms_price?" + 短信费用："+(e.row.sms_price/100).toFixed(2):"")}},[n("span",[t._v(t._s(t._f("moneyFilter")(e.row.paid)))])]):n("span",[t._v("\n             "+t._s(t._f("moneyFilter")(e.row.paid))+"\n        ")])]}}],null,!1,3489005070)}),"merchant"===t._project||t.userInfo?n("el-table-column",{attrs:{prop:"income",label:"入账",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-tooltip",{attrs:{effect:"dark",placement:"top-start",content:"手续费: "+(e.row.fee/100).toFixed(2)}},[n("span",[t._v(t._s(t._f("moneyFilter")(e.row.income)))])])]}}],null,!1,3409110604)}):t._e(),"admin"===t._project?n("el-table-column",{attrs:{prop:"fee-system_fee",label:"平台利润",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-tooltip",{attrs:{effect:"dark",placement:"top-start",content:"通道手续费: "+(e.row.system_fee/100).toFixed(2)}},[n("span",[t._v(t._s(t._f("moneyFilter")(e.row.fee-e.row.system_fee)))])])]}}],null,!1,3121495338)}):t._e(),t.onlyProfit?n("el-table-column",{attrs:{prop:"profit",label:"利润",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n        "+t._s(t._f("moneyFilter")(e.row.paid-e.row.sms_price-e.row.cost-e.row.fee))+"\n      ")]}}],null,!1,3140978710)}):t._e(),t.onlyProfit||t.isApiOrder?t._e():n("el-table-column",{attrs:{prop:"contact",label:"买家联系方式","min-width":"160","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",[t._v(t._s(e.row.contact))])]}}],null,!1,4205396614)}),!t.onlyProfit&&t.isApiOrder?n("el-table-column",{attrs:{prop:"api_info.attach",label:"附加","min-width":"160","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[n("a",{staticClass:"line-btn"},[t._v("\n          "+t._s(e.row.api_info&&e.row.api_info.attach||"无")+"\n        ")])]}}],null,!1,200876631)}):t._e(),t.onlyProfit?t._e():n("el-table-column",{attrs:{prop:"remark",label:"备注","min-width":"50","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[n("a",{staticClass:"line-btn",on:{click:function(n){return t.showRemark(e.row)}}},[t._v(t._s(e.row.remark||"添加"))])]}}],null,!1,1131591075)}),n("el-table-column",{attrs:{label:"操作",width:"admin"===t._project||"admin_free"===t._project?"80":"50",fixed:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("a",{staticClass:"icon-btn",staticStyle:{"font-size":"14px"},on:{click:function(n){return t.showOrder(e.row)}}},[t._v("\n          查看\n        ")]),"admin"===t._project&&e.row.status===t.ORDER_STATUS.SUCCESS.id?n("a",{staticClass:"icon-btn",staticStyle:{"font-size":"14px"},style:{color:e.row.pay_id===t.ID_INNER_RETAIL?"gray":""},on:{click:function(n){return t.handleFreeze(e.row)}}},[t._v("\n          冻结\n        ")]):t._e(),"admin"===t._project&&e.row.status===t.ORDER_STATUS.FROZEN.id?n("a",{staticClass:"icon-btn",staticStyle:{"font-size":"14px"},style:{color:e.row.pay_id===t.ID_INNER_RETAIL?"gray":""},on:{click:function(n){return t.handleUnfreeze(e.row)}}},[t._v("\n          解冻\n        ")]):t._e(),"admin"!==t._project&&"admin_free"!==t._project||e.row.status!==t.ORDER_STATUS.UN_PAY.id?t._e():n("a",{staticClass:"icon-btn",staticStyle:{"font-size":"14px"},style:{color:e.row.pay_id===t.ID_INNER_RETAIL?"gray":""},on:{click:function(n){return t.handleSetPaid(e.row)}}},[t._v("\n          补单\n        ")]),e.row.status===t.ORDER_STATUS.PAID.id?n("a",{staticClass:"icon-btn",staticStyle:{"font-size":"14px"},on:{click:function(n){return t.handleSendCard(e.row)}}},[t._v("\n          发货\n        ")]):t._e()]}}],null,!1,1369816945)})],1),"admin"===t._project?n("el-col",{staticClass:"list-after-action",staticStyle:{"padding-top":"8px","text-align":"left"},attrs:{span:24}},[n("el-form",{staticClass:"no-bottom-form",attrs:{inline:!0}},[n("el-form-item",{attrs:{label:"选中"}},[n("el-button",{attrs:{size:"small"},on:{click:t.checkFreeze}},[t._v("冻结")]),n("el-button",{attrs:{size:"small"},on:{click:t.checkUnfreeze}},[t._v("解冻")]),n("el-button",{attrs:{size:"small"},on:{click:t.checkRefund}},[t._v("退款")])],1)],1)],1):t._e(),n("el-col",{staticClass:"list-after-action",staticStyle:{"padding-top":"12px","text-align":"right"},attrs:{span:24}},[0<t.list.total?n("el-pagination",{staticClass:"pagination",attrs:{"page-size":20,"page-sizes":[10,20,30,40,50,100],total:t.list.total,"current-page":t.list.current_page,layout:"total, sizes, prev, pager, next, jumper"},on:{"update:currentPage":function(e){return t.$set(t.list,"current_page",e)},"update:current-page":function(e){return t.$set(t.list,"current_page",e)},"current-change":t.onChangePage,"size-change":t.onChangePageSize}}):t._e()],1),t.orderInfo?n("order-info",{ref:"orderInfo",attrs:{from:"order",info:t.orderInfo},on:{close:function(e){t.orderInfo=null}}}):t._e(),t.PRODUCT_MANUAL&&t.exportDialogVisible?n("export-dialog",{on:{close:function(e){t.exportDialogVisible=!1},export:t.handleExport}}):t._e()],1)},pe=[],he=n("1045"),me=n("26fe"),_e=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-dialog",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"order-info-container",attrs:{title:t.title,visible:t.orderVisible,"close-on-click-modal":!0},on:{"update:visible":function(e){t.orderVisible=e}}},[t.orderInfo?n("div",{staticClass:"order-info-table"},["admin"===t._project&&(t.orderInfo.pay_id===t.ID_INNER_RETAIL||t.orderInfo.product&&t.orderInfo.product.retail_from_id&&!t.orderInfo.retail_chain)?n("el-button",{directives:[{name:"loading",rawName:"v-loading",value:t.loadingRetail,expression:"loadingRetail"}],staticClass:"icon-btn",staticStyle:{float:"right",margin:"-6px 0 0"},attrs:{type:"text",disabled:t.loadingRetail},on:{click:t.getRetailChain}},[t._v("加载分销订单\n    ")]):t._e(),t.orderInfo.retail_chain&&t.orderInfo.retail_chain.length?n("el-collapse",{ref:"orderChain",model:{value:t.showOrders,callback:function(e){t.showOrders=e},expression:"showOrders"}},[t._l(t.orderInfo.retail_chain,function(e,i){return n("el-collapse-item",{key:e.order_no,attrs:{title:0===i?"供货订单":"分销订单",name:e.id}},[n("info-item",{attrs:{orderInfo:e,loading:t.loading},on:{"update:loading":function(e){t.loading=e}}})],1)}),n("el-collapse-item",{attrs:{title:"分销订单",name:t.orderInfo.id}},[n("info-item",{attrs:{orderInfo:t.orderInfo,loading:t.loading},on:{"update:loading":function(e){t.loading=e}}})],1)],2):n("info-item",{attrs:{orderInfo:t.orderInfo}})],1):t._e()])},ge=[],be=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("table",{attrs:{border:"0",cellspacing:"0"}},[n("tbody",[n("tr",[n("td",{staticClass:"title"},[t._v("订单号")]),n("td",{staticClass:"content-full",attrs:{colspan:"3"}},[t._v(t._s(t.orderInfo.order_no))])]),n("tr",[n("td",{staticClass:"title"},[t._v("商品名称")]),n("td",{staticClass:"content-full",attrs:{colspan:"3"}},[t._v(t._s(t.isApiOrder?t.orderInfo.api_info.subject:t.orderInfo.product_name||(t.orderInfo.product?t.orderInfo.product.name:"未知#"+t.orderInfo.product_id))+"\n      "),t.orderInfo.product&&t.orderInfo.product.retail_from_id?n("el-tag",{staticClass:"el-tag-label"},[t._v("分销商品")]):t._e()],1)]),n("tr",[n("td",{staticClass:"title"},[t._v("数量")]),n("td",{staticClass:"content-half"},[t._v(t._s(t.orderInfo.count))]),n("td",{staticClass:"title"},[t._v("商品售价")]),n("td",{staticClass:"content-half"},[t._v(t._s(t._f("moneyFilter")(t.orderInfo.price))+"元")])]),n("tr",[n("td",{staticClass:"title"},[t._v("创建时间")]),n("td",{staticClass:"content-half"},[t._v(t._s(t.orderInfo.created_at))]),n("td",{staticClass:"title"},[t._v("优惠金额")]),n("td",{staticClass:"content-half"},[t._v(t._s(t._f("moneyFilter")(t.orderInfo.discount))+"元")])]),n("tr",[n("td",{staticClass:"title"},[t._v("创建IP")]),n("td",{staticClass:"content-half"},[t._v(t._s(t.orderInfo.ip))]),n("td",{staticClass:"title"},[t._v("手续费")]),n("td",{staticClass:"content-half"},[t._v(t._s(t._f("moneyFilter")(t.orderInfo.fee))+"元 \n      "),t.orderInfo.fee_type===t.FEE_TYPE_CUSTOMER?n("span",{staticStyle:{"font-size":"12px"}},[t._v("(买家承担)")]):t._e()])]),n("tr",[n("td",{staticClass:"title"},[t._v("付款方式")]),n("td",{staticClass:"content-half"},[t._v("\n      "+t._s(t.orderInfo.pay?t.orderInfo.pay.name:t.orderInfo.pay_id===t.ID_INNER_RETAIL?"代理进货":"未知#"+t.orderInfo.pay_id)+"\n      "),0<t.orderInfo.pay_id&&t.orderInfo.status>t.ORDER_STATUS.UN_PAY.id?n("a",{staticClass:"a-btn",attrs:{onclick:"bus.$emit('"+t.identifier+":show:pay')"}},[t._v("查看")]):t._e()]),n("td",{staticClass:"title"},[t._v(t._s(t.orderInfo.status>t.ORDER_STATUS.UN_PAY.id?"支付":"提交")+"金额")]),n("td",{staticClass:"content-half"},[t._v(t._s(t._f("moneyFilter")(t.orderInfo.paid))+"元 \n      "),t.orderInfo.sms_price?n("span",{staticStyle:{"font-size":"12px"}},[t._v("(短信费￥"+t._s((t.orderInfo.sms_price/100).toFixed(2))+")")]):t._e()])]),n("tr",[n("td",{staticClass:"title"},[t._v("付款时间")]),n("td",{staticClass:"content-half"},[t._v(t._s(t.orderInfo.paid_at))]),n("td",{staticClass:"title"},[t._v(t._s(t.orderInfo.product&&t.orderInfo.product.retail_from_id?"进货成本":"成本"))]),n("td",{staticClass:"content-half"},[t._v(t._s(t._f("moneyFilter")(t.orderInfo.cost))+"元")])]),n("tr",[t.isApiOrder?t._e():n("td",{staticClass:"title"},[t._v("联系方式")]),t.isApiOrder?t._e():n("td",{staticClass:"content-half",staticStyle:{"word-wrap":"break-word","line-height":"1"}},[t._v("\n      "+t._s(t.orderInfo.contact)+"\n    ")]),t.isApiOrder?n("td",{staticClass:"title"},[t._v("通知状态")]):t._e(),t.isApiOrder?n("td",{staticClass:"content-half",staticStyle:{"word-wrap":"break-word","line-height":"1"}},[t.orderInfo.status!==t.ORDER_STATUS.UN_PAY.id?n("div",[n("span",{class:"el-tag el-tag--"+(t.isNotified(t.orderInfo)?"success":"warning")},[t._v("\n            "+t._s(t.isNotified(t.orderInfo)?"已通知":"通知失败")+"\n          ")]),t._v("  \n        "),t.isNotified(t.orderInfo)?t._e():n("a",{staticClass:"a-btn",attrs:{onclick:"bus.$emit('"+t.identifier+":send:notify')"}},[t._v("重发通知")])]):n("div",[n("span")])]):t._e(),n("td",{staticClass:"title"},[t._v("入账")]),n("td",{staticClass:"content-half"},[t._v(t._s(t._f("moneyFilter")(t.orderInfo.income))+"元")])]),n("tr",[n("td",{staticClass:"title"},[t._v("订单状态")]),n("td",{staticClass:"content-half"},[n("span",{class:"el-tag el-tag--"+t.ORDER_STATUS.get(t.orderInfo.status).type},[t._v("\n        "+t._s(t.ORDER_STATUS.get(t.orderInfo.status).name)+"\n      ")]),t._v(" \n      "),t.isApiOrder?t._e():n("div",{staticStyle:{display:"inline"}},[n("span",{class:t.isShipped(t.orderInfo)?"green-text":"amber-text"},[t._v("\n          "+t._s(t.isShipped(t.orderInfo)?"(已发货)":""+t.renderOrderSendStatus(t.orderInfo))+"\n        ")]),t.isShipped(t.orderInfo)||t.orderInfo.status===t.ORDER_STATUS.UN_PAY.id?t._e():n("a",{staticClass:"a-btn",attrs:{onclick:"bus.$emit('"+t.identifier+":send:card')"}},[t._v("发货")]),t.isShipped(t.orderInfo)?n("a",{staticClass:"a-btn",attrs:{onclick:"bus.$emit('"+t.identifier+":show:card')"}},[t._v("查看")]):t._e()])]),n("td",{staticClass:"title"},[t._v("净利润")]),n("td",{staticClass:"content-half"},[t._v(t._s(t._f("moneyFilter")(t.orderInfo.paid-t.orderInfo.sms_price-t.orderInfo.fee-t.orderInfo.cost))+"元")])]),t.isApiOrder?n("tr",[n("td",{staticClass:"title"},[t._v("通知地址")]),n("td",{staticClass:"content-full",attrs:{colspan:"3"}},[t._v(t._s(t.orderInfo.api_info.notify_url))])]):t._e(),t.isApiOrder?n("tr",[n("td",{staticClass:"title"},[t._v("返回地址")]),n("td",{staticClass:"content-full",attrs:{colspan:"3"}},[t._v(t._s(t.orderInfo.api_info.return_url))])]):t._e(),n("tr",[n("td",{staticClass:"title"},[t._v("备注")]),n("td",{staticClass:"content-full",attrs:{colspan:"3"}},[t._v(t._s(t.orderInfo.remark))])]),n("tr",[n("td",{staticClass:"title"},[t._v("附加信息")]),n("td",{staticClass:"content-full",attrs:{colspan:"3"}},[t.orderInfo.contact_ext&&"{}"!==t.orderInfo.contact_ext?n("div",[t._v("\n            "+t._s(t.orderInfo.contact_ext)+"\n          ")]):t._e()])]),t.orderInfo.status===t.ORDER_STATUS.FROZEN.id?n("tr",[n("td",{staticClass:"title"},[t._v("冻结原因")]),n("td",{staticClass:"content-full",attrs:{colspan:"3"}},[t._v("\n      "+t._s(t.orderInfo.frozen_reason||"无")+"\n    ")])]):t._e()])])},ve=[],ye=0,we=1,Ce={props:{orderInfo:{}},data:function(){var t=-1001===this.orderInfo.product_id;return{loading:!1,ORDER_STATUS:he.a,ID_INNER_RETAIL:I.a,FEE_TYPE_MERCHANT:ye,FEE_TYPE_CUSTOMER:we,cardInfo:null,isApiOrder:t,identifier:"orderInfo_"+Math.random()}},watch:{loading:function(t){this.$emit("update:loading",t)}},mounted:function(){var t=this;this._on_show_card=function(){if(t.orderInfo){var e=t.orderInfo.card_orders.map(function(t){return t.card?t.card.card:"未知卡密#"+t.card_id}).join("<br>");t.$msgbox({title:"订单卡密信息",message:e,dangerouslyUseHTMLString:!0})}},window.bus.$on(this.identifier+":show:card",this._on_show_card),this._on_show_pay=function(){var e,n;t.orderInfo&&(n="支付方式: "+(e=t.orderInfo.pay?t.orderInfo.pay.name:"支付方式#"+t.orderInfo.pay_id)+"<br>支付时间: "+t.orderInfo.paid_at+"<br>"+e+"单号(流水号): "+t.orderInfo.pay_trade_no,t.$msgbox({title:"支付信息",message:n,dangerouslyUseHTMLString:!0}))},window.bus.$on(this.identifier+":show:pay",this._on_show_pay),this._on_send_card=function(){if(t.orderInfo){if(!t.orderInfo.product)return t.$msgbox("订单对应商品不存在, 无法发货");(t.orderInfo.product&&t.orderInfo.product.delivery===gt.a.AUTO?t.$confirm("当前订单状态为<".concat(he.a.get(t.orderInfo.status).name,">, 是否确认发货?"),"询问"):t.$prompt("当前订单状态为<".concat(he.a.get(t.orderInfo.status).name,">, 是否确认发货?<br>请输入发货卡密"),"提示",{dangerouslyUseHTMLString:!0,confirmButtonText:"确认",cancelButtonText:"取消",inputPattern:/^[\s\S]{1,255}$/,inputErrorMessage:"需1-255字符以内",inputType:"text",closeOnClickModal:!1})).then(function(e){var n=e.value;t.loading=!0,Object(he.k)(t.orderInfo.id,n).then(function(e){Object.assign(t.orderInfo,e.data),t.$notify({title:"发货成功",message:"当前订单已发货成功",type:"success",duration:3e3})}).finally(function(){t.loading=!1})})}},window.bus.$on(this.identifier+":send:card",this._on_send_card),this._on_send_notify=function(){t.orderInfo&&(t.loading=!0,Object(he.g)(t.orderInfo.id).then(function(e){Object.assign(t.orderInfo.api_info,e.data.api_info),t.$msgbox({title:"重发结果",message:e.data.notify_html,dangerouslyUseHTMLString:!1})}).finally(function(){t.loading=!1}))},window.bus.$on(this.identifier+":send:notify",this._on_send_notify)},beforeDestroy:function(){window.bus.$off(this.identifier+":show:card",this._on_show_card),window.bus.$off(this.identifier+":show:pay",this._on_show_pay),window.bus.$off(this.identifier+":send:card",this._on_send_card),window.bus.$off(this.identifier+":send:notify",this._on_send_notify)},methods:{isShipped:function(t){return t.status===he.a.SUCCESS.id||t.card_orders&&t.card_orders.length},isNotified:function(t){return t.api_info&&"success"===t.api_info.notify_ret},renderOrderSendStatus:function(t){return t.status===he.a.UN_PAY.id?"":t.status===he.a.PAID.id?t.send_status===he.b.CARD_UN.id?"待发货":t.send_status===he.b.CARD_PROCESSING.id?"正在处理":t.send_status===he.b.CARD_SUCCESS.id?"已发货":t.send_status===he.b.CARD_FAILED.id?"发货失败":"未发货":"UNKNOWN"}}},n("7431"),xe=Object(b.a)(Ce,be,ve,!1,null,null,null).exports,ke={props:{from:{type:String,default:""},info:{type:Object},_project:{default:"admin_free"}},components:{InfoItem:xe},data:function(){return{loading:!1,loadingRetail:!1,ID_INNER_RETAIL:I.a,orderInfo:null,orderVisible:!0,title:"",showOrders:[]}},mounted:function(){this.showOrder(this.info)},watch:{orderVisible:function(t){t||this.$emit("close")}},methods:{showOrder:function(t){this.orderInfo=t,"complaint"===this.from&&this.orderInfo.retail_chain&&this.orderInfo.retail_chain.length?this.showOrders=[this.orderInfo.retail_chain[0].id]:this.showOrders=[this.info.id];var e=-1001===this.orderInfo.product_id;this.title=e?"API订单信息":"订单信息"},getRetailChain:function(){var t=this;this.loadingRetail=!0,Object(he.f)(this.orderInfo.id).then(function(e){t.showOrder(e.data)}).finally(function(){t.loadingRetail=!1})}}},n("ea43"),Ae=Object(b.a)(ke,_e,ge,!1,null,null,null).exports,Se=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-dialog",{attrs:{title:"导出订单",visible:t.visible},on:{"update:visible":function(e){t.visible=e},close:function(e){return t.$emit("close")}}},[n("div",[n("p",[t._v("导出同时改变状态")]),n("el-select",{attrs:{size:"small"},model:{value:t.status,callback:function(e){t.status=e},expression:"status"}},[n("el-option",{attrs:{label:"不改变状态",value:-1}}),n("el-option",{attrs:{label:"标记位已完成",value:t.SEND_STATUS.CARD_SUCCESS.id}}),n("el-option",{attrs:{label:"标记位正在处理",value:t.SEND_STATUS.CARD_PROCESSING.id}})],1),t.status===t.SEND_STATUS.CARD_SUCCESS.id?n("div",[n("p",[t._v("请输入发货卡密(当前导出订单都将使用此相同卡密)")]),n("el-input",{attrs:{autocomplete:"false",size:"small"},model:{value:t.card,callback:function(e){t.card=e},expression:"card"}})],1):t._e()],1),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(e){return t.$emit("close")}}},[t._v("取消")]),n("el-button",{attrs:{type:"primary"},on:{click:t.handleSubmit}},[t._v("确认导出")])],1)])},Ee=[],Oe={name:"exportDialog",data:function(){return{visible:!0,SEND_STATUS:he.b,status:-1,card:""}},methods:{handleSubmit:function(){this.$emit("export",{status:this.status,card:this.card})}}},Ie=Object(b.a)(Oe,Se,Ee,!1,null,"7484a86d",null).exports,Te=-1001,$e=window.config.functions&&window.config.functions.includes("product_manual"),Re={props:{userInfo:{type:Object,default:null},recentDay:{default:!1},onlyProfit:{default:!1},_project:{default:"admin_free"}},components:{ExportDialog:Ie,OrderInfo:Ae},data:function(){return{isMobile:this.$store.state.app.isMobile,loading:!1,ORDER_STATUS:he.a,SEND_STATUS:he.b,API_ORDER_ID:Te,ID_INNER_RETAIL:me.a,PRODUCT_MANUAL:$e,search:{type:"order_no",value:""},date_range:"",where:{category_id:-1,product_id:-1,showUnPay:0,showUnSend:0},categories:[{id:-2,name:"加载中"}],products:[{id:-2,name:"加载中"}],list:{current_page:1,data:[],from:1,last_page:1,next_page_url:null,per_page:+localStorage.getItem("pageSize")||10,prev_page_url:null,to:0,total:0,profit_sum:{income:0,profit:0}},checkedVal:[],statusFilter:function(){var t,e=[];for(t in he.a)he.a.hasOwnProperty(t)&&"object"===Object(S.a)(he.a[t])&&e.push({text:he.a[t].name,value:he.a[t].id,type:he.a[t].type});return e}(),statusFilterValue:[],pickerOptions:{shortcuts:[{text:"最近一周",onClick:function(t){var e=new Date,n=new Date;n.setTime(n.getTime()-6048e5),t.$emit("pick",[n,e])}},{text:"最近一个月",onClick:function(t){var e=new Date,n=new Date;n.setTime(n.getTime()-2592e6),t.$emit("pick",[n,e])}},{text:"最近三个月",onClick:function(t){var e=new Date,n=new Date;n.setTime(n.getTime()-7776e6),t.$emit("pick",[n,e])}}]},exportDialogVisible:!1,destroyForLoad:!1,isApiOrder:!1,orderInfo:null}},watch:{loading:function(t,e){t?e||J.a.isStarted()||J.a.start():J.a.done()},isApiOrder:function(){var t=this;this.destroyForLoad=!0,this.$nextTick(function(){t.destroyForLoad=!1})}},mounted:function(){"api"===this.$route.query.type&&(this.where.category_id=Te,this.isApiOrder=!0),"admin"===this._project?(this.categories=[],this._loadOrders()):this.getCategories()},methods:{getCategories:function(){var t,e=this;this.loading=!0,t={search:"simple",val:"list"},this.userInfo&&(t.user_id=this.userInfo.id),Object(it.d)(t).then(function(t){e.categories=t.data,e._loadOrders()})},_loadOrders:function(){"paid"===this.$route.query.status?(this.where.showUnSend=1,this.handleShowUnSend(1)):"un_pay"===this.$route.query.status?(this.where.showUnPay=1,this.handleShowUnPay(1)):this.handleShowWithoutUnpay()},changeCategory:function(t){this.isApiOrder?(t!==Te&&(this.isApiOrder=!1),this.getList()):t===Te?(this.isApiOrder=!0,this.getList()):this.getProducts(t)},getProducts:function(t){var e,n=this;this.getList(),this.where.product_id=-1,this.products=[],e={search:"simple",val:t},this.userInfo&&(e.user_id=this.userInfo.id),Object(gt.h)(e).then(function(t){n.products=t.data})},getList:function(){var t=this;this.loading=!0,this.where.current_page=this.list.current_page,this.where.per_page=this.list.per_page,this.where.recent=this.recentDay,this.where.profit=this.onlyProfit?1:0,this.userInfo&&(this.where.user_id=this.userInfo.id),Object(he.e)(this.where).then(function(e){t.list=e.data,t.loading=!1})},handleSearch:function(){var t={search:this.search.type,val:this.search.value};this.date_range&&this.date_range[0]&&this.date_range[1]?(t.start_at=this.date_range[0].format("yyyy-MM-dd"),t.end_at=this.date_range[1].format("yyyy-MM-dd")):(t.start_at=null,t.end_at=null),Object.assign(this.where,t),this.getList()},handleExport:function(){var t=0<arguments.length&&void 0!==arguments[0]&&arguments[0],e=Object.assign({},this.where);if($e){if(!1===t)return void(this.exportDialogVisible=!0);e.export_update_status=t.status,e.export_update_card=t.card}window.open(window.API_HOST+"order/export?"+Object(vt.b)(e),"_blank")},handleShowUnPay:function(t){t?(this.where.showUnSend=0,this.statusFilterValue.splice(0,this.statusFilterValue.length),this.statusFilterValue.push(he.a.UN_PAY.id)):this.handleShowWithoutUnpay(),this.where.status=this.statusFilterValue.join(","),this.handleSearch()},handleShowUnSend:function(t){t?(this.where.showUnPay=0,this.statusFilterValue.splice(0,this.statusFilterValue.length),this.statusFilterValue.push(he.a.PAID.id)):this.handleShowWithoutUnpay(),this.where.status=this.statusFilterValue.join(","),this.handleSearch()},handleShowWithoutUnpay:function(){var t;(t=this.statusFilterValue).splice.apply(t,[0,this.statusFilterValue.length].concat([he.a.FROZEN.id,he.a.SUCCESS.id,he.a.PAID.id,he.a.REFUND.id])),this.where.status="",this.handleSearch()},onFilterChange:function(t){var e={};t.status?e.status=t.status.join(","):e.status=null,Object.assign(this.where,e),this.getList()},onChangePage:function(){this.getList()},onChangePageSize:function(t){localStorage.setItem("pageSize",t),this.list.per_page=t,this.getList()},showCards:function(t){t.card_orders&&t.card_orders.length&&this.$msgbox({title:"卡密详情",message:t.card_orders.map(function(t){return t.card?t.card.card:"未知卡密#"+t.card_id}).join("<br>"),dangerouslyUseHTMLString:!0})},showRemark:function(t){var e=this;this.$prompt("可以在这里修改备注","提示",{confirmButtonText:"保存",cancelButtonText:"取消",inputValue:t.remark,inputPattern:/^[\s\S]{0,100}$/,inputErrorMessage:"备注需100字符以内",inputType:"textarea",closeOnClickModal:!1}).then(function(n){var i=n.value;e.loading=!0,Object(he.c)(t.id,i).then(function(){e.loading=!1,t.remark=i}).catch(function(){e.loading=!1})})},showOrder:function(t){this.orderInfo=t},handleFreeze:function(t){var e=this;if(t.pay_id===me.a)return this.$msgbox({title:"提示",message:"此订单为分销商品自动生成的订单,  请操作原始订单",type:"error"});this.$prompt("冻结订单 ".concat(t.order_no," ? <br>请输入与冻结原因"),"提示",{dangerouslyUseHTMLString:!0,confirmButtonText:"保存",cancelButtonText:"取消",inputValue:t.frozen_reason,inputPattern:/^[\s\S]{2,100}$/,inputErrorMessage:"冻结原因需2-100字符以内",inputType:"textarea",closeOnClickModal:!1}).then(function(n){var i=n.value;e.loading=!0,Object(he.d)(t.id,i).then(function(n){return 1!==n.data[0]?e.$msgbox({title:"操作失败",message:"未知错误",type:"error"}):1!==n.data[1]?e.$msgbox({title:"操作失败",message:"冻结订单失败, 内部错误",type:"error"}):(e.$notify({title:"操作完成",message:t.order_no+" 已冻结",type:"success"}),void(t.status=he.a.FROZEN.id))}).finally(function(){e.loading=!1})})},handleUnfreeze:function(t){var e=this;if(t.pay_id===me.a)return this.$msgbox({title:"提示",message:"此订单为分销商品自动生成的订单,  请操作原始订单",type:"error"});this.$confirm("解冻订单 "+t.order_no+" ? ","提示",{type:"warning"}).then(function(){e.loading=!0,Object(he.m)(t.id).then(function(n){return 1!==n.data[0]?e.$msgbox({title:"操作失败",message:"未知错误",type:"error"}):1!==n.data[1]?e.$msgbox({title:"操作失败",message:"解冻订单失败, 内部错误",type:"error"}):(e.$notify({title:"操作完成",message:t.order_no+" 已解冻",type:"success"}),void(t.status=n.data[2]))}).finally(function(){e.loading=!1})})},handleRefund:function(t){var e=this;if(t.pay_id===me.a)return this.$msgbox({title:"提示",message:"此订单为分销商品自动生成的订单,  请操作原始订单",type:"error"});this.$confirm("退款订单 "+t.order_no+" ? ","提示",{type:"warning"}).then(function(){e.loading=!0,Object(he.h)(t.id).then(function(n){return 1!==n.data[0]?e.$msgbox({title:"操作失败",message:"未知错误",type:"error"}):1!==n.data[1]?e.$msgbox({title:"操作失败",message:"退款订单失败, 内部错误",type:"error"}):(e.$notify({title:"操作完成",message:t.order_no+" 已退款",type:"success"}),void(t.status=he.a.REFUND.id))}).finally(function(){e.loading=!1})})},checkFreeze:function(){var t,e=this;if(this.checkedVal.length){if(1===this.checkedVal.length)return this.handleFreeze(this.checkedVal[0]);t=this.checkedVal.map(function(t){return t.id}).join(","),this.$prompt("批量冻结选中订单? (只冻结交易成功订单) <br>请输入与冻结原因","提示",{dangerouslyUseHTMLString:!0,confirmButtonText:"确认",cancelButtonText:"取消",inputPattern:/^[\s\S]{2,100}$/,inputErrorMessage:"冻结原因需2-100字符以内",inputType:"textarea",closeOnClickModal:!1}).then(function(n){var i=n.value;e.loading=!0,Object(he.d)(t,i).then(function(t){e.$notify({title:"操作完成",message:"总订单: ".concat(t.data[0]," 笔，冻结成功 ").concat(t.data[1]," 笔"),type:t.data[0]&&t.data[0]===t.data[1]?"success":"info"}),e.getList()}).catch(function(){e.loading=!1})})}},checkUnfreeze:function(){var t,e=this;if(this.checkedVal.length){if(1===this.checkedVal.length)return this.handleUnfreeze(this.checkedVal[0]);t=this.checkedVal.map(function(t){return t.id}).join(","),this.$confirm("批量解冻选中订单? (只处理已冻结订单)","提示",{type:"warning"}).then(function(){Object(he.m)(t).then(function(t){e.$notify({title:"操作完成",message:"总订单: ".concat(t.data[0]," 笔，解冻成功 ").concat(t.data[1]," 笔"),type:t.data[0]&&t.data[0]===t.data[1]?"success":"info"}),e.getList()}).catch(function(){e.loading=!1})})}},checkRefund:function(){var t,e=this;if(this.checkedVal.length){if(1===this.checkedVal.length)return this.handleRefund(this.checkedVal[0]);t=this.checkedVal.map(function(t){return t.id}).join(","),this.$confirm("批量退款选中订单? (请手动联系用户打款)","提示",{type:"warning"}).then(function(){Object(he.h)(t).then(function(t){e.$notify({title:"操作完成",message:"总订单: ".concat(t.data[0]," 笔，退款成功 ").concat(t.data[1]," 笔"),type:t.data[0]&&t.data[0]===t.data[1]?"success":"info"}),e.getList()}).catch(function(){e.loading=!1})})}},handleSetPaid:function(t){var e,n=this;if(t.pay_id===me.a)return this.$msgbox({title:"提示",message:"此订单为分销商品自动生成的订单,  请操作原始订单",type:"error"});e=t.pay?t.pay.name:"支付方式#"+t.pay_id,this.$prompt("请仔细确认已经收到款项，<br>确认将订单 ".concat(t.order_no," 设置为已付款并发货? <br>请输入").concat(e,"内单号(流水号)"),"提示",{dangerouslyUseHTMLString:!0,confirmButtonText:"确认",cancelButtonText:"取消",inputPattern:/^[\s\S]{2,100}$/,inputErrorMessage:"单号需2-100字符以内",inputType:"text",closeOnClickModal:!1}).then(function(e){var i=e.value;n.loading=!0,Object(he.i)(t.id,i).then(function(e){var i=e.data;if(n.loading=!1,Object.assign(t,i.order),0!==i.code)return n.$msgbox({title:"提示",message:i.msg,type:"error",dangerouslyUseHTMLString:!0});n.$notify({title:"操作完成",message:t.order_no+" 已补单成功",type:"success"})}).catch(function(){n.loading=!1})})},handleSendCard:function(t){var e=this;if(!t.product)return this.$msgbox("订单对应商品不存在, 无法发货");(t.product.delivery===gt.a.AUTO?this.$confirm("当前订单状态为<".concat(he.a.get(t.status).name,">, 是否确认发货?"),"询问"):this.$prompt("当前订单状态为<".concat(he.a.get(t.status).name,">, 是否确认发货?<br>请输入发货卡密"),"提示",{dangerouslyUseHTMLString:!0,confirmButtonText:"确认",cancelButtonText:"取消",inputValue:"已充值成功",inputPattern:/^[\s\S]{1,255}$/,inputErrorMessage:"需1-255字符以内",inputType:"text",closeOnClickModal:!1})).then(function(n){var i=n.value;e.loading=!0,Object(he.k)(t.id,i).then(function(n){Object.assign(t,n.data),e.$notify({title:"发货成功",message:"当前订单已发货成功",type:"success",duration:3e3})}).finally(function(){e.loading=!1})})},handleSetSendStatus:function(t,e){if(e===he.b.CARD_SUCCESS.id)return this.handleSendCard(t);var n=t.send_status;t.send_status=e,Object(he.j)(t.id,e).catch(function(){t.send_status=n})}}},n("1e6a"),Pe=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("order-list",{attrs:{recentDay:7}})},De=[],Le={components:{orderList:je=Object(b.a)(Re,fe,pe,!1,null,null,null).exports}},Me=Object(b.a)(Le,Pe,De,!1,null,null,null).exports,ze=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("order-list",{attrs:{onlyProfit:!0}})},Ue=[],Ne={components:{orderList:je}},Fe=Object(b.a)(Ne,ze,Ue,!1,null,null,null).exports,Be=function(t){return function(){return n("1a5d")("./"+t+".vue")}},l.default.use(c.default),Ve=[{path:"/admin/login",name:"登录",component:Be("login/login"),hidden:!0},{path:"/admin/404",name:"404 Not Found",component:v,hidden:!0},{path:"/admin/",redirect:"/admin/dashboard/index",hidden:!0},{path:"/admin/dashboard",component:d.default,redirect:"/admin/dashboard/index",hidden:!1,noDropdown:!0,icon:"tachometer-alt",children:[{path:"index",name:"概览",component:Be("dashboard/index")}]},{path:"/admin/system",component:d.default,redirect:"noredirect",hidden:!1,icon:"cogs",name:"管理中心",children:[{path:"set",name:"网站设置",icon:"cog",component:Be("system/set/index")},{path:"pay",name:"支付渠道",icon:"credit-card",component:H},{path:"logs",name:"登录日志",icon:"regular/sticky-note",component:K},{path:"security",name:"修改密码",icon:"regular/shield-alt",component:Be("system/security/index")}]},{path:"/admin/product",component:d.default,redirect:"noredirect",hidden:!1,icon:"cubes",name:"商品管理",children:[{path:"category",name:"商品分类",icon:"bars",component:pt},{path:"list",name:"商品列表",icon:"bars",component:$t},{path:"add",name:"添加商品",icon:"regular/plus",component:xt},{path:"card/add",name:"添加卡密",icon:"regular/plus",component:Dt},{path:"card/list",name:"卡密管理",icon:"bars",component:Yt},{path:"card/recycle",name:"卡密回收站",icon:"light/trash-alt",component:Qt}]},{path:"/admin/order",component:d.default,redirect:"noredirect",hidden:!1,icon:"list-ul",name:"交易管理",children:[{path:"list",name:"订单记录",icon:"bars",component:je},{path:"recent",name:"7日订单",icon:"bars",component:Me},{path:"analysis",name:"收益统计",icon:"chart-bar",component:Fe}]},{path:"/admin/coupon",component:d.default,redirect:"noredirect",hidden:!1,icon:"tags",name:"营销助手",children:[{path:"add",name:"添加优惠券",icon:"regular/plus",component:ce},{path:"list",name:"管理优惠券",icon:"bars",component:ue}]}],Ye=new c.default({mode:"history",scrollBehavior:function(){return{y:0}},routes:Ve}),qe=[{path:"/admin/about",component:d.default,redirect:"/admin/about/index",hidden:!1,noDropdown:!0,icon:"info",children:[{path:"index",name:"关于系统",component:x}]},{path:"/*",redirect:"/admin/404",hidden:!0}],He=n("2f62"),We=n("768b"),n("ac4d"),n("8a81"),Ge={state:{sidebar:{opened:!(Qe=n("a80e")).a.isMobile()&&!+localStorage.getItem("sidebarStatus")},theme:"default",livenewsChannels:localStorage.getItem("livenewsChannels")||"[]",visitedViews:[],isMobile:Qe.a.isMobile()},mutations:{TOGGLE_SIDEBAR:function(t){t.sidebar.opened?localStorage.setItem("sidebarStatus","1"):localStorage.setItem("sidebarStatus","0"),t.sidebar.opened=!t.sidebar.opened},ADD_VISITED_VIEWS:function(t,e){t.visitedViews.some(function(t){return t.path===e.path})||t.visitedViews.push({name:e.name,path:e.path})},DEL_VISITED_VIEWS:function(t,e){var n,i,a,o,r,s=!0,l=!1,c=void 0;try{for(i=t.visitedViews.entries()[Symbol.iterator]();!(s=(a=i.next()).done);s=!0)if(r=(o=Object(We.a)(a.value,2))[0],o[1].path===e.path){n=r;break}}catch(t){l=!0,c=t}finally{try{s||null==i.return||i.return()}finally{if(l)throw c}}t.visitedViews.splice(n,1)}},actions:{ToggleSideBar:function(t){(0,t.commit)("TOGGLE_SIDEBAR")},addVisitedViews:function(t,e){(0,t.commit)("ADD_VISITED_VIEWS",e)},delVisitedViews:function(t,e){(0,t.commit)("DEL_VISITED_VIEWS",e)}}},Je=n("7ded"),Ze=n("a78e"),Xe=n.n(Ze),Ke="admin_free-token",tn={state:{token:o(),userInfo:{},role:""},mutations:{SET_TOKEN:function(t,e){t.token=e},SET_USER_INFO:function(t,e){t.userInfo=e},SET_ROLE:function(t,e){t.role=e}},actions:{Login:function(t,e){var n=t.commit;return new Promise(function(t,i){Object(Je.d)(e).then(function(i){var a,o=i.data,r=o.user;a=o.token,e.remember,Xe.a.set(Ke,a),n("SET_TOKEN",o.token),n("SET_USER_INFO",r),n("SET_ROLE",r.role),t(o)}).catch(function(t){i(t)})})},GetInfo:function(t){var e=t.commit,n=t.state;return new Promise(function(t,i){Object(Je.b)(n.token).then(function(n){var i=n.data.user;e("SET_USER_INFO",i),e("SET_ROLE",i.role),t(n)}).catch(function(t){i(t)})})},Logout:function(t){var e=t.commit,n=t.state;return new Promise(function(t,i){Object(Je.e)(n.token).then(function(){e("SET_TOKEN",""),e("SET_ROLE",""),r(),t()}).catch(function(){e("SET_TOKEN",""),e("SET_ROLE",""),r(),t()})})}}},n("6762"),n("2fdb"),n("a481"),en={state:{routers:Ve,addRouters:[]},mutations:{SET_ROUTERS:function(t,e){t.addRouters=e,t.routers=Ve.concat(e)}},actions:{GenerateRoutes:function(t,e){var n=t.commit;return new Promise(function(t){var i;e.user.id,(i=qe).push({path:"/*",redirect:"/admin/404",hidden:!0}),n("SET_ROUTERS",i),t()})}}},nn={sidebar:function(t){return t.app.sidebar},userInfo:function(t){return t.user.userInfo},role:function(t){return t.user.role},permission_routers:function(t){return t.permission.routers},addRouters:function(t){return t.permission.addRouters}},l.default.use(He.default),an=new He.default.Store({modules:{app:Ge,user:tn,permission:en},getters:nn}),n("4d34"),n("50ef"),n("a505"),n("aea4"),n("b7a3"),n("a917"),n("a3f2"),n("890e"),n("fb9f"),n("044d"),n("e675"),n("75b3"),n("7706"),n("e947"),n("3929"),n("ee58"),n("d34b"),n("b071"),n("9f71"),n("6e31"),n("1ed6"),n("fb13"),n("ea4b"),n("c779"),n("3d73"),(on=n("0874")).a.register({"regular/shield-alt":{width:512,height:512,d:"M256 409.6V100l-142.9 59.5c8.4 116.2 65.2 202.6 142.9 250.1zM466.5 83.7l-192-80a48.15 48.15 0 0 0-36.9 0l-192 80C27.7 91.1 16 108.6 16 128c0 198.5 114.5 335.7 221.5 380.3 11.8 4.9 25.1 4.9 36.9 0C360.1 472.6 496 349.3 496 128c0-19.4-11.7-36.9-29.5-44.3zM256 464C158.5 423.4 64 297.3 64 128l192-80 192 80c0 173.8-98.4 297-192 336z"}}),on.a.register({"regular/info-circle":{width:512,height:512,d:"M256 8C119.043 8 8 119.083 8 256c0 136.997 111.043 248 248 248s248-111.003 248-248C504 119.083 392.957 8 256 8zm0 448c-110.532 0-200-89.431-200-200 0-110.495 89.472-200 200-200 110.491 0 200 89.471 200 200 0 110.53-89.431 200-200 200zm0-338c23.196 0 42 18.804 42 42s-18.804 42-42 42-42-18.804-42-42 18.804-42 42-42zm56 254c0 6.627-5.373 12-12 12h-88c-6.627 0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h12v-64h-12c-6.627 0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h64c6.627 0 12 5.373 12 12v100h12c6.627 0 12 5.373 12 12v24z"}}),on.a.register({"regular/link":{width:512,height:512,d:"M314.222 197.78c51.091 51.091 54.377 132.287 9.75 187.16-6.242 7.73-2.784 3.865-84.94 86.02-54.696 54.696-143.266 54.745-197.99 0-54.711-54.69-54.734-143.255 0-197.99 32.773-32.773 51.835-51.899 63.409-63.457 7.463-7.452 20.331-2.354 20.486 8.192a173.31 173.31 0 0 0 4.746 37.828c.966 4.029-.272 8.269-3.202 11.198L80.632 312.57c-32.755 32.775-32.887 85.892 0 118.8 32.775 32.755 85.892 32.887 118.8 0l75.19-75.2c32.718-32.725 32.777-86.013 0-118.79a83.722 83.722 0 0 0-22.814-16.229c-4.623-2.233-7.182-7.25-6.561-12.346 1.356-11.122 6.296-21.885 14.815-30.405l4.375-4.375c3.625-3.626 9.177-4.594 13.76-2.294 12.999 6.524 25.187 15.211 36.025 26.049zM470.958 41.04c-54.724-54.745-143.294-54.696-197.99 0-82.156 82.156-78.698 78.29-84.94 86.02-44.627 54.873-41.341 136.069 9.75 187.16 10.838 10.838 23.026 19.525 36.025 26.049 4.582 2.3 10.134 1.331 13.76-2.294l4.375-4.375c8.52-8.519 13.459-19.283 14.815-30.405.621-5.096-1.938-10.113-6.561-12.346a83.706 83.706 0 0 1-22.814-16.229c-32.777-32.777-32.718-86.065 0-118.79l75.19-75.2c32.908-32.887 86.025-32.755 118.8 0 32.887 32.908 32.755 86.025 0 118.8l-45.848 45.84c-2.93 2.929-4.168 7.169-3.202 11.198a173.31 173.31 0 0 1 4.746 37.828c.155 10.546 13.023 15.644 20.486 8.192 11.574-11.558 30.636-30.684 63.409-63.457 54.733-54.735 54.71-143.3-.001-197.991z"}}),on.a.register({"regular/yen-sign":{width:512,height:512,d:"M347.983 32h-44.065a12.001 12.001 0 0 0-10.555 6.291l-73.76 133.313c-13.96 29.825-27.286 64.725-27.286 64.725h-1.269s-13.326-34.901-27.287-64.725L90.689 38.328A12 12 0 0 0 80.115 32H36.017c-9.157 0-14.94 9.844-10.481 17.843L119.746 216H68c-6.627 0-12 5.373-12 12v24c0 6.627 5.373 12 12 12h77.18l14.775 26.267V312H68c-6.627 0-12 5.373-12 12v24c0 6.627 5.373 12 12 12h91.955v108c0 6.627 5.373 12 12 12h39.456c6.627 0 12-5.373 12-12V360H316c6.627 0 12-5.373 12-12v-24c0-6.627-5.373-12-12-12h-92.589v-21.733L238.185 264H316c6.627 0 12-5.373 12-12v-24c0-6.627-5.373-12-12-12h-52.367L358.45 49.87c4.485-7.999-1.296-17.87-10.467-17.87z"}}),on.a.register({"regular/chart-pie-o":{width:512,height:512,d:"M461.29 288H224V50.71c0-8.83-7.18-16.21-15.74-16.21-.7 0-1.4.05-2.11.15C87.08 51.47-3.96 155.43.13 280.07 4.2 404.1 107.91 507.8 231.93 511.87c2.69.09 5.39.13 8.07.13 121.04 0 220.89-89.66 237.35-206.16 1.33-9.45-6.52-17.84-16.06-17.84zM240 464c-2.15 0-4.33-.04-6.5-.11-98.98-3.25-182.15-86.42-185.4-185.4C45.31 193.22 98.36 118.35 176 91.14V336h244.78C394.15 411.06 322.06 464 240 464zM288.8.04c-.35-.03-.7-.04-1.04-.04C279.1 0 272 7.44 272 16.23V240h223.77c9.14 0 16.82-7.69 16.2-16.8C503.72 103.74 408.26 8.28 288.8.04z"}}),on.a.register({"regular/trash-alt":{width:512,height:512,d:"M268 416h24a12 12 0 0 0 12-12V188a12 12 0 0 0-12-12h-24a12 12 0 0 0-12 12v216a12 12 0 0 0 12 12zM432 80h-82.41l-34-56.7A48 48 0 0 0 274.41 0H173.59a48 48 0 0 0-41.16 23.3L98.41 80H16A16 16 0 0 0 0 96v16a16 16 0 0 0 16 16h16v336a48 48 0 0 0 48 48h288a48 48 0 0 0 48-48V128h16a16 16 0 0 0 16-16V96a16 16 0 0 0-16-16zM171.84 50.91A6 6 0 0 1 177 48h94a6 6 0 0 1 5.15 2.91L293.61 80H154.39zM368 464H80V128h288zm-212-48h24a12 12 0 0 0 12-12V188a12 12 0 0 0-12-12h-24a12 12 0 0 0-12 12v216a12 12 0 0 0 12 12z"}}),on.a.register({"light/trash-alt":{width:512,height:512,d:"M296 432h16a8 8 0 0 0 8-8V152a8 8 0 0 0-8-8h-16a8 8 0 0 0-8 8v272a8 8 0 0 0 8 8zm-160 0h16a8 8 0 0 0 8-8V152a8 8 0 0 0-8-8h-16a8 8 0 0 0-8 8v272a8 8 0 0 0 8 8zM440 64H336l-33.6-44.8A48 48 0 0 0 264 0h-80a48 48 0 0 0-38.4 19.2L112 64H8a8 8 0 0 0-8 8v16a8 8 0 0 0 8 8h24v368a48 48 0 0 0 48 48h288a48 48 0 0 0 48-48V96h24a8 8 0 0 0 8-8V72a8 8 0 0 0-8-8zM171.2 38.4A16.1 16.1 0 0 1 184 32h80a16.1 16.1 0 0 1 12.8 6.4L296 64H152zM384 464a16 16 0 0 1-16 16H80a16 16 0 0 1-16-16V96h320zm-168-32h16a8 8 0 0 0 8-8V152a8 8 0 0 0-8-8h-16a8 8 0 0 0-8 8v272a8 8 0 0 0 8 8z"}}),on.a.register({"regular/comment-alt-exclamation":{width:512,height:512,d:"M256 256c-17.7 0-32 14.3-32 32s14.3 32 32 32 32-14.3 32-32-14.3-32-32-32zM448 0H64C28.7 0 0 28.7 0 64v288c0 35.3 28.7 64 64 64h96v84c0 7.1 5.8 12 12 12 2.4 0 4.9-.7 7.1-2.4L304 416h144c35.3 0 64-28.7 64-64V64c0-35.3-28.7-64-64-64zm16 352c0 8.8-7.2 16-16 16H288l-12.8 9.6L208 428v-60H64c-8.8 0-16-7.2-16-16V64c0-8.8 7.2-16 16-16h384c8.8 0 16 7.2 16 16v288zM284.7 96h-57.4c-10 0-17.6 9.1-15.7 18.9l18 96c1.4 7.6 8 13.1 15.7 13.1h21.4c7.7 0 14.3-5.5 15.7-13.1l18-96c1.9-9.8-5.7-18.9-15.7-18.9z"}}),on.a.register({"regular/undo":{width:512,height:512,d:"M12 8h27.711c6.739 0 12.157 5.548 11.997 12.286l-2.347 98.568C93.925 51.834 170.212 7.73 256.793 8.001 393.18 8.428 504.213 120.009 504 256.396 503.786 393.181 392.835 504 256 504c-63.926 0-122.202-24.187-166.178-63.908-5.113-4.618-5.354-12.561-.482-17.433l19.738-19.738c4.498-4.498 11.753-4.785 16.501-.552C160.213 433.246 205.895 452 256 452c108.322 0 196-87.662 196-196 0-108.322-87.662-196-196-196-79.545 0-147.941 47.282-178.675 115.302l126.389-3.009c6.737-.16 12.286 5.257 12.286 11.997V212c0 6.627-5.373 12-12 12H12c-6.627 0-12-5.373-12-12V20C0 13.373 5.373 8 12 8z"}}),on.a.register({"light/pencil":{width:512,height:512,d:"M493.255 56.236l-37.49-37.49c-24.993-24.993-65.515-24.994-90.51 0L12.838 371.162.151 485.346c-1.698 15.286 11.22 28.203 26.504 26.504l114.184-12.687 352.417-352.417c24.992-24.994 24.992-65.517-.001-90.51zm-95.196 140.45L174 420.745V386h-48v-48H91.255l224.059-224.059 82.745 82.745zM126.147 468.598l-58.995 6.555-30.305-30.305 6.555-58.995L63.255 366H98v48h48v34.745l-19.853 19.853zm344.48-344.48l-49.941 49.941-82.745-82.745 49.941-49.941c12.505-12.505 32.748-12.507 45.255 0l37.49 37.49c12.506 12.506 12.507 32.747 0 45.255z"}}),on.a.register({"light/sync":{width:512,height:512,d:"M492 8h-10c-6.627 0-12 5.373-12 12v110.627C426.929 57.261 347.224 8 256 8 123.228 8 14.824 112.338 8.31 243.493 7.971 250.311 13.475 256 20.301 256h10.016c6.353 0 11.646-4.949 11.977-11.293C48.157 132.216 141.097 42 256 42c82.862 0 154.737 47.077 190.289 116H332c-6.627 0-12 5.373-12 12v10c0 6.627 5.373 12 12 12h160c6.627 0 12-5.373 12-12V20c0-6.627-5.373-12-12-12zm-.301 248h-10.015c-6.352 0-11.647 4.949-11.977 11.293C463.841 380.158 370.546 470 256 470c-82.608 0-154.672-46.952-190.299-116H180c6.627 0 12-5.373 12-12v-10c0-6.627-5.373-12-12-12H20c-6.627 0-12 5.373-12 12v160c0 6.627 5.373 12 12 12h10c6.627 0 12-5.373 12-12V381.373C85.071 454.739 164.777 504 256 504c132.773 0 241.176-104.338 247.69-235.493.339-6.818-5.165-12.507-11.991-12.507z"}}),on.a.register({"regular/plus":{width:384,height:512,d:"M368 224H224V80c0-8.84-7.16-16-16-16h-32c-8.84 0-16 7.16-16 16v144H16c-8.84 0-16 7.16-16 16v32c0 8.84 7.16 16 16 16h144v144c0 8.84 7.16 16 16 16h32c8.84 0 16-7.16 16-16V288h144c8.84 0 16-7.16 16-16v-32c0-8.84-7.16-16-16-16z"}}),on.a.register({"regular/angle-double-right":{width:384,height:512,d:"M363.8 264.5L217 412.5c-4.7 4.7-12.3 4.7-17 0l-19.8-19.8c-4.7-4.7-4.7-12.3 0-17L298.7 256 180.2 136.3c-4.7-4.7-4.7-12.3 0-17L200 99.5c4.7-4.7 12.3-4.7 17 0l146.8 148c4.7 4.7 4.7 12.3 0 17zm-160-17L57 99.5c-4.7-4.7-12.3-4.7-17 0l-19.8 19.8c-4.7 4.7-4.7 12.3 0 17L138.7 256 20.2 375.7c-4.7 4.7-4.7 12.3 0 17L40 412.5c4.7 4.7 12.3 4.7 17 0l146.8-148c4.7-4.7 4.7-12.3 0-17z"}}),on.a.register({"light/clock":{width:512,height:512,d:"M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm216 248c0 118.7-96.1 216-216 216-118.7 0-216-96.1-216-216 0-118.7 96.1-216 216-216 118.7 0 216 96.1 216 216zm-148.9 88.3l-81.2-59c-3.1-2.3-4.9-5.9-4.9-9.7V116c0-6.6 5.4-12 12-12h14c6.6 0 12 5.4 12 12v146.3l70.5 51.3c5.4 3.9 6.5 11.4 2.6 16.8l-8.2 11.3c-3.9 5.3-11.4 6.5-16.8 2.6z"}}),on.a.register({"light/file-alt":{width:384,height:512,d:"M369.9 97.9L286 14C277 5 264.8-.1 252.1-.1H48C21.5 0 0 21.5 0 48v416c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48V131.9c0-12.7-5.1-25-14.1-34zm-22.6 22.7c2.1 2.1 3.5 4.6 4.2 7.4H256V32.5c2.8.7 5.3 2.1 7.4 4.2l83.9 83.9zM336 480H48c-8.8 0-16-7.2-16-16V48c0-8.8 7.2-16 16-16h176v104c0 13.3 10.7 24 24 24h104v304c0 8.8-7.2 16-16 16zm-48-244v8c0 6.6-5.4 12-12 12H108c-6.6 0-12-5.4-12-12v-8c0-6.6 5.4-12 12-12h168c6.6 0 12 5.4 12 12zm0 64v8c0 6.6-5.4 12-12 12H108c-6.6 0-12-5.4-12-12v-8c0-6.6 5.4-12 12-12h168c6.6 0 12 5.4 12 12zm0 64v8c0 6.6-5.4 12-12 12H108c-6.6 0-12-5.4-12-12v-8c0-6.6 5.4-12 12-12h168c6.6 0 12 5.4 12 12z"}}),on.a.register({"light/question-circle":{width:512,height:512,d:"M256 340c-15.464 0-28 12.536-28 28s12.536 28 28 28 28-12.536 28-28-12.536-28-28-28zm7.67-24h-16c-6.627 0-12-5.373-12-12v-.381c0-70.343 77.44-63.619 77.44-107.408 0-20.016-17.761-40.211-57.44-40.211-29.144 0-44.265 9.649-59.211 28.692-3.908 4.98-11.054 5.995-16.248 2.376l-13.134-9.15c-5.625-3.919-6.86-11.771-2.645-17.177C185.658 133.514 210.842 116 255.67 116c52.32 0 97.44 29.751 97.44 80.211 0 67.414-77.44 63.849-77.44 107.408V304c0 6.627-5.373 12-12 12zM256 40c118.621 0 216 96.075 216 216 0 119.291-96.61 216-216 216-119.244 0-216-96.562-216-216 0-119.203 96.602-216 216-216m0-32C119.043 8 8 119.083 8 256c0 136.997 111.043 248 248 248s248-111.003 248-248C504 119.083 392.957 8 256 8z"}}),on.a.register({"light/link":{width:512,height:512,d:"M301.148 394.702l-79.2 79.19c-50.778 50.799-133.037 50.824-183.84 0-50.799-50.778-50.824-133.037 0-183.84l79.19-79.2a132.833 132.833 0 0 1 3.532-3.403c7.55-7.005 19.795-2.004 20.208 8.286.193 4.807.598 9.607 1.216 14.384.481 3.717-.746 7.447-3.397 10.096-16.48 16.469-75.142 75.128-75.3 75.286-36.738 36.759-36.731 96.188 0 132.94 36.759 36.738 96.188 36.731 132.94 0l79.2-79.2.36-.36c36.301-36.672 36.14-96.07-.37-132.58-8.214-8.214-17.577-14.58-27.585-19.109-4.566-2.066-7.426-6.667-7.134-11.67a62.197 62.197 0 0 1 2.826-15.259c2.103-6.601 9.531-9.961 15.919-7.28 15.073 6.324 29.187 15.62 41.435 27.868 50.688 50.689 50.679 133.17 0 183.851zm-90.296-93.554c12.248 12.248 26.362 21.544 41.435 27.868 6.388 2.68 13.816-.68 15.919-7.28a62.197 62.197 0 0 0 2.826-15.259c.292-5.003-2.569-9.604-7.134-11.67-10.008-4.528-19.371-10.894-27.585-19.109-36.51-36.51-36.671-95.908-.37-132.58l.36-.36 79.2-79.2c36.752-36.731 96.181-36.738 132.94 0 36.731 36.752 36.738 96.181 0 132.94-.157.157-58.819 58.817-75.3 75.286-2.651 2.65-3.878 6.379-3.397 10.096a163.156 163.156 0 0 1 1.216 14.384c.413 10.291 12.659 15.291 20.208 8.286a131.324 131.324 0 0 0 3.532-3.403l79.19-79.2c50.824-50.803 50.799-133.062 0-183.84-50.802-50.824-133.062-50.799-183.84 0l-79.2 79.19c-50.679 50.682-50.688 133.163 0 183.851z"}}),rn=on.a,sn=n("af88"),n("0fb7"),n("450d"),ln=n("f529"),cn=n.n(ln),n("46a1"),dn=n("e5f2"),un=n.n(dn),n("9e1f"),fn=n("6ed5"),pn=n.n(fn),n("be4f"),hn=n("896a"),mn=n.n(hn),n("b0ee"),_n=n("d180"),gn=n.n(_n),n("a335"),bn=n("c0bb"),vn=n.n(bn),n("b8e0"),yn=n("a4c4"),wn=n.n(yn),n("e2f3"),Cn=n("06f9"),xn=n.n(Cn),n("f225"),kn=n("89a9"),An=n.n(kn),n("f4f9"),Sn=n("c2cc"),En=n.n(Sn),n("7a0f"),On=n("0f6c"),In=n.n(On),n("915d"),Tn=n("e04d"),$n=n.n(Tn),n("cbb5"),Rn=n("8bbc"),jn=n.n(Rn),n("e612"),Pn=n("dd87"),Dn=n.n(Pn),n("075a"),Ln=n("72aa"),Mn=n.n(Ln),n("eca7"),zn=n("3787"),Un=n.n(zn),n("425f"),Nn=n("4105"),Fn=n.n(Nn),n("b84d"),Bn=n("c216"),Vn=n.n(Bn),n("8f24"),Yn=n("76b9"),qn=n.n(Yn),n("0c67"),Hn=n("299c"),Wn=n.n(Hn),n("826b"),Qn=n("c263"),Gn=n.n(Qn),n("5466"),Jn=n("ecdf"),Zn=n.n(Jn),n("38a0"),Xn=n("ad41"),Kn=n.n(Xn),n("ae26"),ti=n("845f"),ei=n.n(ti),n("1951"),ni=n("eedf"),ii=n.n(ni),n("016f"),ai=n("486c"),oi=n.n(ai),n("6611"),ri=n("e772"),si=n.n(ri),n("1f1a"),li=n("4e4b"),ci=n.n(li),n("e960"),di=n("b35b"),ui=n.n(di),n("d4df"),fi=n("7fc1"),pi=n.n(fi),n("c526"),hi=n("1599"),mi=n.n(hi),n("560b"),_i=n("dcdc"),gi=n.n(_i),n("3c52"),bi=n("0d7b"),vi=n.n(bi),n("fe07"),yi=n("6ac5"),wi=n.n(yi),n("b5d8"),Ci=n("f494"),xi=n.n(Ci),n("9d4c"),ki=n("e450"),Ai=n.n(ki),n("10cb"),Si=n("f3ad"),Ei=n.n(Si),n("34db"),Oi=n("3803"),Ii=n.n(Oi),n("8bd8"),Ti=n("4cb2"),$i=n.n(Ti),n("ce18"),Ri=n("f58e"),ji=n.n(Ri),n("4ca3"),Pi=n("443e"),Di=n.n(Pi),n("bd49"),Li=n("18ff"),Mi=n.n(Li),n("960d"),zi=n("defb"),Ui=n.n(zi),n("cb70"),Ni=n("b370"),Fi=n.n(Ni),n("a7cc"),Bi=n("df33"),Vi=n.n(Bi),n("672e"),Yi=n("101e"),qi=n.n(Yi),n("fd71"),Hi=n("a447"),Wi=n.n(Hi),n("0fae"),Qi=n("5488"),Gi=n.n(Qi),l.default.use(Wi.a),l.default.use(qi.a),l.default.use(Vi.a),l.default.use(Fi.a),l.default.use(Ui.a),l.default.use(Mi.a),l.default.use(Di.a),l.default.use(ji.a),l.default.use($i.a),l.default.use(Ii.a),l.default.use(Ei.a),l.default.use(Ai.a),l.default.use(xi.a),l.default.use(wi.a),l.default.use(vi.a),l.default.use(gi.a),l.default.use(mi.a),l.default.use(pi.a),l.default.use(ui.a),l.default.use(ci.a),l.default.use(si.a),l.default.use(oi.a),l.default.use(ii.a),l.default.use(ei.a),l.default.use(Kn.a),l.default.use(Zn.a),l.default.use(Gn.a),l.default.use(Wn.a),l.default.use(qn.a),l.default.use(Vn.a),l.default.use(Fn.a),l.default.use(Un.a),l.default.use(Mn.a),l.default.use(Dn.a),l.default.use(jn.a),l.default.use($n.a),l.default.use(In.a),l.default.use(En.a),l.default.use(An.a),l.default.use(xn.a),l.default.use(wn.a),l.default.use(vn.a),l.default.use(gn.a),l.default.component(Gi.a.name,Gi.a),l.default.use(mn.a.directive),l.default.prototype.$loading=mn.a.service,l.default.prototype.$msgbox=pn.a,l.default.prototype.$alert=pn.a.alert,l.default.prototype.$confirm=pn.a.confirm,l.default.prototype.$prompt=pn.a.prompt,l.default.prototype.$notify=un.a,l.default.prototype.$message=cn.a,Ji=n("323e"),Zi=n.n(Ji),n("a5d8"),n("f5df"),n("8096"),Xi=n("1157"),Ki=n.n(Xi),ta=n("38e1"),n("0183"),function(t){function e(t){this._obj=t}function n(t){var n=this;new e(t)._each(function(t,e){n[t]=e})}var i,a,o,r,s,l,c,d,u,f,p,h,m,_,g,b,v,y,w,C,x,k,A;if(void 0===t)throw Error("Geetest requires browser environment");i=t.document,a=t.Math,o=i.getElementsByTagName("head")[0],e.prototype={_each:function(t){var e,n=this._obj;for(e in n)n.hasOwnProperty(e)&&t(e,n[e]);return this}},n.prototype={api_server:"api.geetest.com",protocol:"http://",typePath:"/gettype.php",fallback_config:{slide:{static_servers:["static.geetest.com","dn-staticdown.qbox.me"],type:"slide",slide:"/static/js/geetest.0.0.0.js"},fullpage:{static_servers:["static.geetest.com","dn-staticdown.qbox.me"],type:"fullpage",fullpage:"/static/js/fullpage.0.0.0.js"}},_get_fallback_config:function(){var t=this;return s(t.type)?t.fallback_config[t.type]:t.new_captcha?t.fallback_config.fullpage:t.fallback_config.slide},_extend:function(t){var n=this;new e(t)._each(function(t,e){n[t]=e})}},r=function(t){return"number"==typeof t},s=function(t){return"string"==typeof t},l=function(t){return"boolean"==typeof t},c=function(t){return"object"===Object(S.a)(t)&&null!==t},d=function(t){return"function"==typeof t},u=/Mobi/i.test(navigator.userAgent),f=u?3:0,p={},h={},m=function(){var t=new Date,e=t.getFullYear(),n=1+t.getMonth(),i=t.getDate(),a=t.getHours(),o=t.getMinutes(),r=t.getSeconds();return 1<=n&&n<=9&&(n="0"+n),0<=i&&i<=9&&(i="0"+i),0<=a&&a<=9&&(a="0"+a),0<=o&&o<=9&&(o="0"+o),0<=r&&r<=9&&(r="0"+r),e+"-"+n+"-"+i+" "+a+":"+o+":"+r},_=function(){return parseInt(1e4*a.random())+(new Date).valueOf()},g=function(t,e){var n,a=i.createElement("script");a.charset="UTF-8",a.async=!0,a.onerror=function(){e(!0)},n=!1,a.onload=a.onreadystatechange=function(){n||a.readyState&&"loaded"!==a.readyState&&"complete"!==a.readyState||(n=!0,setTimeout(function(){e(!1)},0))},a.src=t,o.appendChild(a)},b=function(t){return t.replace(/^https?:\/\/|\/$/g,"")},v=function(t){return 0!=(t=t.replace(/\/+/g,"/")).indexOf("/")&&(t="/"+t),t},y=function(t){if(!t)return"";var n="?";return new e(t)._each(function(t,e){(s(e)||r(e)||l(e))&&(n=n+encodeURIComponent(t)+"="+encodeURIComponent(e)+"&")}),"?"===n&&(n=""),n.replace(/&$/,"")},w=function(t,e,n,i){e=b(e);var a=v(n)+y(i);return e&&(a=t+e+a),a},C=function(t,e,n,i,a,o,r){!function s(l){var c=w(n,i[l],a,o);g(c,function(o){if(o)if(l>=i.length-1){if(r(!0),e){t.error_code=508;var c=n+i[l]+a;k(t,c)}}else s(l+1);else r(!1)})}(0)},x=function(e,n,i,a){if(c(i.getLib))return i._extend(i.getLib),void a(i);if(i.offline)a(i._get_fallback_config());else{var o="geetest_"+_();t[o]=function(e){"success"==e.status?a(e.data):e.status?a(i._get_fallback_config()):a(e),t[o]=void 0;try{delete t[o]}catch(e){}},C(i,!0,i.protocol,e,n,{gt:i.gt,callback:o},function(t){t&&a(i._get_fallback_config())})}},k=function(t,e){C(t,!1,t.protocol,["monitor.geetest.com"],"/monitor/send",{time:m(),captcha_id:t.gt,challenge:t.challenge,pt:f,exception_url:e,error_code:t.error_code},function(t){})},A=function(t,e){var n={networkError:"ç½‘ç»œé”™è¯¯",gtTypeError:"gtå­—æ®µä¸æ˜¯å­—ç¬¦ä¸²ç±»åž‹"};if("function"!=typeof e.onError)throw Error(n[t]);e.onError(n[t])},function(){return t.Geetest||i.getElementById("gt_lib")}()&&(h.slide="loaded"),t.initGeetest=function(e,i){var a=new n(e);e.https?a.protocol="https://":e.protocol||(a.protocol=t.location.protocol+"//"),"050cffef4ae57b5d5e529fea9540b0d1"!==e.gt&&"3bd38408ae4af923ed36e13819b14d42"!==e.gt||(a.apiserver="yumchina.geetest.com/",a.api_server="yumchina.geetest.com"),c(e.getType)&&a._extend(e.getType),x([a.api_server||a.apiserver],a.typePath,a,function(e){var n,o=e.type,r=function(){a._extend(e),i(new t.Geetest(a))};p[o]=p[o]||[],"init"===(n=h[o]||"init")?(h[o]="loading",p[o].push(r),C(a,!0,a.protocol,e.static_servers||e.domains,e[o]||e.path,null,function(t){var e,n,i,r;if(t)h[o]="fail",A("networkError",a);else{for(h[o]="loaded",n=0,i=(e=p[o]).length;n<i;n+=1)r=e[n],d(r)&&r();p[o]=[]}})):"loaded"===n?r():"fail"===n?A("networkError",a):"loading"===n&&p[o].push(r)})}}(window),ea=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("router-view")},na=[],n("b763"),ia={name:"app",mounted:function(){}},aa=Object(b.a)(ia,ea,na,!1,null,null,null),oa=aa.exports,l.default.config.productionTip=!1,l.default.prototype.$http=Z.a,l.default.use(sn.a),l.default.component("icon",rn),window.Vue=l.default,window.Router=n("8c4f"),window.Vuex=n("2f62"),window.$http=Z.a,window.$router=Ye,window.$store=an,window.$=Ki.a,window.jQuery=Ki.a,window.plugins=[],window.NProgress=Zi.a,ra=["/admin/login","/admin/register","/admin/forget","/admin/reset"],Ye.beforeEach(function(t,e,n){Zi.a.start(),o()?"/admin/login"===t.path?n({path:"/admin/dashboard"}):0===an.getters.role.length?an.dispatch("GetInfo").then(function(e){an.dispatch("GenerateRoutes",e.data).then(function(){Ye.addRoutes(an.getters.addRouters),n(Object(s.a)({},t))})}).catch(function(t){r(),Ye.push({path:"/admin/login"})}):n():-1!=ra.indexOf(t.path)||"/admin/reset"===t.path.substr(0,8)?n():(n("/admin/login?to="+t.path),Zi.a.done())}),Ye.afterEach(function(t){document.title=t.name,Zi.a.done()}),l.default.config.errorHandler=function(t,e){ta.a.pushLog({err:t,url:window.location.href,vm:e})},window.bus=new l.default,new l.default({el:"#app",router:Ye,store:an,render:function(t){return t(oa)}});try{document.getElementById("progress").parentNode.removeChild(document.getElementById("progress"))}catch(t){}},"5d16":function(t,e,n){"use strict";function i(t){return Object(l.a)({url:"category",method:"post",data:t})}function a(t){return Object(l.a)({url:"category/edit",method:"post",data:t})}function o(t,e){return Object(l.a)({url:"category/enable",method:"post",data:{ids:t,enabled:e}})}function r(t,e){return Object(l.a)({url:"category/sort",method:"post",data:{id:t,sort:e}})}function s(t){return Object(l.a)({url:"category/delete",method:"post",data:{ids:t}})}n.d(e,"d",function(){return i}),n.d(e,"b",function(){return a}),n.d(e,"c",function(){return o}),n.d(e,"e",function(){return r}),n.d(e,"a",function(){return s});var l=n("41bb")},"61ef":function(t,e,n){"use strict";var i,a,o,r,s;n.r(e),i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div")},a=[],o={name:"lic"},r=n("2877"),s=Object(r.a)(o,i,a,!1,null,"0ceaeb36",null),e.default=s.exports},"683c":function(t,e,n){},"6a2a":function(t,e,n){"use strict";var i=n("a23f"),a=n.n(i);a.a},"6e02":function(t,e,n){},7296:function(t,e,n){"use strict";var i=n("16ae"),a=n.n(i);a.a},7413:function(t,e,n){"use strict";function i(t){return Object(u.a)({url:"card",method:"post",data:t})}function a(t){return Object(u.a)({url:"card/add",method:"post",data:t})}function o(t){return Object(u.a)({url:"card/edit",method:"post",data:t})}function r(t){return Object(u.a)({url:"card/delete",method:"post",data:{ids:t}})}function s(t){return Object(u.a)({url:"card/trash/restore",method:"post",data:{ids:t}})}function l(t){return Object(u.a)({url:"card/trash/restore/all",method:"post",data:t})}function c(t){return Object(u.a)({url:"card/trash/delete",method:"post",data:{ids:t}})}function d(t){return Object(u.a)({url:"card/delete/all",method:"post",data:t})}var u,f,p;n.d(e,"a",function(){return f}),n.d(e,"b",function(){return p}),n.d(e,"f",function(){return i}),n.d(e,"c",function(){return a}),n.d(e,"e",function(){return o}),n.d(e,"g",function(){return r}),n.d(e,"i",function(){return s}),n.d(e,"j",function(){return l}),n.d(e,"h",function(){return c}),n.d(e,"d",function(){return d}),u=n("41bb"),f={STATUS_NORMAL:0,STATUS_SOLD:1,STATUS_USED:2},p={TYPE_ONETIME:0,TYPE_REPEAT:1}},7431:function(t,e,n){"use strict";var i=n("e47d"),a=n.n(i);a.a},"7b74":function(t,e,n){"use strict";var i=n("f1d7"),a=n.n(i);a.a},"7c46":function(t,e,n){"use strict";var i=n("37f2"),a=n.n(i);a.a},"7ded":function(t,e,n){"use strict";function i(t){return Object(l.a)({url:"login",method:"post",data:t})}function a(){return Object(l.a)({url:"login/verify",method:"post"})}function o(t){return Object(l.a)({url:"login/password",method:"post",data:t})}function r(){return Object(l.a)({url:"login/info",method:"post"})}function s(){return Object(l.a)({url:"login/logout",method:"post"})}n.d(e,"d",function(){return i}),n.d(e,"c",function(){return a}),n.d(e,"a",function(){return o}),n.d(e,"b",function(){return r}),n.d(e,"e",function(){return s});var l=n("41bb")},"815e":function(t,e,n){"use strict";var i=n("24fd"),a=n.n(i);a.a},8180:function(t,e,n){"use strict";var i=n("f432"),a=n.n(i);a.a},8288:function(t,e,n){},"86c8":function(t,e,n){"use strict";var i=n("a902"),a=n.n(i);a.a},"8a74":function(t,e,n){"use strict";var i=n("e691"),a=n.n(i);a.a},"8b01":function(t,e,n){"use strict";function i(t){return null==t?0:parseInt(t)!==t?t:(t/100).toFixed(2)}var a;n.d(e,"a",function(){return i}),n("a481"),(a=n("a026")).default.filter("moneyFilter",i),a.default.filter("moneyFormatterFilter",function(t){return null==t?"￥0.00":-1==(t+"").indexOf(".")?t:"￥"+t}),a.default.filter("moneyDigitalFilter",function(t){return null==t?"0.00":-1==(t+"").indexOf(".")?t:t.replace(/\d(?=(?:\d{3})+\b)/g,"$&,")}),a.default.filter("formatDate",function(t){return new Date(t).format("yyyy-MM-dd")})},"8bdc":function(t,e,n){},"8e3f":function(t,e,n){},"8e5f":function(t,e,n){},"97b6":function(t,e,n){},"9a0c":function(t,e,n){"use strict";var i,a,o,r,s;n.r(e),i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",{staticClass:"app-main"},[n("transition",{attrs:{name:"fade",mode:"out-in"}},[n("router-view",{key:t.key})],1)],1)},a=[],n("7f7f"),o={name:"AppMain",computed:{key:function(){return void 0!==this.$route.name?this.$route.name+ +new Date:this.$route+ +new Date}}},r=n("2877"),s=Object(r.a)(o,i,a,!1,null,null,null),e.default=s.exports},a01f:function(t,e,n){"use strict";var i=n("f3e3"),a=n.n(i);a.a},a23f:function(t,e,n){},a791:function(t,e,n){},a7ee:function(t,e,n){"use strict";var i=n("a791"),a=n.n(i);a.a},a80e:function(t,e,n){"use strict";n("4917"),e.a={isDesktop:function(){return 993<window.innerWidth},detectOs:function(){var t=null;return/NT 5./i.test(navigator.userAgent)?t=/wow64|win64|ia64|x64/i.test(navigator.userAgent)?"xp-64":"xp-32":/NT 6.|NT 7.|NT 8.|NT 9.|NT 10./i.test(navigator.userAgent)?t=/wow64|win64|ia64|x64/i.test(navigator.userAgent)?"vista-64":"vista-32":/iPhone|iPad|iPod/i.test(navigator.userAgent)?t="ios":/Android/i.test(navigator.userAgent)?t="android":/Macintosh/i.test(navigator.userAgent)&&(t="osx"),t},isMobile:function(){return null!==navigator.userAgent.match(/(iPhone|iPod|Android|ios|SymbianOS)/i)},isQQ:function(){return/ QQ\//i.test(navigator.userAgent)},isWechat:function(){return/MicroMessenger/i.test(navigator.userAgent)}}},a902:function(t,e,n){},aaec:function(t,e,n){},ad2b:function(t,e,n){"use strict";var i=n("5286"),a=n.n(i);a.a},b130:function(t,e,n){"use strict";function i(t){var e,n,i,a;for(t=t||16,n=(e="ABCDEFGHJKMNPQRSTWXYZabcdefhijkmnprstwxyz2345678").length,i="",a=0;a<t;a++)i+=e.charAt(Math.floor(Math.random()*n));return i}function a(t){var e,n=1<arguments.length&&void 0!==arguments[1]&&arguments[1];if(!t||"{"!==t[0])return t;e=null;try{e=JSON.parse(t)}catch(e){return t}if(n){if(!e.ops||!e.ops.length)return!1;if(1===e.ops.length&&"\n"===e.ops[0].insert)return!1}return'<div class="ql-snow"><div class="ql-editor quill-html">'.concat(new l.QuillDeltaToHtmlConverter(e.ops,{urlSanitizer:function(t){var e=t;return e=e.replace(/^\s*/gm,""),/^((https?|s?ftp|blob|mailto|tel|mqqapi):|#|\/|data:image\/)/.test(e)?e:"unsafe:"+e}}).convert(),"</div></div>")}function o(t){var e=document.createElement("div"),n=document.createTextNode(t);return e.appendChild(n),e.innerHTML.replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function r(){var t,e,n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},i=1<arguments.length&&void 0!==arguments[1]&&arguments[1],a=[];for(t in n)n.hasOwnProperty(t)&&(n[t]&&"object"===Object(s.a)(n[t])?a.push(r(n[t],t)):(e=encodeURIComponent(null===n[t]||void 0===n[t]?"":n[t]),t=!1===i?encodeURIComponent(t):encodeURIComponent(i)+"["+encodeURIComponent(t)+"]",a.push(t+"="+e)));return a.join("&")}var s,l;n.d(e,"c",function(){return i}),n.d(e,"d",function(){return a}),n.d(e,"a",function(){return o}),n.d(e,"b",function(){return r}),s=n("7618"),n("28a5"),n("3b2b"),n("a481"),l=n("ff81"),n("a80e"),window.nullfunc=console.log,Date.prototype.format=function(t){var e,n;for(n in t||(t="yyyy-MM-dd hh:mm:ss"),e={"M+":1+this.getMonth(),"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((3+this.getMonth())/3),S:this.getMilliseconds()},/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length))),e)RegExp("("+n+")").test(t)&&(t=t.replace(RegExp.$1,1===RegExp.$1.length?e[n]:("00"+e[n]).substr((""+e[n]).length)));return t},String.prototype.random=i},b3db:function(t,e,n){"use strict";var i=n("24e6"),a=n.n(i);a.a},b763:function(t,e,n){},bd60:function(t,e,n){"use strict";var i,a,o,r=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"quill-editor",class:{"quill-editor_disabled":t.disabled}},[i("div",{attrs:{id:t.id_toolbar}},[t._m(0),t._m(1),t._m(2),i("span",{staticClass:"ql-formats"},[i("button",{staticClass:"ql-image",attrs:{title:"插入图片"}}),i("button",{staticClass:"ql-link",attrs:{title:"插入链接"}}),i("button",{staticClass:"ql-qq_group",attrs:{title:"插入QQ群"},on:{click:t.handleInsertQQGroup}},[i("img",{attrs:{width:"16",src:n("3889")}})])])]),i("div",{attrs:{id:t.id_editor}}),t.showUpload?i("div",{staticClass:"v-modal",staticStyle:{"z-index":"1010"},on:{click:function(e){t.showUpload=!1}}}):t._e(),t.showUpload?i("div",{ref:"upload_wrapper",staticClass:"el-message-box__wrapper",staticStyle:{"z-index":"1011"},on:{click:t.onUploadClose}},[i("div",{staticClass:"upload-box"},[i("el-radio",{attrs:{label:"upload"},model:{value:t.upload.type,callback:function(e){t.$set(t.upload,"type",e)},expression:"upload.type"}},[t._v("手动上传")]),i("el-radio",{attrs:{label:"input"},model:{value:t.upload.type,callback:function(e){t.$set(t.upload,"type",e)},expression:"upload.type"}},[t._v("网络图片")]),i("el-upload",{directives:[{name:"show",rawName:"v-show",value:"upload"===t.upload.type,expression:"upload.type === 'upload'"}],attrs:{drag:"","list-type":"picture",action:t.upload_url,multiple:!1,data:{user_id:t.userInfo_?t.userInfo_.id:""},headers:{"X-Requested-With":"XMLHttpRequest"},limit:1,"with-credentials":!0,"on-error":t.handleUploadError,"on-change":t.handleUploadChange}},[i("i",{staticClass:"el-icon-upload"}),i("div",{staticClass:"el-upload__text"},[t._v("将文件拖到此处，或"),i("em",[t._v("点击上传")]),i("div",{staticStyle:{"font-size":"12px"}},[t._v("只能上传图片文件，且不超过5MB")])])]),i("el-input",{directives:[{name:"show",rawName:"v-show",value:"input"===t.upload.type,expression:"upload.type === 'input'"}],attrs:{type:"text",placeholder:"请输入图片URL地址"},model:{value:t.upload.manual,callback:function(e){t.$set(t.upload,"manual",e)},expression:"upload.manual"}},[i("el-button",{attrs:{slot:"append",type:"text"},on:{click:t.handleUploadInputUrl},slot:"append"},[t._v("确定")])],1)],1)]):t._e()])},s=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("span",{staticClass:"ql-formats"},[n("select",{staticClass:"ql-size",attrs:{title:"字体"}},[n("option",{attrs:{value:"small"}},[t._v("小号")]),n("option",{attrs:{selected:""}},[t._v("普通")]),n("option",{attrs:{value:"large"}},[t._v("大号")]),n("option",{attrs:{value:"huge"}},[t._v("超大")])]),n("button",{staticClass:"ql-bold",attrs:{title:"加粗"}}),n("button",{staticClass:"ql-italic",attrs:{title:"倾斜"}})])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("span",{staticClass:"ql-formats"},[n("select",{staticClass:"ql-color",attrs:{title:"颜色"}}),n("select",{staticClass:"ql-background",attrs:{title:"背景色"}})])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("span",{staticClass:"ql-formats"},[n("button",{staticClass:"ql-list",attrs:{value:"ordered",title:"序号列表"}}),n("button",{staticClass:"ql-list",attrs:{value:"bullet",title:"列表"}}),n("select",{staticClass:"ql-align",attrs:{title:"布局"}},[n("option",{attrs:{selected:""}}),n("option",{attrs:{value:"center"}}),n("option",{attrs:{value:"right"}}),n("option",{attrs:{value:"justify"}})])])}],l=(n("f559"),n("9339")),c=n.n(l),d=n("b130");c.a.imports["formats/link"].PROTOCOL_WHITELIST.push("mqqapi"),i={name:"QuillEditor",props:{value:{default:""},placeholder:{default:"请输入内容"},disabled:{default:!1},theme:{default:"snow"},userInfo:{},upload_url:{default:window.API_HOST+"file/upload"}},data:function(){var t=Object(d.c)(8);return{userInfo_:null,id_editor:"editor-"+t,id_toolbar:"editor-toolbar-"+t,quill_editor:null,showUpload:!1,upload:{type:"upload",manual:""}}},watch:{disabled:function(){this.quill_editor&&(this.disabled?this.quill_editor.disable():this.quill_editor.enable())}},mounted:function(){var t=this;this.userInfo?this.userInfo_=this.userInfo:this.userInfo_=this.$store.state.user.userInfo,this.quill_editor=new c.a("#"+this.id_editor,{modules:{toolbar:"#"+this.id_toolbar},placeholder:this.placeholder,theme:this.theme}),this.quill_editor.on("editor-change",function(e){"text-change"===e&&t.$emit("change",arguments.length<=1?void 0:arguments[1])}),this.quill_editor.getModule("toolbar").addHandler("image",function(){if(!t.disabled){var e=t.quill_editor.getSelection();t.showUpload=!0,t.upload.manual="",t.uploadSuccess=function(n){t.quill_editor.insertEmbed(e.index,"image",n,"user")}}}),this.setValue(this.value)},beforeDestroy:function(){this.quill_editor=null},methods:{onUploadClose:function(t){t.target===this.$refs.upload_wrapper&&(this.showUpload=!1)},handleUploadChange:function(t,e){if(0<e.length&&e[0].response){var n=e[0].response;if(!n.data)return this.$msgbox({message:n,title:"错误",type:"error"});if(!n.data.url)return this.showUpload=!1,this.$message({message:n.msg,type:"error"});this.uploadSuccess(n.data.url),this.showUpload=!1}},handleUploadError:function(t,e,n){try{var i=JSON.parse(t.message).message;if(i)return this.$message({message:i,type:"error"})}catch(t){this.$message({message:"文件上传失败，请检查文件大小和格式",type:"error"})}},handleUploadInputUrl:function(){this.upload.manual=this.upload.manual.trim(),this.upload.manual.startsWith("http://")||this.upload.manual.startsWith("https://")||this.upload.manual.startsWith("ftp://")?(this.uploadSuccess(this.upload.manual),this.showUpload=!1):this.$alert("请输入合法的图片URL地址")},handleInsertQQGroup:function(t){var e,n=this;this.disabled||(this.quill_editor.focus(),(e=this.quill_editor.getSelection())&&this.$prompt("请输入加群链接<br>获取方式: <br>手机QQ - 选择QQ群 - 右上角菜单 - 分享群聊 - 复制链接","插入QQ群加群按钮",{confirmButtonText:"确定",cancelButtonText:"取消",inputPlaceholder:"https://jq.qq.com/?_wv=1027&k=xxxx",inputPattern:/https?:\/\/.+/,inputErrorMessage:"请输入正确的加群链接",closeOnClickModal:!1,dangerouslyUseHTMLString:!0}).then(function(t){var i=t.value,a=c.a.import("delta"),o=(new a).retain(e.index).insert({image:"//pub.idqqimg.com/wpa/images/group.png"},{alt:i,link:i});n.quill_editor.updateContents(o,"user")}).finally(function(){n.quill_editor.blur()}))},getValue:function(){return JSON.stringify(this.quill_editor.getContents())},setValue:function(t){t&&"{"===t[0]?this.quill_editor.setContents(JSON.parse(t)):this.quill_editor.setText(t||"")}}},n("0cae"),a=n("2877"),o=Object(a.a)(i,r,s,!1,null,null,null),e.a=o.exports},be65:function(t,e,n){},bf48:function(t,e,n){t.exports=n.p+"img/404_cloud.0f4bc32b.png"},c343:function(t,e,n){"use strict";var i=n("683c"),a=n.n(i);a.a},c449:function(t,e,n){"use strict";var i=n("97b6"),a=n.n(i);a.a},c8a6:function(t,e,n){"use strict";var i=n("050b"),a=n.n(i);a.a},caed:function(t,e,n){"use strict";var i,a,o,r,s,l,c,d,u,f,p,h,m,_,g,b,v,y,w,C,x;n.r(e),i=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("el-menu",{staticClass:"navbar",attrs:{mode:"horizontal"}},[i("hamburger",{staticClass:"hamburger-container",attrs:{toggleClick:t.toggleSideBar,isActive:t.sidebar.opened}}),i("level-bar"),i("nav-tabs"),0<t.log.length?i("error-log",{staticClass:"errLog-container",attrs:{logsList:t.log}}):t._e(),i("el-dropdown",{staticClass:"avatar-container",attrs:{trigger:"click","show-timeout":0,"hide-timeout":0}},[i("div",{staticClass:"avatar-wrapper"},[i("img",{staticClass:"user-avatar",attrs:{src:n("eabc")}}),i("i",{staticClass:"el-icon-caret-bottom"})]),i("el-dropdown-menu",{staticClass:"user-dropdown",attrs:{slot:"dropdown"},slot:"dropdown"},[i("router-link",{staticClass:"inlineBlock",attrs:{to:"/admin/system/set"}},[i("el-dropdown-item",[t._v("网站设置")])],1),i("router-link",{staticClass:"inlineBlock",attrs:{to:"/admin/system/security"}},[i("el-dropdown-item",[t._v("修改密码")])],1),i("el-dropdown-item",{attrs:{divided:""}},[i("span",{staticStyle:{display:"block"},on:{click:t.logout}},[t._v("退出")])])],1)],1)],1)},a=[],o=n("cebc"),r=n("2f62"),s=n("057a"),l=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{directives:[{name:"show",rawName:"v-show",value:t.showTabs,expression:"showTabs"}],staticClass:"tabs-view-container"},t._l(t.visitedViews,function(e){return n("router-link",{key:e.path,staticClass:"tabs-view",attrs:{to:e.path}},[n("el-tag",{attrs:{closable:!0,type:t.isActive(e.path)?"primary":""},on:{close:function(n){return t.closeViewTabs(e,n)},click:function(n){return n.preventDefault(),t.$router.push(e.path)}}},[t._v("\n      "+t._s(e.name)+"\n    ")])],1)}),1)},c=[],n("7f7f"),d={data:function(){return{availableWidth:999,takeCount:6,showTabs:!this.$store.state.app.isMobile}},computed:{visitedViews:function(){return this.$store.state.app.visitedViews.slice(-this.takeCount)}},watch:{$route:function(t,e){0===this.visitedViews.length&&this.addViewTabs(e),this.addViewTabs()}},methods:{closeViewTabs:function(t,e){if(0<this.visitedViews.length){var n=this.visitedViews.indexOf(t);0<n?this.$router.push(this.visitedViews[n-1]):this.$router.push(this.visitedViews[this.visitedViews.length-1])}this.$store.dispatch("delVisitedViews",t),e.preventDefault()},generateRoute:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null;return t.matched[t.matched.length-1].name?t.matched[t.matched.length-1]:(t.matched[0].path="/",t.matched[0])},addViewTabs:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null;this.$store.dispatch("addVisitedViews",this.generateRoute(t||this.$route))},isActive:function(t){return t===this.$route.path},calcAvailableWidth:function(){var t=$(".navbar")[0],e=$(".hamburger-container")[0],n=$(".app-levelbar")[0],i=e.offsetWidth+n.offsetWidth+120;this.availableWidth=t.clientWidth-i,this.takeCount=parseInt(this.availableWidth/100)},resizeHandler:function(){this.calcAvailableWidth()}},mounted:function(){window.addEventListener("resize",this.resizeHandler);var t=document.getElementById("sidebar-container");t&&t.addEventListener("transitionend",this.resizeHandler)},beforeDestroy:function(){window.removeEventListener("resize",this.resizeHandler);var t=document.getElementById("sidebar-container");t&&t.removeEventListener("transitionend",this.resizeHandler)}},n("b3db"),u=n("2877"),f=Object(u.a)(d,l,c,!1,null,null,null).exports,p=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("svg",{staticClass:"svg-icon hamburger",class:{"is-active":t.isActive},attrs:{t:"1492500959545",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"1691","xmlns:xlink":"http://www.w3.org/1999/xlink",width:"64",height:"64"},on:{click:t.toggleClick}},[n("path",{attrs:{d:"M966.8023 568.849776 57.196677 568.849776c-31.397081 0-56.850799-25.452695-56.850799-56.850799l0 0c0-31.397081 25.452695-56.849776 56.850799-56.849776l909.605623 0c31.397081 0 56.849776 25.452695 56.849776 56.849776l0 0C1023.653099 543.397081 998.200404 568.849776 966.8023 568.849776z","p-id":"1692"}}),n("path",{attrs:{d:"M966.8023 881.527125 57.196677 881.527125c-31.397081 0-56.850799-25.452695-56.850799-56.849776l0 0c0-31.397081 25.452695-56.849776 56.850799-56.849776l909.605623 0c31.397081 0 56.849776 25.452695 56.849776 56.849776l0 0C1023.653099 856.07443 998.200404 881.527125 966.8023 881.527125z","p-id":"1693"}}),n("path",{attrs:{d:"M966.8023 256.17345 57.196677 256.17345c-31.397081 0-56.850799-25.452695-56.850799-56.849776l0 0c0-31.397081 25.452695-56.850799 56.850799-56.850799l909.605623 0c31.397081 0 56.849776 25.452695 56.849776 56.850799l0 0C1023.653099 230.720755 998.200404 256.17345 966.8023 256.17345z","p-id":"1694"}})])])},m={name:"hamburger",props:{isActive:{type:Boolean,default:!(h=[])},toggleClick:{type:Function,default:null}}},n("c343"),_=Object(u.a)(m,p,h,!1,null,"1286de0b",null).exports,g=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("el-badge",{staticStyle:{"line-height":"30px"},attrs:{"is-dot":!0},nativeOn:{click:function(e){t.dialogTableVisible=!0}}},[n("el-button",{attrs:{size:"small",type:"primary"}},[n("svg",{staticClass:"bug-svg",attrs:{t:"1492682037685",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"1863","xmlns:xlink":"http://www.w3.org/1999/xlink",width:"64",height:"64"}},[n("path",{attrs:{d:"M969.142857 548.571429q0 14.848-10.861714 25.709714t-25.709714 10.861714l-128 0q0 97.718857-38.290286 165.705143l118.857143 119.442286q10.861714 10.861714 10.861714 25.709714t-10.861714 25.709714q-10.276571 10.861714-25.709714 10.861714t-25.709714-10.861714l-113.152-112.566857q-2.852571 2.852571-8.557714 7.424t-23.990857 16.274286-37.156571 20.845714-46.848 16.566857-55.442286 7.424l0-512-73.142857 0 0 512q-29.147429 0-58.002286-7.716571t-49.700571-18.870857-37.705143-22.272-24.868571-18.578286l-8.557714-8.009143-104.557714 118.272q-11.446857 11.995429-27.428571 11.995429-13.714286 0-24.576-9.142857-10.861714-10.276571-11.702857-25.417143t8.850286-26.587429l115.419429-129.718857q-33.133714-65.133714-33.133714-156.562286l-128 0q-14.848 0-25.709714-10.861714t-10.861714-25.709714 10.861714-25.709714 25.709714-10.861714l128 0 0-168.009143-98.852571-98.852571q-10.861714-10.861714-10.861714-25.709714t10.861714-25.709714 25.709714-10.861714 25.709714 10.861714l98.852571 98.852571 482.304 0 98.852571-98.852571q10.861714-10.861714 25.709714-10.861714t25.709714 10.861714 10.861714 25.709714-10.861714 25.709714l-98.852571 98.852571 0 168.009143 128 0q14.848 0 25.709714 10.861714t10.861714 25.709714zM694.857143 219.428571l-365.714286 0q0-75.995429 53.430857-129.426286t129.426286-53.430857 129.426286 53.430857 53.430857 129.426286z","p-id":"1864"}})])])],1),n("el-dialog",{attrs:{title:"bug日志",visible:t.dialogTableVisible},on:{"update:visible":function(e){t.dialogTableVisible=e}}},[n("el-table",{attrs:{data:t.logsList}},[n("el-table-column",{attrs:{label:"message"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("div",[t._v("msg:"+t._s(e.row.err.message))]),n("div",[t._v("url: "+t._s(e.row.url))])]}}])}),n("el-table-column",{attrs:{label:"stack"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n          "+t._s(e.row.err.stack)+"\n        ")]}}])})],1)],1)],1)},b=[],v={name:"errLog",props:{logsList:{type:Array}},data:function(){return{dialogTableVisible:!1}}},n("6a2a"),y=Object(u.a)(v,g,b,!1,null,"9ff5e3e4",null).exports,w=n("38e1"),C={components:{LevelBar:s.default,NavTabs:f,Hamburger:_,ErrorLog:y},data:function(){return{log:w.a.state.errLog}},computed:Object(o.a)({},Object(r.mapGetters)(["sidebar"])),methods:{toggleSideBar:function(){this.$store.dispatch("ToggleSideBar")},logout:function(){this.$store.dispatch("Logout").then(function(){location.reload()})}}},n("7296"),x=Object(u.a)(C,i,a,!1,null,"374ded6c",null),e.default=x.exports},cb71:function(t,e,n){"use strict";var i=n("be65"),a=n.n(i);a.a},d9ce:function(t,e,n){"use strict";var i,a,o,r,s,l,c,d,u,f,p,h,m,_,g,b;n.r(e),i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"app-wrapper",class:{hideSidebar:!t.sidebarOpen,showSidebar:t.sidebarOpen}},[n("sidebar",{ref:"side-bar",staticClass:"sidebar-container",attrs:{id:"sidebar-container"},on:{transitionend:t.resizeHandler}}),n("div",{staticClass:"main-container"},[n("div",{style:{width:t.mainWidth}},[n("navbar",{ref:"nav-bar"}),n("app-main")],1)]),n("lic")],1)},a=[],o=n("caed"),r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("el-menu",{attrs:{mode:"vertical","default-active":t.$route.path,collapse:t.isCollapse}},[n("item",{attrs:{routes:t.permission_routers}})],1)],1)},s=[],l=n("cebc"),c=n("2f62"),d=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"menu-wrapper"},[t._l(t.routes,function(e){return[!e.hidden&&e.noDropdown&&0<e.children.length?n("router-link",{attrs:{to:e.path+"/"+e.children[0].path}},[n("el-menu-item",{staticClass:"submenu-title-noDropdown",attrs:{index:e.path+"/"+e.children[0].path}},[e.icon?n("icon",{attrs:{name:e.icon}}):t._e(),n("span",{staticClass:"menu-title"},[t._v(t._s(e.children[0].name))])],1)],1):t._e(),e.noDropdown||e.hidden?t._e():n("el-submenu",{attrs:{index:e.name}},[n("template",{slot:"title"},[e.icon?n("icon",{attrs:{name:e.icon}}):t._e(),n("span",{staticClass:"menu-title"},[t._v(t._s(e.name))])],1),t._l(e.children,function(i){return i.hidden?t._e():[i.children&&0<i.children.length?n("item",{staticClass:"nest-menu",attrs:{routes:[i]}}):n("router-link",{attrs:{to:e.path+"/"+i.path}},[i.hide?t._e():n("el-menu-item",{attrs:{index:e.path+"/"+i.path}},[i.icon?n("icon",{attrs:{name:i.icon}}):t._e(),n("span",{staticClass:"menu-title"},[t._v(t._s(i.name))])],1)],1)]})],2)]})],2)},u=[],f={name:"item",props:{routes:{type:Array}}},n("cb71"),p=n("2877"),h={components:{item:Object(p.a)(f,d,u,!1,null,"640a5037",null).exports},computed:Object(l.a)({},Object(c.mapGetters)(["permission_routers","sidebar"]),{isCollapse:function(){return!this.sidebar.opened}})},n("3370"),n("7c46"),m=Object(p.a)(h,r,s,!1,null,"7dba3c74",null).exports,n("057a"),_=n("9a0c"),g={name:"layout",components:{Lic:n("61ef").default,Navbar:o.default,Sidebar:m,AppMain:_.default},data:function(){return{mainWidth:"auto"}},computed:{sidebarOpen:function(){return this.$store.state.app.sidebar.opened}},watch:{sidebarOpen:function(){this.resizeHandler({type:"sidebarOpen",propertyName:"width"})}},mounted:function(){this.reCalcMainWidth(),window.addEventListener("resize",this.resizeHandler)},beforeDestroy:function(){window.removeEventListener("resize",this.resizeHandler)},methods:{resizeHandler:function(t){!t||"resize"!==t.type&&"width"!==t.propertyName||(this.reCalcMainWidth(),window.bus.$emit("app-resize"))},reCalcMainWidth:function(){this.$store.state.app.isMobile&&document.body.clientWidth!==this.oldClientWidth&&(this.oldClientWidth=document.body.clientWidth,this.mainWidth=document.body.clientWidth-this.$refs["side-bar"].$el.clientWidth+"px")}}},n("ffff"),b=Object(p.a)(g,i,a,!1,null,"01f5b9ce",null),e.default=b.exports},e47d:function(t,e,n){},e691:function(t,e,n){},ea43:function(t,e,n){"use strict";var i=n("54aa"),a=n.n(i);a.a},eabc:function(t,e){t.exports="data:image/png;base64,/9j/4QAYRXhpZgAASUkqAAgAAAAAAAAAAAAAAP/sABFEdWNreQABAAQAAAA8AAD/4QNxaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLwA8P3hwYWNrZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI/PiA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJBZG9iZSBYTVAgQ29yZSA1LjMtYzAxMSA2Ni4xNDU2NjEsIDIwMTIvMDIvMDYtMTQ6NTY6MjcgICAgICAgICI+IDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+IDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ9InhtcC5kaWQ6NkYxNDI1RjU0MjIwNjgxMTgwODM4RjQyOEIzQ0M4MUUiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6MDY1QzI5QzczQUVDMTFFNEIzM0U4Q0I5MkNEOTVGMkMiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6MDY1QzI5QzYzQUVDMTFFNEIzM0U4Q0I5MkNEOTVGMkMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoTWFjaW50b3NoKSI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkJDRTc1MDAyMzEyMDY4MTE4MDgzOUE3MjIxRTIwQTNGIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjZGMTQyNUY1NDIyMDY4MTE4MDgzOEY0MjhCM0NDODFFIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+/+4ADkFkb2JlAGTAAAAAAf/bAIQABgQEBAUEBgUFBgkGBQYJCwgGBggLDAoKCwoKDBAMDAwMDAwQDA4PEA8ODBMTFBQTExwbGxscHx8fHx8fHx8fHwEHBwcNDA0YEBAYGhURFRofHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8f/8AAEQgAeAB4AwERAAIRAQMRAf/EAJYAAQACAwEBAQAAAAAAAAAAAAAEBQMGBwIIAQEBAAIDAQAAAAAAAAAAAAAAAAMFAQIEBhAAAgIBAgMGAgUHDQEAAAAAAQIAAwQRBSESBjFBUWETB3GBsSIyFAiRodFSkqKzwUJicrLCI1M0ZHQVFjYRAQACAgEDBAIDAQEAAAAAAAABAhEDBCExQVESEwVhMnGBFCJC/9oADAMBAAIRAxEAPwDqM63AQEBAQEBAQEBAQEBAQEBAQEBAQECj3nrbpfZ3avOz61vXtor1ssB8CqBuX5yO2ysd0tNF7doa9Z7z9Jq3KtOY4/WWuvT96wGafPVN/iv+E/bvdTo3McIcpsV27BkIUHzYcyj5mbRurLS3EvHhtVF9F9S3UWLbU41SxCGUjxBHAyTLnmMMkyEBAQEBAQEBA8XXVUVPdc4rqrUtZYx0VVA1JJMwRGXGOt/dLO3K2zB2axsXbhqrXrqtt3nr2ovl2+PhOTZumekLTRxYr1t3c/JJOp7ZA7CAgXPTnVm9dP5ItwLz6ROtuK+pqcea+PmOM3pea9kWzTW8dXduk+rNu6k2771i/wCHdXouTjMdWrY/Sp7jO2l4tCp3aZpOJXc3REBAQEBAQEDlfvH1VYpr6exX0DAW55B7QeNdZ/tH5Tl338LDh6v/AFLUejfbvqDqpy+Iq0YFbctubdqEB71UDi7fD5kTivsiqzpSbOk434fNnWsDJ3bIss72rRK11+Dep9MgnkT6JfghEy/w9IbVOHvRWon6wuo5mA8QVdQfyCZjkfgnR+WZfw9YPJo29Wl/1hQoH5Oc/TH+j8HwflRb/wCw/UGFS9+1Zde5qg1NJX0biP6IJdW/aE3ryInu1tpnw0zpjfc7pjqBMkq6emxqzsZgVYpro6Mp7GHaPOdWu+Jy5N2r31w+i6Lqr6a76WD1WqHrcdhVhqCPiJ3qSYw9zIQEBAQEBA+ctw+9dSdZ3JUea7ccz0qSeOis/Imvkq6St2W6zK900xWIfUGz7Vh7TteNtuGnJjYtYrrHedO1j5seJ85WWnM5WMRiEyYZICAgfP8A78bZXjdW0ZlahRnYytYR32VsUJ/Z5Z2aJzVy7o6t09rNxfN6NxA55nxWfHJ8kOqD5IwEtdM5qouVXF5bbJXOQEBAQEBA4h7LbeMzr3HtYcww6rsltfHl9MH5NYJT75/5ek1R/wBO/wCXv2x4eQMbL3HFxslvs023Vo518FYgzjisz4dWYTUdXUOhDKw1VgdQQfAzVl6gIFfd1BsFGSMW7csWrKJ0FD31rYT4cpbWbe2fRjMOWfiGxwa9jyQOw5FbH4itl+gyfjT3Q7/DJ7Kk/wDlcryzrP4NUtuP+qj5v7x/DoEncZAQEBAQEDlf4fKA2+brkaca8ZKwf69gP9yUnI7PTae7ptntt0PazvdtNd1lhLWW2NY9jMeJJdmLEn4yD5beqb2Q97T0Js+zZS3bPdlYFQOr4dd7Pjv4hq7vVHHxXQ+Bidkz3ZikR2bHI2yo3zpzH3rlry8vLrxANHxMe30a7PNygFh+HPp5TatsNZrlWVe13QNVfIuzUkeLtY7ftMxM2+a3qx8dWne+O1YuD0htFOIhTGxcv0qkZmflV63bl5nLNoOXhx4SXRObSj3R0Y/ZT/5XK/51n8GqW3H/AFUfN/eP4dAk7jICAgICBmxKBdbyE6KBqfhOfk7vjrl08TR8t8T2UnQfQ+z9M7huT7ZlXX1ZS1ryXBdU9Mt2OvLza836spr7JtHV6Our29U73Dweqs3px6embmp3H1ULcjip2qGvMqWErynXQ9o4TGuYiepeJx0T+ksbe8bpzBo3y3191SsjJs15tTzEqCw+0QugJ7zNbzGenZmucdVqzounMwHMdF1Omp8BNWz1A0LoDafcXD3zdLepss34FgIx1NosVrOcEPUoJ9NOXX6vDu4SbZNZiMIqRbPVb+4HS+J1JslWFlZD41VWQl/qVqHYlVZNNCQP580139s5b2p7ujDsPSe09ObPXjbW9llFjmyyy0gu1jAAsdAoHBNNAJZ8Lf7s1lT/AGXH9uLf0mywVRAQEBAQJW2sq5HE6cykD46gzi51ZnX08S7/AK28Rs6+Yfu1Y19GRaLEIGmgbTgePcZTvRWlaTDUgQ9xOn3U/wC4r/PqIITICBD3Wux8TlRSzcw4AamGao1iGnb6aX4WalivlxP8ssPr6z7pnxhV/a3j2xHnKLLZRkBAQEBATAnbda7XFXYn6vAE698r+driKZiPK1+u22m8xMzPRYyqXRAwtiUNaLGUllPMurNoD48uukDNAQIu42MlK8rFWLcCDoeydnBpFrzmOmFf9jsmtIxOJyq2ZmOrEk+JlzERHSFDa0zOZfkywQEBAQEBA91WNXYrr2qZHspF6zEpNWyaWi0eFzValqB1OoMoNmuaTiXp9W2L190MeZTkW1aUWmqwd/cfjNEisO270T/q/wB9/wBEyzlMwcTNpYtkZBtGnBO0fMnjMCaSANTwA7TMxGWszjrKpzMj1reH2F4L+mXfF0fHXr3l53m8n5b9P1hHnU4yAgICAgICAgZcfJsobVeKn7S+Mg36K7I693Rx+TbVOY7ei1oyKrl1Q8e9e8Sl26ba5xL0GjkV2RmrLIk7xZYla8znQTemubTiGmzZWkZtOIVmVmtd9Vfq1+HefjLfj8WKdZ62UPK5s7OkdKo07HCQEBAQEBAQEBAQPNhsVfUr1BQglh3a8Jxc6uaf2s/qrY2THrB/2mfpp6v5l/RKfD0Pth+JbbYTZaxYk8oJ8uOgln9fXvKk+3t+sfy9yyUxAQEBAQEBAQEASANTwA7TA13cuorC7VYf1UHA3dpPwktdfqitf0WfQ+Xh5Fe67fm5S05OclRxr720XmqcsULHs5tROfmaZvTEOz6/fGvZmV3/AOR308UpR6/8xba+XTx+1KX/ADX9Ho45ur1VfWRwsHYMXavvFV+5HKOTcKWDipfTKcpYd54GW3A02pE5UX2fJrstGPDWMLe87GIBc2196OdfyHtE7ppEqyLTDZsDcKM2rnqOhH20PaDIbVwlicpMwyQEBAQEBAQKXqPcDVUMSs/XsGthHcvh85Jrr5R3nw1qTIyAgICBIwM2zDyVuTiBwdfFe8TFozDMThulVqW1LbWdUcAqfIzmmEz3DJAQP//Z"},f1d7:function(t,e,n){},f3e3:function(t,e,n){},f432:function(t,e,n){},f65e:function(t,e,n){},fca0:function(t,e,n){"use strict";var i=n("8e5f"),a=n.n(i);a.a},ffb9:function(t,e,n){"use strict";var i=n("6e02"),a=n.n(i);a.a},ffff:function(t,e,n){"use strict";var i=n("8e3f"),a=n.n(i);a.a}});