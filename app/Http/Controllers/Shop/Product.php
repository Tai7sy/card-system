<?php
namespace App\Http\Controllers\Shop; use Illuminate\Database\Eloquent\Relations\Relation; use Illuminate\Http\Request; use App\Http\Controllers\Controller; use App\Library\Response; class Product extends Controller { function get(Request $sp375069) { $spca39ca = (int) $sp375069->post('category_id'); if (!$spca39ca) { return Response::forbidden('请选择商品分类'); } $spe4707e = \App\Category::where('id', $spca39ca)->first(); if (!$spe4707e) { return Response::forbidden('商品分类未找到'); } if ($spe4707e->password_open && $sp375069->post('password') !== $spe4707e->password) { return Response::fail('分类密码输入错误'); } $sp5ee5ce = \App\Product::where('category_id', $spca39ca)->where('enabled', 1)->orderBy('sort')->get(); foreach ($sp5ee5ce as $sp6018c8) { $sp6018c8->setForShop(); } return Response::success($sp5ee5ce); } function verifyPassword(Request $sp375069) { $sp138ddb = (int) $sp375069->post('product_id'); if (!$sp138ddb) { return Response::forbidden('请选择商品'); } $sp6018c8 = \App\Product::where('id', $sp138ddb)->first(); if (!$sp6018c8) { return Response::forbidden('商品未找到'); } if ($sp6018c8->password_open && $sp375069->post('password') !== $sp6018c8->password) { return Response::fail('商品密码输入错误'); } return Response::success(); } }