<?php
namespace App\Http\Controllers\Shop; use Illuminate\Database\Eloquent\Relations\Relation; use Illuminate\Http\Request; use App\Http\Controllers\Controller; use App\Library\Response; class Product extends Controller { function get(Request $spaa0004) { $spa990f1 = (int) $spaa0004->post('category_id'); if (!$spa990f1) { return Response::forbidden('请选择商品分类'); } $sp9c1285 = \App\Category::where('id', $spa990f1)->first(); if (!$sp9c1285) { return Response::forbidden('商品分类未找到'); } if ($sp9c1285->password_open && $spaa0004->post('password') !== $sp9c1285->password) { return Response::fail('分类密码输入错误'); } $sp5f1152 = \App\Product::where('category_id', $spa990f1)->where('enabled', 1)->orderBy('sort')->get(); foreach ($sp5f1152 as $sp59cabc) { $sp59cabc->setForShop(); } return Response::success($sp5f1152); } function verifyPassword(Request $spaa0004) { $sp52bbb2 = (int) $spaa0004->post('product_id'); if (!$sp52bbb2) { return Response::forbidden('请选择商品'); } $sp59cabc = \App\Product::where('id', $sp52bbb2)->first(); if (!$sp59cabc) { return Response::forbidden('商品未找到'); } if ($sp59cabc->password_open && $spaa0004->post('password') !== $sp59cabc->password) { return Response::fail('商品密码输入错误'); } return Response::success(); } }