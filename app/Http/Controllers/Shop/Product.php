<?php
namespace App\Http\Controllers\Shop; use Illuminate\Database\Eloquent\Relations\Relation; use Illuminate\Http\Request; use App\Http\Controllers\Controller; use App\Library\Response; class Product extends Controller { function get(Request $spbaac90) { $sp35f37e = (int) $spbaac90->post('category_id'); if (!$sp35f37e) { return Response::forbidden('请选择商品分类'); } $sp7a6bf9 = \App\Category::where('id', $sp35f37e)->first(); if (!$sp7a6bf9) { return Response::forbidden('商品分类未找到'); } if ($sp7a6bf9->password_open && $spbaac90->post('password') !== $sp7a6bf9->password) { return Response::fail('分类密码输入错误'); } $sped8ffc = \App\Product::where('category_id', $sp35f37e)->where('enabled', 1)->orderBy('sort')->get(); foreach ($sped8ffc as $sp73d110) { $sp73d110->setForShop(); } return Response::success($sped8ffc); } function verifyPassword(Request $spbaac90) { $sp1849cc = (int) $spbaac90->post('product_id'); if (!$sp1849cc) { return Response::forbidden('请选择商品'); } $sp73d110 = \App\Product::where('id', $sp1849cc)->first(); if (!$sp73d110) { return Response::forbidden('商品未找到'); } if ($sp73d110->password_open && $spbaac90->post('password') !== $sp73d110->password) { return Response::fail('商品密码输入错误'); } return Response::success(); } }