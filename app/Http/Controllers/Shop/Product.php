<?php
namespace App\Http\Controllers\Shop; use Illuminate\Database\Eloquent\Relations\Relation; use Illuminate\Http\Request; use App\Http\Controllers\Controller; use App\Library\Response; class Product extends Controller { function get(Request $spfb41ce) { $spf9ba01 = (int) $spfb41ce->post('category_id'); if (!$spf9ba01) { return Response::forbidden('请选择商品分类'); } $sp6ebb48 = \App\Category::where('id', $spf9ba01)->first(); if (!$sp6ebb48) { return Response::forbidden('商品分类未找到'); } if ($sp6ebb48->password_open && $spfb41ce->post('password') !== $sp6ebb48->password) { return Response::fail('分类密码输入错误'); } $spc5d46f = \App\Product::where('category_id', $spf9ba01)->where('enabled', 1)->orderBy('sort')->get(); foreach ($spc5d46f as $spae5d03) { $spae5d03->setForShop(); } return Response::success($spc5d46f); } function verifyPassword(Request $spfb41ce) { $sp2fece4 = (int) $spfb41ce->post('product_id'); if (!$sp2fece4) { return Response::forbidden('请选择商品'); } $spae5d03 = \App\Product::where('id', $sp2fece4)->first(); if (!$spae5d03) { return Response::forbidden('商品未找到'); } if ($spae5d03->password_open && $spfb41ce->post('password') !== $spae5d03->password) { return Response::fail('商品密码输入错误'); } return Response::success(); } }