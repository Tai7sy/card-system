<?php
namespace App\Http\Controllers\Shop; use Illuminate\Database\Eloquent\Relations\Relation; use Illuminate\Http\Request; use App\Http\Controllers\Controller; use App\Library\Response; class Product extends Controller { function get(Request $sp054aa0) { $spc3ee02 = (int) $sp054aa0->post('category_id'); if (!$spc3ee02) { return Response::forbidden('请选择商品分类'); } $sp4a59d6 = \App\Category::where('id', $spc3ee02)->first(); if (!$sp4a59d6) { return Response::forbidden('商品分类未找到'); } if ($sp4a59d6->password_open && $sp054aa0->post('password') !== $sp4a59d6->password) { return Response::fail('分类密码输入错误'); } $spc510bf = \App\Product::where('category_id', $spc3ee02)->where('enabled', 1)->orderBy('sort')->get(); foreach ($spc510bf as $sp648779) { $sp648779->setForShop(); } return Response::success($spc510bf); } function verifyPassword(Request $sp054aa0) { $sp107f34 = (int) $sp054aa0->post('product_id'); if (!$sp107f34) { return Response::forbidden('请选择商品'); } $sp648779 = \App\Product::where('id', $sp107f34)->first(); if (!$sp648779) { return Response::forbidden('商品未找到'); } if ($sp648779->password_open && $sp054aa0->post('password') !== $sp648779->password) { return Response::fail('商品密码输入错误'); } return Response::success(); } }