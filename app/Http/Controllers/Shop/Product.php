<?php
namespace App\Http\Controllers\Shop; use Illuminate\Database\Eloquent\Relations\Relation; use Illuminate\Http\Request; use App\Http\Controllers\Controller; use App\Library\Response; class Product extends Controller { function get(Request $sp16eb02) { $sp2d88a9 = (int) $sp16eb02->post('category_id'); if (!$sp2d88a9) { return Response::forbidden('请选择商品分类'); } $sp1012fd = \App\Category::where('id', $sp2d88a9)->first(); if (!$sp1012fd) { return Response::forbidden('商品分类未找到'); } if ($sp1012fd->password_open && $sp16eb02->post('password') !== $sp1012fd->password) { return Response::fail('分类密码输入错误'); } $spd1850c = \App\Product::where('category_id', $sp2d88a9)->where('enabled', 1)->orderBy('sort')->get(); foreach ($spd1850c as $sp48b1b0) { $sp48b1b0->setForShop(); } return Response::success($spd1850c); } function verifyPassword(Request $sp16eb02) { $spc53a3f = (int) $sp16eb02->post('product_id'); if (!$spc53a3f) { return Response::forbidden('请选择商品'); } $sp48b1b0 = \App\Product::where('id', $spc53a3f)->first(); if (!$sp48b1b0) { return Response::forbidden('商品未找到'); } if ($sp48b1b0->password_open && $sp16eb02->post('password') !== $sp48b1b0->password) { return Response::fail('商品密码输入错误'); } return Response::success(); } }