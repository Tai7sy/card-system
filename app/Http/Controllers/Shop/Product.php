<?php
namespace App\Http\Controllers\Shop; use Illuminate\Database\Eloquent\Relations\Relation; use Illuminate\Http\Request; use App\Http\Controllers\Controller; use App\Library\Response; class Product extends Controller { function get(Request $spfeab54) { $sp790613 = (int) $spfeab54->post('category_id'); if (!$sp790613) { return Response::forbidden('请选择商品分类'); } $spb7fea4 = \App\Category::where('id', $sp790613)->first(); if (!$spb7fea4) { return Response::forbidden('商品分类未找到'); } if ($spb7fea4->password_open && $spfeab54->post('password') !== $spb7fea4->password) { return Response::fail('分类密码输入错误'); } $sp8b05f0 = \App\Product::where('category_id', $sp790613)->where('enabled', 1)->orderBy('sort')->get(); foreach ($sp8b05f0 as $sp71cb0c) { $sp71cb0c->setForShop(); } return Response::success($sp8b05f0); } function verifyPassword(Request $spfeab54) { $sp0e30a6 = (int) $spfeab54->post('product_id'); if (!$sp0e30a6) { return Response::forbidden('请选择商品'); } $sp71cb0c = \App\Product::where('id', $sp0e30a6)->first(); if (!$sp71cb0c) { return Response::forbidden('商品未找到'); } if ($sp71cb0c->password_open && $spfeab54->post('password') !== $sp71cb0c->password) { return Response::fail('商品密码输入错误'); } return Response::success(); } }