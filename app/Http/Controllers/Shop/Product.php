<?php
namespace App\Http\Controllers\Shop; use Illuminate\Database\Eloquent\Relations\Relation; use Illuminate\Http\Request; use App\Http\Controllers\Controller; use App\Library\Response; class Product extends Controller { function get(Request $sp7fb11a) { $sp2dac50 = (int) $sp7fb11a->post('category_id'); if (!$sp2dac50) { return Response::forbidden('请选择商品分类'); } $spbbde80 = \App\Category::where('id', $sp2dac50)->first(); if (!$spbbde80) { return Response::forbidden('商品分类未找到'); } if ($spbbde80->password_open && $sp7fb11a->post('password') !== $spbbde80->password) { return Response::fail('分类密码输入错误'); } $spfdf1e6 = \App\Product::where('category_id', $sp2dac50)->where('enabled', 1)->orderBy('sort')->get(); foreach ($spfdf1e6 as $spb0646a) { $spb0646a->setForShop(); } return Response::success($spfdf1e6); } function verifyPassword(Request $sp7fb11a) { $spac20cb = (int) $sp7fb11a->post('product_id'); if (!$spac20cb) { return Response::forbidden('请选择商品'); } $spb0646a = \App\Product::where('id', $spac20cb)->first(); if (!$spb0646a) { return Response::forbidden('商品未找到'); } if ($spb0646a->password_open && $sp7fb11a->post('password') !== $spb0646a->password) { return Response::fail('商品密码输入错误'); } return Response::success(); } }