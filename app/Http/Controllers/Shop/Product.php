<?php
namespace App\Http\Controllers\Shop; use Illuminate\Database\Eloquent\Relations\Relation; use Illuminate\Http\Request; use App\Http\Controllers\Controller; use App\Library\Response; class Product extends Controller { function get(Request $spd5cc4d) { $sp7b7cc9 = (int) $spd5cc4d->post('category_id'); if (!$sp7b7cc9) { return Response::forbidden('请选择商品分类'); } $sp2e76be = \App\Category::where('id', $sp7b7cc9)->first(); if (!$sp2e76be) { return Response::forbidden('商品分类未找到'); } if ($sp2e76be->password_open && $spd5cc4d->post('password') !== $sp2e76be->password) { return Response::fail('分类密码输入错误'); } $sp1cba4d = \App\Product::where('category_id', $sp7b7cc9)->where('enabled', 1)->orderBy('sort')->get(); foreach ($sp1cba4d as $spaeec37) { $spaeec37->setForShop(); } return Response::success($sp1cba4d); } function verifyPassword(Request $spd5cc4d) { $spad8100 = (int) $spd5cc4d->post('product_id'); if (!$spad8100) { return Response::forbidden('请选择商品'); } $spaeec37 = \App\Product::where('id', $spad8100)->first(); if (!$spaeec37) { return Response::forbidden('商品未找到'); } if ($spaeec37->password_open && $spd5cc4d->post('password') !== $spaeec37->password) { return Response::fail('商品密码输入错误'); } return Response::success(); } }