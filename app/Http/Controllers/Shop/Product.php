<?php
namespace App\Http\Controllers\Shop; use Illuminate\Database\Eloquent\Relations\Relation; use Illuminate\Http\Request; use App\Http\Controllers\Controller; use App\Library\Response; class Product extends Controller { function get(Request $sp179c14) { $sp2521ab = (int) $sp179c14->post('category_id'); if (!$sp2521ab) { return Response::forbidden('请选择商品分类'); } $sp555b23 = \App\Category::where('id', $sp2521ab)->first(); if (!$sp555b23) { return Response::forbidden('商品分类未找到'); } if ($sp555b23->password_open && $sp179c14->post('password') !== $sp555b23->password) { return Response::fail('分类密码输入错误'); } $sp86a7dd = \App\Product::where('category_id', $sp2521ab)->where('enabled', 1)->orderBy('sort')->get(); foreach ($sp86a7dd as $sp434ec8) { $sp434ec8->setForShop(); } return Response::success($sp86a7dd); } function verifyPassword(Request $sp179c14) { $spc00b16 = (int) $sp179c14->post('product_id'); if (!$spc00b16) { return Response::forbidden('请选择商品'); } $sp434ec8 = \App\Product::where('id', $spc00b16)->first(); if (!$sp434ec8) { return Response::forbidden('商品未找到'); } if ($sp434ec8->password_open && $sp179c14->post('password') !== $sp434ec8->password) { return Response::fail('商品密码输入错误'); } return Response::success(); } }