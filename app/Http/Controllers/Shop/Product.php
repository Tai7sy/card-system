<?php
namespace App\Http\Controllers\Shop; use Illuminate\Database\Eloquent\Relations\Relation; use Illuminate\Http\Request; use App\Http\Controllers\Controller; use App\Library\Response; class Product extends Controller { function get(Request $sp0aae4c) { $sp18887c = (int) $sp0aae4c->post('category_id'); if (!$sp18887c) { return Response::forbidden('请选择商品分类'); } $spe1f015 = \App\Category::where('id', $sp18887c)->first(); if (!$spe1f015) { return Response::forbidden('商品分类未找到'); } if ($spe1f015->password_open && $sp0aae4c->post('password') !== $spe1f015->password) { return Response::fail('分类密码输入错误'); } $sp95c20d = \App\Product::where('category_id', $sp18887c)->where('enabled', 1)->orderBy('sort')->get(); foreach ($sp95c20d as $spddd5a8) { $spddd5a8->setForShop(); } return Response::success($sp95c20d); } function verifyPassword(Request $sp0aae4c) { $sp2baf03 = (int) $sp0aae4c->post('product_id'); if (!$sp2baf03) { return Response::forbidden('请选择商品'); } $spddd5a8 = \App\Product::where('id', $sp2baf03)->first(); if (!$spddd5a8) { return Response::forbidden('商品未找到'); } if ($spddd5a8->password_open && $sp0aae4c->post('password') !== $spddd5a8->password) { return Response::fail('商品密码输入错误'); } return Response::success(); } }