<?php
namespace App\Http\Controllers\Shop; use Illuminate\Database\Eloquent\Relations\Relation; use Illuminate\Http\Request; use App\Http\Controllers\Controller; use App\Library\Response; class Product extends Controller { function get(Request $spccbfb6) { $sp76eadf = (int) $spccbfb6->post('category_id'); if (!$sp76eadf) { return Response::forbidden('请选择商品分类'); } $sp6e5e3d = \App\Category::where('id', $sp76eadf)->first(); if (!$sp6e5e3d) { return Response::forbidden('商品分类未找到'); } if ($sp6e5e3d->password_open && $spccbfb6->post('password') !== $sp6e5e3d->password) { return Response::fail('分类密码输入错误'); } $spe84217 = \App\Product::where('category_id', $sp76eadf)->where('enabled', 1)->orderBy('sort')->get(); foreach ($spe84217 as $sp886a9b) { $sp886a9b->setForShop(); } return Response::success($spe84217); } function verifyPassword(Request $spccbfb6) { $spa981f6 = (int) $spccbfb6->post('product_id'); if (!$spa981f6) { return Response::forbidden('请选择商品'); } $sp886a9b = \App\Product::where('id', $spa981f6)->first(); if (!$sp886a9b) { return Response::forbidden('商品未找到'); } if ($sp886a9b->password_open && $spccbfb6->post('password') !== $sp886a9b->password) { return Response::fail('商品密码输入错误'); } return Response::success(); } }