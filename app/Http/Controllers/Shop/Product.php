<?php
namespace App\Http\Controllers\Shop; use Illuminate\Database\Eloquent\Relations\Relation; use Illuminate\Http\Request; use App\Http\Controllers\Controller; use App\Library\Response; class Product extends Controller { function get(Request $spf066f3) { $spe478dd = (int) $spf066f3->post('category_id'); if (!$spe478dd) { return Response::forbidden('请选择商品分类'); } $sped57d9 = \App\Category::where('id', $spe478dd)->first(); if (!$sped57d9) { return Response::forbidden('商品分类未找到'); } if ($sped57d9->password_open && $spf066f3->post('password') !== $sped57d9->password) { return Response::fail('分类密码输入错误'); } $sp7c2d5f = \App\Product::where('category_id', $spe478dd)->where('enabled', 1)->orderBy('sort')->get(); foreach ($sp7c2d5f as $sp2cf004) { $sp2cf004->setForShop(); } return Response::success($sp7c2d5f); } function verifyPassword(Request $spf066f3) { $spbb5d29 = (int) $spf066f3->post('product_id'); if (!$spbb5d29) { return Response::forbidden('请选择商品'); } $sp2cf004 = \App\Product::where('id', $spbb5d29)->first(); if (!$sp2cf004) { return Response::forbidden('商品未找到'); } if ($sp2cf004->password_open && $spf066f3->post('password') !== $sp2cf004->password) { return Response::fail('商品密码输入错误'); } return Response::success(); } }