<?php
namespace App\Http\Controllers\Shop; use Illuminate\Database\Eloquent\Relations\Relation; use Illuminate\Http\Request; use App\Http\Controllers\Controller; use App\Library\Response; class Product extends Controller { function get(Request $spa27895) { $sp980f44 = (int) $spa27895->post('category_id'); if (!$sp980f44) { return Response::forbidden('请选择商品分类'); } $spd14ca3 = \App\Category::where('id', $sp980f44)->first(); if (!$spd14ca3) { return Response::forbidden('商品分类未找到'); } if ($spd14ca3->password_open && $spa27895->post('password') !== $spd14ca3->password) { return Response::fail('分类密码输入错误'); } $sp8fefde = \App\Product::where('category_id', $sp980f44)->where('enabled', 1)->orderBy('sort')->get(); foreach ($sp8fefde as $sp1a3ec5) { $sp1a3ec5->setForShop(); } return Response::success($sp8fefde); } function verifyPassword(Request $spa27895) { $sp112a12 = (int) $spa27895->post('product_id'); if (!$sp112a12) { return Response::forbidden('请选择商品'); } $sp1a3ec5 = \App\Product::where('id', $sp112a12)->first(); if (!$sp1a3ec5) { return Response::forbidden('商品未找到'); } if ($sp1a3ec5->password_open && $spa27895->post('password') !== $sp1a3ec5->password) { return Response::fail('商品密码输入错误'); } return Response::success(); } }