<?php
namespace App\Http\Controllers\Shop; use Illuminate\Database\Eloquent\Relations\Relation; use Illuminate\Http\Request; use App\Http\Controllers\Controller; use App\Library\Response; class Product extends Controller { function get(Request $spfb5ae3) { $sp66458a = (int) $spfb5ae3->post('category_id'); if (!$sp66458a) { return Response::forbidden('请选择商品分类'); } $sp0ff930 = \App\Category::where('id', $sp66458a)->first(); if (!$sp0ff930) { return Response::forbidden('商品分类未找到'); } if ($sp0ff930->password_open && $spfb5ae3->post('password') !== $sp0ff930->password) { return Response::fail('分类密码输入错误'); } $spd4d2fd = \App\Product::where('category_id', $sp66458a)->where('enabled', 1)->orderBy('sort')->get(); foreach ($spd4d2fd as $sp7eba0d) { $sp7eba0d->setForShop(); } return Response::success($spd4d2fd); } function verifyPassword(Request $spfb5ae3) { $sp3edfae = (int) $spfb5ae3->post('product_id'); if (!$sp3edfae) { return Response::forbidden('请选择商品'); } $sp7eba0d = \App\Product::where('id', $sp3edfae)->first(); if (!$sp7eba0d) { return Response::forbidden('商品未找到'); } if ($sp7eba0d->password_open && $spfb5ae3->post('password') !== $sp7eba0d->password) { return Response::fail('商品密码输入错误'); } return Response::success(); } }