<?php
namespace App\Library; class UrlShorten { public static function shorten($spfcf689, $sp0dc4bc = false) { if ($sp0dc4bc === false) { $sp0dc4bc = \App\System::_get('domain_shorten'); } if ($sp0dc4bc === '1' || $sp0dc4bc === 'url.cn') { $sp641624 = UrlShorten::url_cn($spfcf689); } elseif ($sp0dc4bc === '2' || $sp0dc4bc === 't.cn') { $sp641624 = UrlShorten::t_cn($spfcf689); } elseif ($sp0dc4bc === 'w.url.cn') { $sp641624 = UrlShorten::w_url_cn($spfcf689); } elseif ($sp0dc4bc === 'custom') { $sp641624 = UrlShorten::custom($spfcf689); } else { return $spfcf689; } } public static function t_cn_official($spfcf689) { $spfcf689 = urlencode($spfcf689); $sp821739 = '2590114856'; $spfdb3dd = 'http://api.t.sina.com.cn/short_url/shorten.json?source=' . $sp821739 . '&url_long=' . $spfcf689; $spaf8fe6 = curl_init(); curl_setopt($spaf8fe6, CURLOPT_URL, $spfdb3dd); curl_setopt($spaf8fe6, CURLOPT_RETURNTRANSFER, 1); curl_setopt($spaf8fe6, CURLOPT_SSL_VERIFYPEER, 0); curl_setopt($spaf8fe6, CURLOPT_HEADER, 0); curl_setopt($spaf8fe6, CURLOPT_HTTPHEADER, array('Content-type: application/json')); $sp15108c = curl_exec($spaf8fe6); curl_close($spaf8fe6); $sp0e15c3 = json_decode($sp15108c, true); return isset($sp0e15c3['url_short']) && strstr($sp0e15c3['url_short'], 'http://') ? $sp0e15c3['url_short'] : null; } public static function t_cn($spfcf689) { $spfcf689 = urlencode($spfcf689); $spfdb3dd = 'https://i.alapi.cn/url/?url=' . $spfcf689; $spaf8fe6 = curl_init(); curl_setopt($spaf8fe6, CURLOPT_URL, $spfdb3dd); curl_setopt($spaf8fe6, CURLOPT_RETURNTRANSFER, 1); curl_setopt($spaf8fe6, CURLOPT_SSL_VERIFYPEER, 0); curl_setopt($spaf8fe6, CURLOPT_HEADER, 0); curl_setopt($spaf8fe6, CURLOPT_HTTPHEADER, array('Content-type: application/json')); $sp15108c = curl_exec($spaf8fe6); curl_close($spaf8fe6); $sp0e15c3 = json_decode($sp15108c, true); return isset($sp0e15c3['shortUrl']) && strstr($sp0e15c3['shortUrl'], 'http') ? $sp0e15c3['shortUrl'] : null; } public static function url_cn($spfcf689) { $spfcf689 = urlencode($spfcf689); $spfdb3dd = 'https://api.uomg.com/api/long2dwz?dwzapi=urlcn&url=' . $spfcf689; $spaf8fe6 = curl_init(); curl_setopt($spaf8fe6, CURLOPT_URL, $spfdb3dd); curl_setopt($spaf8fe6, CURLOPT_RETURNTRANSFER, 1); curl_setopt($spaf8fe6, CURLOPT_SSL_VERIFYPEER, 0); curl_setopt($spaf8fe6, CURLOPT_HEADER, 0); curl_setopt($spaf8fe6, CURLOPT_HTTPHEADER, array('Content-type: application/json')); curl_setopt($spaf8fe6, CURLOPT_TIMEOUT, 5); curl_setopt($spaf8fe6, CURLOPT_CONNECTTIMEOUT, 5); $sp15108c = curl_exec($spaf8fe6); curl_close($spaf8fe6); $sp0e15c3 = json_decode($sp15108c, true); return isset($sp0e15c3['ae_url']) && strstr($sp0e15c3['ae_url'], 'http') ? $sp0e15c3['ae_url'] : null; } public static function w_url_cn($spfcf689) { return null; } public static function custom($spfcf689) { $sp4a5f09 = ''; $sp6b1d60 = ''; $spfcf689 = urlencode($spfcf689); $spfdb3dd = 'http://api.his.cat/api/url/shorten.json?id=' . $sp4a5f09 . '&key=' . $sp6b1d60 . '&url=' . $spfcf689; $spaf8fe6 = curl_init(); curl_setopt($spaf8fe6, CURLOPT_URL, $spfdb3dd); curl_setopt($spaf8fe6, CURLOPT_RETURNTRANSFER, 1); curl_setopt($spaf8fe6, CURLOPT_SSL_VERIFYPEER, 0); curl_setopt($spaf8fe6, CURLOPT_HEADER, 0); curl_setopt($spaf8fe6, CURLOPT_HTTPHEADER, array('Content-type: application/json')); curl_setopt($spaf8fe6, CURLOPT_TIMEOUT, 5); curl_setopt($spaf8fe6, CURLOPT_CONNECTTIMEOUT, 5); $sp15108c = curl_exec($spaf8fe6); curl_close($spaf8fe6); $sp0e15c3 = json_decode($sp15108c, true); return isset($sp0e15c3['data']) && isset($sp0e15c3['data']['short_url']) && strstr($sp0e15c3['data']['short_url'], 'http') ? $sp0e15c3['data']['short_url'] : null; } }