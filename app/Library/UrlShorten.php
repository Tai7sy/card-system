<?php
namespace App\Library; class UrlShorten { public static function shorten($sp810cd1, $spab861f = false) { if ($spab861f === false) { $spab861f = \App\System::_get('domain_shorten'); } if ($spab861f === '1' || $spab861f === 'url.cn') { $sp84e5da = UrlShorten::url_cn($sp810cd1); } elseif ($spab861f === '2' || $spab861f === 't.cn') { $sp84e5da = UrlShorten::t_cn($sp810cd1); } elseif ($spab861f === 'w.url.cn') { $sp84e5da = UrlShorten::w_url_cn($sp810cd1); } elseif ($spab861f === 'custom') { $sp84e5da = UrlShorten::custom($sp810cd1); } else { return $sp810cd1; } } public static function t_cn_official($sp810cd1) { $sp810cd1 = urlencode($sp810cd1); $sp1b9dbd = '2590114856'; $sp12b143 = 'http://api.t.sina.com.cn/short_url/shorten.json?source=' . $sp1b9dbd . '&url_long=' . $sp810cd1; $sp336489 = curl_init(); curl_setopt($sp336489, CURLOPT_URL, $sp12b143); curl_setopt($sp336489, CURLOPT_RETURNTRANSFER, 1); curl_setopt($sp336489, CURLOPT_SSL_VERIFYPEER, 0); curl_setopt($sp336489, CURLOPT_HEADER, 0); curl_setopt($sp336489, CURLOPT_HTTPHEADER, array('Content-type: application/json')); $sp4ffb9b = curl_exec($sp336489); curl_close($sp336489); $spe8cfba = json_decode($sp4ffb9b, true); return isset($spe8cfba['url_short']) && strstr($spe8cfba['url_short'], 'http://') ? $spe8cfba['url_short'] : null; } public static function t_cn($sp810cd1) { $sp810cd1 = urlencode($sp810cd1); $sp12b143 = 'https://i.alapi.cn/url/?url=' . $sp810cd1; $sp336489 = curl_init(); curl_setopt($sp336489, CURLOPT_URL, $sp12b143); curl_setopt($sp336489, CURLOPT_RETURNTRANSFER, 1); curl_setopt($sp336489, CURLOPT_SSL_VERIFYPEER, 0); curl_setopt($sp336489, CURLOPT_HEADER, 0); curl_setopt($sp336489, CURLOPT_HTTPHEADER, array('Content-type: application/json')); $sp4ffb9b = curl_exec($sp336489); curl_close($sp336489); $spe8cfba = json_decode($sp4ffb9b, true); return isset($spe8cfba['shortUrl']) && strstr($spe8cfba['shortUrl'], 'http') ? $spe8cfba['shortUrl'] : null; } public static function url_cn($sp810cd1) { $sp810cd1 = urlencode($sp810cd1); $sp12b143 = 'https://api.uomg.com/api/long2dwz?dwzapi=urlcn&url=' . $sp810cd1; $sp336489 = curl_init(); curl_setopt($sp336489, CURLOPT_URL, $sp12b143); curl_setopt($sp336489, CURLOPT_RETURNTRANSFER, 1); curl_setopt($sp336489, CURLOPT_SSL_VERIFYPEER, 0); curl_setopt($sp336489, CURLOPT_HEADER, 0); curl_setopt($sp336489, CURLOPT_HTTPHEADER, array('Content-type: application/json')); curl_setopt($sp336489, CURLOPT_TIMEOUT, 5); curl_setopt($sp336489, CURLOPT_CONNECTTIMEOUT, 5); $sp4ffb9b = curl_exec($sp336489); curl_close($sp336489); $spe8cfba = json_decode($sp4ffb9b, true); return isset($spe8cfba['ae_url']) && strstr($spe8cfba['ae_url'], 'http') ? $spe8cfba['ae_url'] : null; } public static function w_url_cn($sp810cd1) { return null; } public static function custom($sp810cd1) { $sp9b7f8e = ''; $sp850f46 = ''; $sp810cd1 = urlencode($sp810cd1); $sp12b143 = 'http://api.his.cat/api/url/shorten.json?id=' . $sp9b7f8e . '&key=' . $sp850f46 . '&url=' . $sp810cd1; $sp336489 = curl_init(); curl_setopt($sp336489, CURLOPT_URL, $sp12b143); curl_setopt($sp336489, CURLOPT_RETURNTRANSFER, 1); curl_setopt($sp336489, CURLOPT_SSL_VERIFYPEER, 0); curl_setopt($sp336489, CURLOPT_HEADER, 0); curl_setopt($sp336489, CURLOPT_HTTPHEADER, array('Content-type: application/json')); curl_setopt($sp336489, CURLOPT_TIMEOUT, 5); curl_setopt($sp336489, CURLOPT_CONNECTTIMEOUT, 5); $sp4ffb9b = curl_exec($sp336489); curl_close($sp336489); $spe8cfba = json_decode($sp4ffb9b, true); return isset($spe8cfba['data']) && isset($spe8cfba['data']['short_url']) && strstr($spe8cfba['data']['short_url'], 'http') ? $spe8cfba['data']['short_url'] : null; } }