<?php
namespace App\Library; class UrlShorten { public static function shorten($sp0839a0, $spda8b58 = false) { if ($spda8b58 === false) { $spda8b58 = \App\System::_get('domain_shorten'); } if ($spda8b58 === '1' || $spda8b58 === 'url.cn') { $sp1f7f88 = UrlShorten::url_cn($sp0839a0); } elseif ($spda8b58 === '2' || $spda8b58 === 't.cn') { $sp1f7f88 = UrlShorten::t_cn($sp0839a0); } elseif ($spda8b58 === 'w.url.cn') { $sp1f7f88 = UrlShorten::w_url_cn($sp0839a0); } elseif ($spda8b58 === 'custom') { $sp1f7f88 = UrlShorten::custom($sp0839a0); } else { return $sp0839a0; } } public static function t_cn_official($sp0839a0) { $sp0839a0 = urlencode($sp0839a0); $sp2a660f = '2590114856'; $spdf3b79 = 'http://api.t.sina.com.cn/short_url/shorten.json?source=' . $sp2a660f . '&url_long=' . $sp0839a0; $spd3e840 = curl_init(); curl_setopt($spd3e840, CURLOPT_URL, $spdf3b79); curl_setopt($spd3e840, CURLOPT_RETURNTRANSFER, 1); curl_setopt($spd3e840, CURLOPT_SSL_VERIFYPEER, 0); curl_setopt($spd3e840, CURLOPT_HEADER, 0); curl_setopt($spd3e840, CURLOPT_HTTPHEADER, array('Content-type: application/json')); $sp014e61 = curl_exec($spd3e840); curl_close($spd3e840); $spab950e = json_decode($sp014e61, true); return isset($spab950e['url_short']) && strstr($spab950e['url_short'], 'http://') ? $spab950e['url_short'] : null; } public static function t_cn($sp0839a0) { $sp0839a0 = urlencode($sp0839a0); $spdf3b79 = 'https://i.alapi.cn/url/?url=' . $sp0839a0; $spd3e840 = curl_init(); curl_setopt($spd3e840, CURLOPT_URL, $spdf3b79); curl_setopt($spd3e840, CURLOPT_RETURNTRANSFER, 1); curl_setopt($spd3e840, CURLOPT_SSL_VERIFYPEER, 0); curl_setopt($spd3e840, CURLOPT_HEADER, 0); curl_setopt($spd3e840, CURLOPT_HTTPHEADER, array('Content-type: application/json')); $sp014e61 = curl_exec($spd3e840); curl_close($spd3e840); $spab950e = json_decode($sp014e61, true); return isset($spab950e['shortUrl']) && strstr($spab950e['shortUrl'], 'http') ? $spab950e['shortUrl'] : null; } public static function url_cn($sp0839a0) { $sp0839a0 = urlencode($sp0839a0); $spdf3b79 = 'https://api.uomg.com/api/long2dwz?dwzapi=urlcn&url=' . $sp0839a0; $spd3e840 = curl_init(); curl_setopt($spd3e840, CURLOPT_URL, $spdf3b79); curl_setopt($spd3e840, CURLOPT_RETURNTRANSFER, 1); curl_setopt($spd3e840, CURLOPT_SSL_VERIFYPEER, 0); curl_setopt($spd3e840, CURLOPT_HEADER, 0); curl_setopt($spd3e840, CURLOPT_HTTPHEADER, array('Content-type: application/json')); curl_setopt($spd3e840, CURLOPT_TIMEOUT, 5); curl_setopt($spd3e840, CURLOPT_CONNECTTIMEOUT, 5); $sp014e61 = curl_exec($spd3e840); curl_close($spd3e840); $spab950e = json_decode($sp014e61, true); return isset($spab950e['ae_url']) && strstr($spab950e['ae_url'], 'http') ? $spab950e['ae_url'] : null; } public static function w_url_cn($sp0839a0) { return null; } public static function custom($sp0839a0) { $sp330118 = ''; $spf34e1f = ''; $sp0839a0 = urlencode($sp0839a0); $spdf3b79 = 'http://api.his.cat/api/url/shorten.json?id=' . $sp330118 . '&key=' . $spf34e1f . '&url=' . $sp0839a0; $spd3e840 = curl_init(); curl_setopt($spd3e840, CURLOPT_URL, $spdf3b79); curl_setopt($spd3e840, CURLOPT_RETURNTRANSFER, 1); curl_setopt($spd3e840, CURLOPT_SSL_VERIFYPEER, 0); curl_setopt($spd3e840, CURLOPT_HEADER, 0); curl_setopt($spd3e840, CURLOPT_HTTPHEADER, array('Content-type: application/json')); curl_setopt($spd3e840, CURLOPT_TIMEOUT, 5); curl_setopt($spd3e840, CURLOPT_CONNECTTIMEOUT, 5); $sp014e61 = curl_exec($spd3e840); curl_close($spd3e840); $spab950e = json_decode($sp014e61, true); return isset($spab950e['data']) && isset($spab950e['data']['short_url']) && strstr($spab950e['data']['short_url'], 'http') ? $spab950e['data']['short_url'] : null; } }