<?php
namespace App\Library; class UrlShorten { public static function shorten($sp650420, $sp40ca5f = false) { if ($sp40ca5f === false) { $sp40ca5f = \App\System::_get('domain_shorten'); } if ($sp40ca5f === '1' || $sp40ca5f === 'url.cn') { $sp284969 = UrlShorten::url_cn($sp650420); } elseif ($sp40ca5f === '2' || $sp40ca5f === 't.cn') { $sp284969 = UrlShorten::t_cn($sp650420); } elseif ($sp40ca5f === 'w.url.cn') { $sp284969 = UrlShorten::w_url_cn($sp650420); } elseif ($sp40ca5f === 'custom') { $sp284969 = UrlShorten::custom($sp650420); } else { return $sp650420; } } public static function t_cn_official($sp650420) { $sp650420 = urlencode($sp650420); $sp0a04ad = '2590114856'; $sp4c820e = 'http://api.t.sina.com.cn/short_url/shorten.json?source=' . $sp0a04ad . '&url_long=' . $sp650420; $sp80b9f7 = curl_init(); curl_setopt($sp80b9f7, CURLOPT_URL, $sp4c820e); curl_setopt($sp80b9f7, CURLOPT_RETURNTRANSFER, 1); curl_setopt($sp80b9f7, CURLOPT_SSL_VERIFYPEER, 0); curl_setopt($sp80b9f7, CURLOPT_HEADER, 0); curl_setopt($sp80b9f7, CURLOPT_HTTPHEADER, array('Content-type: application/json')); $sp7fa26f = curl_exec($sp80b9f7); curl_close($sp80b9f7); $spfaa28e = json_decode($sp7fa26f, true); return isset($spfaa28e['url_short']) && strstr($spfaa28e['url_short'], 'http://') ? $spfaa28e['url_short'] : null; } public static function t_cn($sp650420) { $sp650420 = urlencode($sp650420); $sp4c820e = 'https://i.alapi.cn/url/?url=' . $sp650420; $sp80b9f7 = curl_init(); curl_setopt($sp80b9f7, CURLOPT_URL, $sp4c820e); curl_setopt($sp80b9f7, CURLOPT_RETURNTRANSFER, 1); curl_setopt($sp80b9f7, CURLOPT_SSL_VERIFYPEER, 0); curl_setopt($sp80b9f7, CURLOPT_HEADER, 0); curl_setopt($sp80b9f7, CURLOPT_HTTPHEADER, array('Content-type: application/json')); $sp7fa26f = curl_exec($sp80b9f7); curl_close($sp80b9f7); $spfaa28e = json_decode($sp7fa26f, true); return isset($spfaa28e['shortUrl']) && strstr($spfaa28e['shortUrl'], 'http') ? $spfaa28e['shortUrl'] : null; } public static function url_cn($sp650420) { $sp650420 = urlencode($sp650420); $sp4c820e = 'https://api.uomg.com/api/long2dwz?dwzapi=urlcn&url=' . $sp650420; $sp80b9f7 = curl_init(); curl_setopt($sp80b9f7, CURLOPT_URL, $sp4c820e); curl_setopt($sp80b9f7, CURLOPT_RETURNTRANSFER, 1); curl_setopt($sp80b9f7, CURLOPT_SSL_VERIFYPEER, 0); curl_setopt($sp80b9f7, CURLOPT_HEADER, 0); curl_setopt($sp80b9f7, CURLOPT_HTTPHEADER, array('Content-type: application/json')); curl_setopt($sp80b9f7, CURLOPT_TIMEOUT, 5); curl_setopt($sp80b9f7, CURLOPT_CONNECTTIMEOUT, 5); $sp7fa26f = curl_exec($sp80b9f7); curl_close($sp80b9f7); $spfaa28e = json_decode($sp7fa26f, true); return isset($spfaa28e['ae_url']) && strstr($spfaa28e['ae_url'], 'http') ? $spfaa28e['ae_url'] : null; } public static function w_url_cn($sp650420) { return null; } public static function custom($sp650420) { $sp80f548 = ''; $sp1285fa = ''; $sp650420 = urlencode($sp650420); $sp4c820e = 'http://api.his.cat/api/url/shorten.json?id=' . $sp80f548 . '&key=' . $sp1285fa . '&url=' . $sp650420; $sp80b9f7 = curl_init(); curl_setopt($sp80b9f7, CURLOPT_URL, $sp4c820e); curl_setopt($sp80b9f7, CURLOPT_RETURNTRANSFER, 1); curl_setopt($sp80b9f7, CURLOPT_SSL_VERIFYPEER, 0); curl_setopt($sp80b9f7, CURLOPT_HEADER, 0); curl_setopt($sp80b9f7, CURLOPT_HTTPHEADER, array('Content-type: application/json')); curl_setopt($sp80b9f7, CURLOPT_TIMEOUT, 5); curl_setopt($sp80b9f7, CURLOPT_CONNECTTIMEOUT, 5); $sp7fa26f = curl_exec($sp80b9f7); curl_close($sp80b9f7); $spfaa28e = json_decode($sp7fa26f, true); return isset($spfaa28e['data']) && isset($spfaa28e['data']['short_url']) && strstr($spfaa28e['data']['short_url'], 'http') ? $spfaa28e['data']['short_url'] : null; } }