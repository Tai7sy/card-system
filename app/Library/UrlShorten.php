<?php
namespace App\Library; class UrlShorten { public static function shorten($sp83d948, $spc07539 = false) { if ($spc07539 === false) { $spc07539 = \App\System::_get('domain_shorten'); } if ($spc07539 === '1' || $spc07539 === 'url.cn') { $spd74c34 = UrlShorten::url_cn($sp83d948); } elseif ($spc07539 === '2' || $spc07539 === 't.cn') { $spd74c34 = UrlShorten::t_cn($sp83d948); } elseif ($spc07539 === 'w.url.cn') { $spd74c34 = UrlShorten::w_url_cn($sp83d948); } elseif ($spc07539 === 'custom') { $spd74c34 = UrlShorten::custom($sp83d948); } else { return $sp83d948; } } public static function t_cn_official($sp83d948) { $sp83d948 = urlencode($sp83d948); $spcbb02c = '2590114856'; $sp3e9056 = 'http://api.t.sina.com.cn/short_url/shorten.json?source=' . $spcbb02c . '&url_long=' . $sp83d948; $spd093f8 = curl_init(); curl_setopt($spd093f8, CURLOPT_URL, $sp3e9056); curl_setopt($spd093f8, CURLOPT_RETURNTRANSFER, 1); curl_setopt($spd093f8, CURLOPT_SSL_VERIFYPEER, 0); curl_setopt($spd093f8, CURLOPT_HEADER, 0); curl_setopt($spd093f8, CURLOPT_HTTPHEADER, array('Content-type: application/json')); $sp0223d2 = curl_exec($spd093f8); curl_close($spd093f8); $spf0c502 = json_decode($sp0223d2, true); return isset($spf0c502['url_short']) && strstr($spf0c502['url_short'], 'http://') ? $spf0c502['url_short'] : null; } public static function t_cn($sp83d948) { $sp83d948 = urlencode($sp83d948); $sp3e9056 = 'https://i.alapi.cn/url/?url=' . $sp83d948; $spd093f8 = curl_init(); curl_setopt($spd093f8, CURLOPT_URL, $sp3e9056); curl_setopt($spd093f8, CURLOPT_RETURNTRANSFER, 1); curl_setopt($spd093f8, CURLOPT_SSL_VERIFYPEER, 0); curl_setopt($spd093f8, CURLOPT_HEADER, 0); curl_setopt($spd093f8, CURLOPT_HTTPHEADER, array('Content-type: application/json')); $sp0223d2 = curl_exec($spd093f8); curl_close($spd093f8); $spf0c502 = json_decode($sp0223d2, true); return isset($spf0c502['shortUrl']) && strstr($spf0c502['shortUrl'], 'http') ? $spf0c502['shortUrl'] : null; } public static function url_cn($sp83d948) { $sp83d948 = urlencode($sp83d948); $sp3e9056 = 'https://api.uomg.com/api/long2dwz?dwzapi=urlcn&url=' . $sp83d948; $spd093f8 = curl_init(); curl_setopt($spd093f8, CURLOPT_URL, $sp3e9056); curl_setopt($spd093f8, CURLOPT_RETURNTRANSFER, 1); curl_setopt($spd093f8, CURLOPT_SSL_VERIFYPEER, 0); curl_setopt($spd093f8, CURLOPT_HEADER, 0); curl_setopt($spd093f8, CURLOPT_HTTPHEADER, array('Content-type: application/json')); curl_setopt($spd093f8, CURLOPT_TIMEOUT, 5); curl_setopt($spd093f8, CURLOPT_CONNECTTIMEOUT, 5); $sp0223d2 = curl_exec($spd093f8); curl_close($spd093f8); $spf0c502 = json_decode($sp0223d2, true); return isset($spf0c502['ae_url']) && strstr($spf0c502['ae_url'], 'http') ? $spf0c502['ae_url'] : null; } public static function w_url_cn($sp83d948) { return null; } public static function custom($sp83d948) { $spe78fcd = ''; $sp7d63d9 = ''; $sp83d948 = urlencode($sp83d948); $sp3e9056 = 'http://api.his.cat/api/url/shorten.json?id=' . $spe78fcd . '&key=' . $sp7d63d9 . '&url=' . $sp83d948; $spd093f8 = curl_init(); curl_setopt($spd093f8, CURLOPT_URL, $sp3e9056); curl_setopt($spd093f8, CURLOPT_RETURNTRANSFER, 1); curl_setopt($spd093f8, CURLOPT_SSL_VERIFYPEER, 0); curl_setopt($spd093f8, CURLOPT_HEADER, 0); curl_setopt($spd093f8, CURLOPT_HTTPHEADER, array('Content-type: application/json')); curl_setopt($spd093f8, CURLOPT_TIMEOUT, 5); curl_setopt($spd093f8, CURLOPT_CONNECTTIMEOUT, 5); $sp0223d2 = curl_exec($spd093f8); curl_close($spd093f8); $spf0c502 = json_decode($sp0223d2, true); return isset($spf0c502['data']) && isset($spf0c502['data']['short_url']) && strstr($spf0c502['data']['short_url'], 'http') ? $spf0c502['data']['short_url'] : null; } }