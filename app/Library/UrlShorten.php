<?php
namespace App\Library; class UrlShorten { public static function shorten($sp075fe7, $spcf1d0e = false) { if ($spcf1d0e === false) { $spcf1d0e = \App\System::_get('domain_shorten'); } if ($spcf1d0e === '1' || $spcf1d0e === 'url.cn') { $sp197a68 = UrlShorten::url_cn($sp075fe7); } elseif ($spcf1d0e === '2' || $spcf1d0e === 't.cn') { $sp197a68 = UrlShorten::t_cn($sp075fe7); } elseif ($spcf1d0e === 'w.url.cn') { $sp197a68 = UrlShorten::w_url_cn($sp075fe7); } elseif ($spcf1d0e === 'custom') { $sp197a68 = UrlShorten::custom($sp075fe7); } else { return $sp075fe7; } } public static function t_cn_official($sp075fe7) { $sp075fe7 = urlencode($sp075fe7); $spaeb80f = '2590114856'; $sp187da7 = 'http://api.t.sina.com.cn/short_url/shorten.json?source=' . $spaeb80f . '&url_long=' . $sp075fe7; $spa8e215 = curl_init(); curl_setopt($spa8e215, CURLOPT_URL, $sp187da7); curl_setopt($spa8e215, CURLOPT_RETURNTRANSFER, 1); curl_setopt($spa8e215, CURLOPT_SSL_VERIFYPEER, 0); curl_setopt($spa8e215, CURLOPT_HEADER, 0); curl_setopt($spa8e215, CURLOPT_HTTPHEADER, array('Content-type: application/json')); $sp9d3345 = curl_exec($spa8e215); curl_close($spa8e215); $sp205719 = json_decode($sp9d3345, true); return isset($sp205719['url_short']) && strstr($sp205719['url_short'], 'http://') ? $sp205719['url_short'] : null; } public static function t_cn($sp075fe7) { $sp075fe7 = urlencode($sp075fe7); $sp187da7 = 'https://i.alapi.cn/url/?url=' . $sp075fe7; $spa8e215 = curl_init(); curl_setopt($spa8e215, CURLOPT_URL, $sp187da7); curl_setopt($spa8e215, CURLOPT_RETURNTRANSFER, 1); curl_setopt($spa8e215, CURLOPT_SSL_VERIFYPEER, 0); curl_setopt($spa8e215, CURLOPT_HEADER, 0); curl_setopt($spa8e215, CURLOPT_HTTPHEADER, array('Content-type: application/json')); $sp9d3345 = curl_exec($spa8e215); curl_close($spa8e215); $sp205719 = json_decode($sp9d3345, true); return isset($sp205719['shortUrl']) && strstr($sp205719['shortUrl'], 'http') ? $sp205719['shortUrl'] : null; } public static function url_cn($sp075fe7) { $sp075fe7 = urlencode($sp075fe7); $sp187da7 = 'https://api.uomg.com/api/long2dwz?dwzapi=urlcn&url=' . $sp075fe7; $spa8e215 = curl_init(); curl_setopt($spa8e215, CURLOPT_URL, $sp187da7); curl_setopt($spa8e215, CURLOPT_RETURNTRANSFER, 1); curl_setopt($spa8e215, CURLOPT_SSL_VERIFYPEER, 0); curl_setopt($spa8e215, CURLOPT_HEADER, 0); curl_setopt($spa8e215, CURLOPT_HTTPHEADER, array('Content-type: application/json')); curl_setopt($spa8e215, CURLOPT_TIMEOUT, 5); curl_setopt($spa8e215, CURLOPT_CONNECTTIMEOUT, 5); $sp9d3345 = curl_exec($spa8e215); curl_close($spa8e215); $sp205719 = json_decode($sp9d3345, true); return isset($sp205719['ae_url']) && strstr($sp205719['ae_url'], 'http') ? $sp205719['ae_url'] : null; } public static function w_url_cn($sp075fe7) { return null; } public static function custom($sp075fe7) { $sp34345e = ''; $spa5f7a0 = ''; $sp075fe7 = urlencode($sp075fe7); $sp187da7 = 'http://api.his.cat/api/url/shorten.json?id=' . $sp34345e . '&key=' . $spa5f7a0 . '&url=' . $sp075fe7; $spa8e215 = curl_init(); curl_setopt($spa8e215, CURLOPT_URL, $sp187da7); curl_setopt($spa8e215, CURLOPT_RETURNTRANSFER, 1); curl_setopt($spa8e215, CURLOPT_SSL_VERIFYPEER, 0); curl_setopt($spa8e215, CURLOPT_HEADER, 0); curl_setopt($spa8e215, CURLOPT_HTTPHEADER, array('Content-type: application/json')); curl_setopt($spa8e215, CURLOPT_TIMEOUT, 5); curl_setopt($spa8e215, CURLOPT_CONNECTTIMEOUT, 5); $sp9d3345 = curl_exec($spa8e215); curl_close($spa8e215); $sp205719 = json_decode($sp9d3345, true); return isset($sp205719['data']) && isset($sp205719['data']['short_url']) && strstr($sp205719['data']['short_url'], 'http') ? $sp205719['data']['short_url'] : null; } }