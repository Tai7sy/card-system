<?php
namespace App\Library; class UrlShorten { public static function shorten($sp63e208, $sp24c324 = false) { if ($sp24c324 === false) { $sp24c324 = \App\System::_get('domain_shorten'); } if ($sp24c324 === '1' || $sp24c324 === 'url.cn') { $sp1c44ac = UrlShorten::url_cn($sp63e208); } elseif ($sp24c324 === '2' || $sp24c324 === 't.cn') { $sp1c44ac = UrlShorten::t_cn($sp63e208); } elseif ($sp24c324 === 'w.url.cn') { $sp1c44ac = UrlShorten::w_url_cn($sp63e208); } elseif ($sp24c324 === 'custom') { $sp1c44ac = UrlShorten::custom($sp63e208); } else { return $sp63e208; } } public static function t_cn_official($sp63e208) { $sp63e208 = urlencode($sp63e208); $sp36cc8a = '2590114856'; $sp57f63e = 'http://api.t.sina.com.cn/short_url/shorten.json?source=' . $sp36cc8a . '&url_long=' . $sp63e208; $sp5eaaef = curl_init(); curl_setopt($sp5eaaef, CURLOPT_URL, $sp57f63e); curl_setopt($sp5eaaef, CURLOPT_RETURNTRANSFER, 1); curl_setopt($sp5eaaef, CURLOPT_SSL_VERIFYPEER, 0); curl_setopt($sp5eaaef, CURLOPT_HEADER, 0); curl_setopt($sp5eaaef, CURLOPT_HTTPHEADER, array('Content-type: application/json')); $sp7c95a4 = curl_exec($sp5eaaef); curl_close($sp5eaaef); $spb6c835 = json_decode($sp7c95a4, true); return isset($spb6c835['url_short']) && strstr($spb6c835['url_short'], 'http://') ? $spb6c835['url_short'] : null; } public static function t_cn($sp63e208) { $sp63e208 = urlencode($sp63e208); $sp57f63e = 'https://i.alapi.cn/url/?url=' . $sp63e208; $sp5eaaef = curl_init(); curl_setopt($sp5eaaef, CURLOPT_URL, $sp57f63e); curl_setopt($sp5eaaef, CURLOPT_RETURNTRANSFER, 1); curl_setopt($sp5eaaef, CURLOPT_SSL_VERIFYPEER, 0); curl_setopt($sp5eaaef, CURLOPT_HEADER, 0); curl_setopt($sp5eaaef, CURLOPT_HTTPHEADER, array('Content-type: application/json')); $sp7c95a4 = curl_exec($sp5eaaef); curl_close($sp5eaaef); $spb6c835 = json_decode($sp7c95a4, true); return isset($spb6c835['shortUrl']) && strstr($spb6c835['shortUrl'], 'http') ? $spb6c835['shortUrl'] : null; } public static function url_cn($sp63e208) { $sp63e208 = urlencode($sp63e208); $sp57f63e = 'https://api.uomg.com/api/long2dwz?dwzapi=urlcn&url=' . $sp63e208; $sp5eaaef = curl_init(); curl_setopt($sp5eaaef, CURLOPT_URL, $sp57f63e); curl_setopt($sp5eaaef, CURLOPT_RETURNTRANSFER, 1); curl_setopt($sp5eaaef, CURLOPT_SSL_VERIFYPEER, 0); curl_setopt($sp5eaaef, CURLOPT_HEADER, 0); curl_setopt($sp5eaaef, CURLOPT_HTTPHEADER, array('Content-type: application/json')); curl_setopt($sp5eaaef, CURLOPT_TIMEOUT, 5); curl_setopt($sp5eaaef, CURLOPT_CONNECTTIMEOUT, 5); $sp7c95a4 = curl_exec($sp5eaaef); curl_close($sp5eaaef); $spb6c835 = json_decode($sp7c95a4, true); return isset($spb6c835['ae_url']) && strstr($spb6c835['ae_url'], 'http') ? $spb6c835['ae_url'] : null; } public static function w_url_cn($sp63e208) { return null; } public static function custom($sp63e208) { $spaf4dd6 = ''; $sp36c1d2 = ''; $sp63e208 = urlencode($sp63e208); $sp57f63e = 'http://api.his.cat/api/url/shorten.json?id=' . $spaf4dd6 . '&key=' . $sp36c1d2 . '&url=' . $sp63e208; $sp5eaaef = curl_init(); curl_setopt($sp5eaaef, CURLOPT_URL, $sp57f63e); curl_setopt($sp5eaaef, CURLOPT_RETURNTRANSFER, 1); curl_setopt($sp5eaaef, CURLOPT_SSL_VERIFYPEER, 0); curl_setopt($sp5eaaef, CURLOPT_HEADER, 0); curl_setopt($sp5eaaef, CURLOPT_HTTPHEADER, array('Content-type: application/json')); curl_setopt($sp5eaaef, CURLOPT_TIMEOUT, 5); curl_setopt($sp5eaaef, CURLOPT_CONNECTTIMEOUT, 5); $sp7c95a4 = curl_exec($sp5eaaef); curl_close($sp5eaaef); $spb6c835 = json_decode($sp7c95a4, true); return isset($spb6c835['data']) && isset($spb6c835['data']['short_url']) && strstr($spb6c835['data']['short_url'], 'http') ? $spb6c835['data']['short_url'] : null; } }