<?php
namespace App\Library; class UrlShorten { public static function shorten($sp9b9800, $spf8e7b1 = false) { if ($spf8e7b1 === false) { $spf8e7b1 = \App\System::_get('domain_shorten'); } if ($spf8e7b1 === '1' || $spf8e7b1 === 'url.cn') { $spa95b17 = UrlShorten::url_cn($sp9b9800); } elseif ($spf8e7b1 === '2' || $spf8e7b1 === 't.cn') { $spa95b17 = UrlShorten::t_cn($sp9b9800); } elseif ($spf8e7b1 === 'w.url.cn') { $spa95b17 = UrlShorten::w_url_cn($sp9b9800); } elseif ($spf8e7b1 === 'custom') { $spa95b17 = UrlShorten::custom($sp9b9800); } else { return $sp9b9800; } } public static function t_cn_official($sp9b9800) { $sp9b9800 = urlencode($sp9b9800); $sp2c70ed = '2590114856'; $sp41bba6 = 'http://api.t.sina.com.cn/short_url/shorten.json?source=' . $sp2c70ed . '&url_long=' . $sp9b9800; $spd9d4ca = curl_init(); curl_setopt($spd9d4ca, CURLOPT_URL, $sp41bba6); curl_setopt($spd9d4ca, CURLOPT_RETURNTRANSFER, 1); curl_setopt($spd9d4ca, CURLOPT_SSL_VERIFYPEER, 0); curl_setopt($spd9d4ca, CURLOPT_HEADER, 0); curl_setopt($spd9d4ca, CURLOPT_HTTPHEADER, array('Content-type: application/json')); $spb9364a = curl_exec($spd9d4ca); curl_close($spd9d4ca); $sp3c6f92 = json_decode($spb9364a, true); return isset($sp3c6f92['url_short']) && strstr($sp3c6f92['url_short'], 'http://') ? $sp3c6f92['url_short'] : null; } public static function t_cn($sp9b9800) { $sp9b9800 = urlencode($sp9b9800); $sp41bba6 = 'https://i.alapi.cn/url/?url=' . $sp9b9800; $spd9d4ca = curl_init(); curl_setopt($spd9d4ca, CURLOPT_URL, $sp41bba6); curl_setopt($spd9d4ca, CURLOPT_RETURNTRANSFER, 1); curl_setopt($spd9d4ca, CURLOPT_SSL_VERIFYPEER, 0); curl_setopt($spd9d4ca, CURLOPT_HEADER, 0); curl_setopt($spd9d4ca, CURLOPT_HTTPHEADER, array('Content-type: application/json')); $spb9364a = curl_exec($spd9d4ca); curl_close($spd9d4ca); $sp3c6f92 = json_decode($spb9364a, true); return isset($sp3c6f92['shortUrl']) && strstr($sp3c6f92['shortUrl'], 'http') ? $sp3c6f92['shortUrl'] : null; } public static function url_cn($sp9b9800) { $sp9b9800 = urlencode($sp9b9800); $sp41bba6 = 'https://api.uomg.com/api/long2dwz?dwzapi=urlcn&url=' . $sp9b9800; $spd9d4ca = curl_init(); curl_setopt($spd9d4ca, CURLOPT_URL, $sp41bba6); curl_setopt($spd9d4ca, CURLOPT_RETURNTRANSFER, 1); curl_setopt($spd9d4ca, CURLOPT_SSL_VERIFYPEER, 0); curl_setopt($spd9d4ca, CURLOPT_HEADER, 0); curl_setopt($spd9d4ca, CURLOPT_HTTPHEADER, array('Content-type: application/json')); curl_setopt($spd9d4ca, CURLOPT_TIMEOUT, 5); curl_setopt($spd9d4ca, CURLOPT_CONNECTTIMEOUT, 5); $spb9364a = curl_exec($spd9d4ca); curl_close($spd9d4ca); $sp3c6f92 = json_decode($spb9364a, true); return isset($sp3c6f92['ae_url']) && strstr($sp3c6f92['ae_url'], 'http') ? $sp3c6f92['ae_url'] : null; } public static function w_url_cn($sp9b9800) { return null; } public static function custom($sp9b9800) { $sp96dd9b = ''; $spda1349 = ''; $sp9b9800 = urlencode($sp9b9800); $sp41bba6 = 'http://api.his.cat/api/url/shorten.json?id=' . $sp96dd9b . '&key=' . $spda1349 . '&url=' . $sp9b9800; $spd9d4ca = curl_init(); curl_setopt($spd9d4ca, CURLOPT_URL, $sp41bba6); curl_setopt($spd9d4ca, CURLOPT_RETURNTRANSFER, 1); curl_setopt($spd9d4ca, CURLOPT_SSL_VERIFYPEER, 0); curl_setopt($spd9d4ca, CURLOPT_HEADER, 0); curl_setopt($spd9d4ca, CURLOPT_HTTPHEADER, array('Content-type: application/json')); curl_setopt($spd9d4ca, CURLOPT_TIMEOUT, 5); curl_setopt($spd9d4ca, CURLOPT_CONNECTTIMEOUT, 5); $spb9364a = curl_exec($spd9d4ca); curl_close($spd9d4ca); $sp3c6f92 = json_decode($spb9364a, true); return isset($sp3c6f92['data']) && isset($sp3c6f92['data']['short_url']) && strstr($sp3c6f92['data']['short_url'], 'http') ? $sp3c6f92['data']['short_url'] : null; } }