<?php
namespace App\Library\Geetest; use Illuminate\Support\Facades\Session; class API { private $geetest_conf = null; public function __construct($sp4259fe) { $this->geetest_conf = $sp4259fe; } public static function get() { $sp1ffc0e = config('services.geetest.id'); $spc0a0e7 = config('services.geetest.key'); if (!strlen($sp1ffc0e) || !strlen($spc0a0e7)) { return null; } $sp71f055 = new Lib($sp1ffc0e, $spc0a0e7); $sp45cf7f = time() . rand(1, 10000); $sp646c5e = $sp71f055->pre_process($sp45cf7f); $sp599084 = json_decode($sp71f055->get_response_str()); Session::put('gt_server', $sp646c5e); Session::put('gt_user_id', $sp45cf7f); return $sp599084; } public static function verify($spcd49ad, $spebcc17, $spebbc10) { $sp71f055 = new Lib(config('services.geetest.id'), config('services.geetest.key')); $sp45cf7f = Session::get('gt_user_id'); if (Session::get('gt_server') == 1) { $spa99c85 = $sp71f055->success_validate($spcd49ad, $spebcc17, $spebbc10, $sp45cf7f); if ($spa99c85) { return true; } else { return false; } } else { if ($sp71f055->fail_validate($spcd49ad, $spebcc17, $spebbc10)) { return true; } else { return false; } } } }