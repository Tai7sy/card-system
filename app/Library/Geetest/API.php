<?php
namespace App\Library\Geetest; use Illuminate\Support\Facades\Session; class API { private $geetest_conf = null; public function __construct($sp47d7e2) { $this->geetest_conf = $sp47d7e2; } public static function get() { $sp805277 = config('services.geetest.id'); $spb19d6e = config('services.geetest.key'); if (!strlen($sp805277) || !strlen($spb19d6e)) { return null; } $sp83a6de = new Lib($sp805277, $spb19d6e); $sp71c904 = time() . rand(1, 10000); $sp8d8a6c = $sp83a6de->pre_process($sp71c904); $sp4e109c = json_decode($sp83a6de->get_response_str()); Session::put('gt_server', $sp8d8a6c); Session::put('gt_user_id', $sp71c904); return $sp4e109c; } public static function verify($sp414b26, $sp13624e, $sp7b1718) { $sp83a6de = new Lib(config('services.geetest.id'), config('services.geetest.key')); $sp71c904 = Session::get('gt_user_id'); if (Session::get('gt_server') == 1) { $sp097648 = $sp83a6de->success_validate($sp414b26, $sp13624e, $sp7b1718, $sp71c904); if ($sp097648) { return true; } else { return false; } } else { if ($sp83a6de->fail_validate($sp414b26, $sp13624e, $sp7b1718)) { return true; } else { return false; } } } }