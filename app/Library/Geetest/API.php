<?php
namespace App\Library\Geetest; use Illuminate\Support\Facades\Session; class API { private $geetest_conf = null; public function __construct($spfd6e52) { $this->geetest_conf = $spfd6e52; } public static function get() { $sp746ee1 = config('services.geetest.id'); $sp0d678a = config('services.geetest.key'); if (!strlen($sp746ee1) || !strlen($sp0d678a)) { return null; } $sp078aa4 = new Lib($sp746ee1, $sp0d678a); $sp258cf6 = time() . rand(1, 10000); $spf66c3d = $sp078aa4->pre_process($sp258cf6); $sp786169 = json_decode($sp078aa4->get_response_str()); Session::put('gt_server', $spf66c3d); Session::put('gt_user_id', $sp258cf6); return $sp786169; } public static function verify($sp8929f8, $spe8aa70, $spb99309) { $sp078aa4 = new Lib(config('services.geetest.id'), config('services.geetest.key')); $sp258cf6 = Session::get('gt_user_id'); if (Session::get('gt_server') == 1) { $sp0cbff8 = $sp078aa4->success_validate($sp8929f8, $spe8aa70, $spb99309, $sp258cf6); if ($sp0cbff8) { return true; } else { return false; } } else { if ($sp078aa4->fail_validate($sp8929f8, $spe8aa70, $spb99309)) { return true; } else { return false; } } } }