<?php
namespace App\Library\Geetest; use Illuminate\Support\Facades\Session; class API { private $geetest_conf = null; public function __construct($sp8ba223) { $this->geetest_conf = $sp8ba223; } public static function get() { $sp0bf346 = config('services.geetest.id'); $sp854cb4 = config('services.geetest.key'); if (!strlen($sp0bf346) || !strlen($sp854cb4)) { return null; } $sp8da66c = new Lib($sp0bf346, $sp854cb4); $spaa7e02 = time() . rand(1, 10000); $spd0cfb0 = $sp8da66c->pre_process($spaa7e02); $spc31330 = json_decode($sp8da66c->get_response_str()); Session::put('gt_server', $spd0cfb0); Session::put('gt_user_id', $spaa7e02); return $spc31330; } public static function verify($spd2b8eb, $sp6a7983, $spbdbb81) { $sp8da66c = new Lib(config('services.geetest.id'), config('services.geetest.key')); $spaa7e02 = Session::get('gt_user_id'); if (Session::get('gt_server') == 1) { $sp590507 = $sp8da66c->success_validate($spd2b8eb, $sp6a7983, $spbdbb81, $spaa7e02); if ($sp590507) { return true; } else { return false; } } else { if ($sp8da66c->fail_validate($spd2b8eb, $sp6a7983, $spbdbb81)) { return true; } else { return false; } } } }