<?php
namespace App\Library\Geetest; use Illuminate\Support\Facades\Session; class API { private $geetest_conf = null; public function __construct($sp9d4382) { $this->geetest_conf = $sp9d4382; } public static function get() { $sp3c46ab = config('services.geetest.id'); $spf1241f = config('services.geetest.key'); if (!strlen($sp3c46ab) || !strlen($spf1241f)) { return null; } $sp5fca3c = new Lib($sp3c46ab, $spf1241f); $sp15a746 = time() . rand(1, 10000); $sp27b58d = $sp5fca3c->pre_process($sp15a746); $sp9b52fe = json_decode($sp5fca3c->get_response_str()); Session::put('gt_server', $sp27b58d); Session::put('gt_user_id', $sp15a746); return $sp9b52fe; } public static function verify($spb4583e, $spc112fc, $spafb567) { $sp5fca3c = new Lib(config('services.geetest.id'), config('services.geetest.key')); $sp15a746 = Session::get('gt_user_id'); if (Session::get('gt_server') == 1) { $spb72f32 = $sp5fca3c->success_validate($spb4583e, $spc112fc, $spafb567, $sp15a746); if ($spb72f32) { return true; } else { return false; } } else { if ($sp5fca3c->fail_validate($spb4583e, $spc112fc, $spafb567)) { return true; } else { return false; } } } }