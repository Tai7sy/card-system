<?php
namespace App\Library\Geetest; use Illuminate\Support\Facades\Session; class API { private $geetest_conf = null; public function __construct($spc27de0) { $this->geetest_conf = $spc27de0; } public static function get() { $spe00284 = config('services.geetest.id'); $sp7b7024 = config('services.geetest.key'); if (!strlen($spe00284) || !strlen($sp7b7024)) { return null; } $sp1972d7 = new Lib($spe00284, $sp7b7024); $spfaef2f = time() . rand(1, 10000); $spc3ee59 = $sp1972d7->pre_process($spfaef2f); $sp29a775 = json_decode($sp1972d7->get_response_str()); Session::put('gt_server', $spc3ee59); Session::put('gt_user_id', $spfaef2f); return $sp29a775; } public static function verify($sp4a8740, $spad8d9f, $spc91770) { $sp1972d7 = new Lib(config('services.geetest.id'), config('services.geetest.key')); $spfaef2f = Session::get('gt_user_id'); if (Session::get('gt_server') == 1) { $spb34b01 = $sp1972d7->success_validate($sp4a8740, $spad8d9f, $spc91770, $spfaef2f); if ($spb34b01) { return true; } else { return false; } } else { if ($sp1972d7->fail_validate($sp4a8740, $spad8d9f, $spc91770)) { return true; } else { return false; } } } }