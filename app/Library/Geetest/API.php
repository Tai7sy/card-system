<?php
namespace App\Library\Geetest; use Illuminate\Support\Facades\Session; class API { private $geetest_conf = null; public function __construct($sp2c498e) { $this->geetest_conf = $sp2c498e; } public static function get() { $sp1e9761 = config('services.geetest.id'); $sp39bba2 = config('services.geetest.key'); if (!strlen($sp1e9761) || !strlen($sp39bba2)) { return null; } $sp0f6792 = new Lib($sp1e9761, $sp39bba2); $sp1e2a07 = time() . rand(1, 10000); $spd2b17f = $sp0f6792->pre_process($sp1e2a07); $spd7b285 = json_decode($sp0f6792->get_response_str()); Session::put('gt_server', $spd2b17f); Session::put('gt_user_id', $sp1e2a07); return $spd7b285; } public static function verify($spceea38, $spe9bf1d, $sp602ec0) { $sp0f6792 = new Lib(config('services.geetest.id'), config('services.geetest.key')); $sp1e2a07 = Session::get('gt_user_id'); if (Session::get('gt_server') == 1) { $sp08ce12 = $sp0f6792->success_validate($spceea38, $spe9bf1d, $sp602ec0, $sp1e2a07); if ($sp08ce12) { return true; } else { return false; } } else { if ($sp0f6792->fail_validate($spceea38, $spe9bf1d, $sp602ec0)) { return true; } else { return false; } } } }