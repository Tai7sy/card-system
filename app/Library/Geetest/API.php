<?php
namespace App\Library\Geetest; use Illuminate\Support\Facades\Session; class API { private $geetest_conf = null; public function __construct($spb2491c) { $this->geetest_conf = $spb2491c; } public static function get() { $spde29a5 = config('services.geetest.id'); $spf8287d = config('services.geetest.key'); if (!strlen($spde29a5) || !strlen($spf8287d)) { return null; } $sp8bb0b6 = new Lib($spde29a5, $spf8287d); $sp47762c = time() . rand(1, 10000); $sp4e5656 = $sp8bb0b6->pre_process($sp47762c); $sp93ae8e = json_decode($sp8bb0b6->get_response_str()); Session::put('gt_server', $sp4e5656); Session::put('gt_user_id', $sp47762c); return $sp93ae8e; } public static function verify($spf73b5d, $sp34dfd8, $sp7b4ac9) { $sp8bb0b6 = new Lib(config('services.geetest.id'), config('services.geetest.key')); $sp47762c = Session::get('gt_user_id'); if (Session::get('gt_server') == 1) { $sp7cc108 = $sp8bb0b6->success_validate($spf73b5d, $sp34dfd8, $sp7b4ac9, $sp47762c); if ($sp7cc108) { return true; } else { return false; } } else { if ($sp8bb0b6->fail_validate($spf73b5d, $sp34dfd8, $sp7b4ac9)) { return true; } else { return false; } } } }