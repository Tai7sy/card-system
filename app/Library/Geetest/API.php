<?php
namespace App\Library\Geetest; use Illuminate\Support\Facades\Session; class API { private $geetest_conf = null; public function __construct($sp42ccac) { $this->geetest_conf = $sp42ccac; } public static function get() { $spadc22c = config('services.geetest.id'); $spa32dd2 = config('services.geetest.key'); if (!strlen($spadc22c) || !strlen($spa32dd2)) { return null; } $spd63fb7 = new Lib($spadc22c, $spa32dd2); $spf36aa8 = time() . rand(1, 10000); $spf783c8 = $spd63fb7->pre_process($spf36aa8); $spa6aab5 = json_decode($spd63fb7->get_response_str()); Session::put('gt_server', $spf783c8); Session::put('gt_user_id', $spf36aa8); return $spa6aab5; } public static function verify($spa6c81e, $sp1ba0d1, $sp64eacf) { $spd63fb7 = new Lib(config('services.geetest.id'), config('services.geetest.key')); $spf36aa8 = Session::get('gt_user_id'); if (Session::get('gt_server') == 1) { $sp8b1f25 = $spd63fb7->success_validate($spa6c81e, $sp1ba0d1, $sp64eacf, $spf36aa8); if ($sp8b1f25) { return true; } else { return false; } } else { if ($spd63fb7->fail_validate($spa6c81e, $sp1ba0d1, $sp64eacf)) { return true; } else { return false; } } } }