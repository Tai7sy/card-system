<?php
namespace App\Library\Geetest; use Illuminate\Support\Facades\Session; class API { private $geetest_conf = null; public function __construct($spbe80b7) { $this->geetest_conf = $spbe80b7; } public static function get() { $sp53f8aa = config('services.geetest.id'); $sp1ed429 = config('services.geetest.key'); if (!strlen($sp53f8aa) || !strlen($sp1ed429)) { return null; } $sp75b3c0 = new Lib($sp53f8aa, $sp1ed429); $spfa021e = time() . rand(1, 10000); $sp7a9982 = $sp75b3c0->pre_process($spfa021e); $spb9589c = json_decode($sp75b3c0->get_response_str()); Session::put('gt_server', $sp7a9982); Session::put('gt_user_id', $spfa021e); return $spb9589c; } public static function verify($sp00e976, $sp2beb18, $sp8d704b) { $sp75b3c0 = new Lib(config('services.geetest.id'), config('services.geetest.key')); $spfa021e = Session::get('gt_user_id'); if (Session::get('gt_server') == 1) { $spbbda25 = $sp75b3c0->success_validate($sp00e976, $sp2beb18, $sp8d704b, $spfa021e); if ($spbbda25) { return true; } else { return false; } } else { if ($sp75b3c0->fail_validate($sp00e976, $sp2beb18, $sp8d704b)) { return true; } else { return false; } } } }