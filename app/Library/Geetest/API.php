<?php
namespace App\Library\Geetest; use Illuminate\Support\Facades\Session; class API { private $geetest_conf = null; public function __construct($speeef4e) { $this->geetest_conf = $speeef4e; } public static function get() { $sp0cebcc = config('services.geetest.id'); $sp46d335 = config('services.geetest.key'); if (!strlen($sp0cebcc) || !strlen($sp46d335)) { return null; } $sp49e022 = new Lib($sp0cebcc, $sp46d335); $sp134e80 = time() . rand(1, 10000); $spb35169 = $sp49e022->pre_process($sp134e80); $sp5f5153 = json_decode($sp49e022->get_response_str()); Session::put('gt_server', $spb35169); Session::put('gt_user_id', $sp134e80); return $sp5f5153; } public static function verify($sp24f041, $spb884a2, $sp2f6eaa) { $sp49e022 = new Lib(config('services.geetest.id'), config('services.geetest.key')); $sp134e80 = Session::get('gt_user_id'); if (Session::get('gt_server') == 1) { $spe37386 = $sp49e022->success_validate($sp24f041, $spb884a2, $sp2f6eaa, $sp134e80); if ($spe37386) { return true; } else { return false; } } else { if ($sp49e022->fail_validate($sp24f041, $spb884a2, $sp2f6eaa)) { return true; } else { return false; } } } }