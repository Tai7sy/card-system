<?php
namespace App\Library\Geetest; use Illuminate\Support\Facades\Session; class API { private $geetest_conf = null; public function __construct($spf3616d) { $this->geetest_conf = $spf3616d; } public static function get() { $sp8e8060 = config('services.geetest.id'); $sp4450cf = config('services.geetest.key'); if (!strlen($sp8e8060) || !strlen($sp4450cf)) { return null; } $sp239ed4 = new Lib($sp8e8060, $sp4450cf); $spf5ae13 = time() . rand(1, 10000); $sp732cf7 = $sp239ed4->pre_process($spf5ae13); $sp5359c9 = json_decode($sp239ed4->get_response_str()); Session::put('gt_server', $sp732cf7); Session::put('gt_user_id', $spf5ae13); return $sp5359c9; } public static function verify($sp387b7b, $sp2b7c7c, $sp0161e8) { $sp239ed4 = new Lib(config('services.geetest.id'), config('services.geetest.key')); $spf5ae13 = Session::get('gt_user_id'); if (Session::get('gt_server') == 1) { $spe6807d = $sp239ed4->success_validate($sp387b7b, $sp2b7c7c, $sp0161e8, $spf5ae13); if ($spe6807d) { return true; } else { return false; } } else { if ($sp239ed4->fail_validate($sp387b7b, $sp2b7c7c, $sp0161e8)) { return true; } else { return false; } } } }