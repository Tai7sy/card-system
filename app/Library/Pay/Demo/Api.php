<?php
namespace App\Library\Pay\Demo; use App\Library\Pay\ApiInterface; use Illuminate\Support\Facades\Log; class Api implements ApiInterface { private $url_notify = ''; private $url_return = ''; public function __construct($sp3c46ab) { $this->url_notify = SYS_URL_API . '/pay/notify/' . $sp3c46ab; $this->url_return = SYS_URL . '/pay/return/' . $sp3c46ab; } function goPay($sp9d4382, $sp2e47fc, $spd4e90d, $spd0789a, $sp076ec7) { sleep(5); header('Location:' . $this->url_return . '/' . $sp2e47fc); die; } function verify($sp9d4382, $sp9a4d97) { $sp7b2182 = isset($sp9d4382['isNotify']) && $sp9d4382['isNotify']; if ($sp7b2182) { } else { $sp845b45 = @$sp9d4382['out_trade_no']; if (strlen($sp845b45) < 5) { throw new \Exception('交易单号未传入'); } $spca4fc7 = date('YmdHis'); $sp9a4d97($sp845b45, \App\Order::whereOrderNo($sp845b45)->first()->paid, $spca4fc7); return true; } return true; } }