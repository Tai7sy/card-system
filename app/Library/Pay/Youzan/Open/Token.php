<?php
namespace App\Library\Pay\Youzan\Open; use Exception; class Token { private $clientId; private $clientSecret; private $accessToken; private $refreshToken; private static $requestUrl = 'https://open.youzan.com/oauth/token'; public function __construct($sp4706af, $spf13c9a, $spa9766a = null, $spf5e254 = null) { $this->clientId = $sp4706af; $this->clientSecret = $spf13c9a; $this->accessToken = $spa9766a; $this->refreshToken = $spf5e254; } public function getToken($spdc3fe5, $sp5962e1 = array()) { $sp3e77f9 = array(); $sp3e77f9['client_id'] = $this->clientId; $sp3e77f9['client_secret'] = $this->clientSecret; if ($spdc3fe5 === 'oauth') { $sp3e77f9['grant_type'] = 'authorization_code'; $sp3e77f9['code'] = $sp5962e1['code']; $sp3e77f9['redirect_uri'] = $sp5962e1['redirect_uri']; } elseif ($spdc3fe5 === 'refresh_token') { $sp3e77f9['grant_type'] = 'refresh_token'; $sp3e77f9['refresh_token'] = $sp5962e1['refresh_token']; } elseif ($spdc3fe5 === 'self') { $sp3e77f9['grant_type'] = 'silent'; $sp3e77f9['kdt_id'] = $sp5962e1['kdt_id']; } elseif ($spdc3fe5 === 'platform_init') { $sp3e77f9['grant_type'] = 'authorize_platform'; } elseif ($spdc3fe5 === 'platform') { $sp3e77f9['grant_type'] = 'authorize_platform'; $sp3e77f9['kdt_id'] = $sp5962e1['kdt_id']; } return $this->parseResponse(Http::post(self::$requestUrl, $sp3e77f9)); } private function parseResponse($sp772666) { $spcb019a = json_decode($sp772666, true); if (null === $spcb019a) { throw new Exception('response invalid, data: ' . $sp772666); } return $spcb019a; } }