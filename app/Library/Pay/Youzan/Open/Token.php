<?php
namespace App\Library\Pay\Youzan\Open; use Exception; class Token { private $clientId; private $clientSecret; private $accessToken; private $refreshToken; private static $requestUrl = 'https://open.youzan.com/oauth/token'; public function __construct($sp0ec88e, $sp34b7ec, $sp730fcc = null, $spb4e62b = null) { $this->clientId = $sp0ec88e; $this->clientSecret = $sp34b7ec; $this->accessToken = $sp730fcc; $this->refreshToken = $spb4e62b; } public function getToken($sp8f5ac7, $sp6dc367 = array()) { $spa26894 = array(); $spa26894['client_id'] = $this->clientId; $spa26894['client_secret'] = $this->clientSecret; if ($sp8f5ac7 === 'oauth') { $spa26894['grant_type'] = 'authorization_code'; $spa26894['code'] = $sp6dc367['code']; $spa26894['redirect_uri'] = $sp6dc367['redirect_uri']; } elseif ($sp8f5ac7 === 'refresh_token') { $spa26894['grant_type'] = 'refresh_token'; $spa26894['refresh_token'] = $sp6dc367['refresh_token']; } elseif ($sp8f5ac7 === 'self') { $spa26894['grant_type'] = 'silent'; $spa26894['kdt_id'] = $sp6dc367['kdt_id']; } elseif ($sp8f5ac7 === 'platform_init') { $spa26894['grant_type'] = 'authorize_platform'; } elseif ($sp8f5ac7 === 'platform') { $spa26894['grant_type'] = 'authorize_platform'; $spa26894['kdt_id'] = $sp6dc367['kdt_id']; } return $this->parseResponse(Http::post(self::$requestUrl, $spa26894)); } private function parseResponse($spb94c56) { $sp5aa598 = json_decode($spb94c56, true); if (null === $sp5aa598) { throw new Exception('response invalid, data: ' . $spb94c56); } return $sp5aa598; } }