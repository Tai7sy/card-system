<?php
require_once 'alipay_core.function.php'; class AlipaySubmit { var $alipay_config; var $alipay_gateway_new = 'https://mapi.alipay.com/gateway.do?'; function __construct($sp487939) { $this->alipay_config = $sp487939; } function AlipaySubmit($sp487939) { $this->__construct($sp487939); } function buildRequestMysign($sp012af7) { $sp4a09c0 = createLinkString($sp012af7); switch (strtoupper(trim($this->alipay_config['sign_type']))) { case 'MD5': $spa0547c = md5Sign($sp4a09c0, $this->alipay_config['key']); break; default: $spa0547c = ''; } return $spa0547c; } function buildRequestPara($sp5f0fbc) { $sp67f981 = paraFilter($sp5f0fbc); $sp012af7 = argSort($sp67f981); $spa0547c = $this->buildRequestMysign($sp012af7); $sp012af7['sign'] = $spa0547c; $sp012af7['sign_type'] = strtoupper(trim($this->alipay_config['sign_type'])); return $sp012af7; } function buildRequestParaToString($sp5f0fbc) { $sp4b405d = $this->buildRequestPara($sp5f0fbc); $sp204ba0 = createLinkStringUrlEncode($sp4b405d); return $sp204ba0; } function buildRequestForm($sp5f0fbc, $sp2e8ea8, $spcc9c3f) { $sp4b405d = $this->buildRequestPara($sp5f0fbc); $spb6abed = '<form id=\'alipaysubmit\' name=\'alipaysubmit\' action=\'' . $this->alipay_gateway_new . '_input_charset=' . trim(strtolower($this->alipay_config['input_charset'])) . '\' method=\'' . $sp2e8ea8 . '\'>'; foreach ($sp4b405d as $sp1ed429 => $sp36ecf9) { $spb6abed .= '<input type=\'hidden\' name=\'' . $sp1ed429 . '\' value=\'' . $sp36ecf9 . '\'/>'; } $spb6abed = $spb6abed . '<input type=\'submit\'  value=\'' . $spcc9c3f . '\' style=\'display:none;\'></form>'; $spb6abed = $spb6abed . '<script>document.forms[\'alipaysubmit\'].submit();</script>'; return $spb6abed; } function query_timestamp() { $sp3db1b2 = $this->alipay_gateway_new . 'service=query_timestamp&partner=' . trim(strtolower($this->alipay_config['partner'])) . '&_input_charset=' . trim(strtolower($this->alipay_config['input_charset'])); $sp536dbf = new DOMDocument(); $sp536dbf->load($sp3db1b2); $spdf5caa = $sp536dbf->getElementsByTagName('encrypt_key'); $sp2e1d1f = $spdf5caa->item(0)->nodeValue; return $sp2e1d1f; } }